(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function s(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=s(r);fetch(r.href,n)}})();/**
* @vue/shared v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function wi(t,e){const s=new Set(t.split(","));return i=>s.has(i)}const it={},Ne=[],Dt=()=>{},oh=()=>!1,Ls=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Fi=t=>t.startsWith("onUpdate:"),at=Object.assign,xi=(t,e)=>{const s=t.indexOf(e);s>-1&&t.splice(s,1)},hh=Object.prototype.hasOwnProperty,j=(t,e)=>hh.call(t,e),B=Array.isArray,ve=t=>ks(t)==="[object Map]",Rn=t=>ks(t)==="[object Set]",H=t=>typeof t=="function",lt=t=>typeof t=="string",fe=t=>typeof t=="symbol",nt=t=>t!==null&&typeof t=="object",gn=t=>(nt(t)||H(t))&&H(t.then)&&H(t.catch),Sn=Object.prototype.toString,ks=t=>Sn.call(t),ah=t=>ks(t).slice(8,-1),bn=t=>ks(t)==="[object Object]",Li=t=>lt(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,Ze=wi(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Vs=t=>{const e=Object.create(null);return s=>e[s]||(e[s]=t(s))},lh=/-(\w)/g,Gt=Vs(t=>t.replace(lh,(e,s)=>s?s.toUpperCase():"")),uh=/\B([A-Z])/g,ke=Vs(t=>t.replace(uh,"-$1").toLowerCase()),Bs=Vs(t=>t.charAt(0).toUpperCase()+t.slice(1)),ti=Vs(t=>t?`on${Bs(t)}`:""),ce=(t,e)=>!Object.is(t,e),ei=(t,...e)=>{for(let s=0;s<t.length;s++)t[s](...e)},An=(t,e,s,i=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:i,value:s})},ch=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let hr;const Cn=()=>hr||(hr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Gs(t){if(B(t)){const e={};for(let s=0;s<t.length;s++){const i=t[s],r=lt(i)?mh(i):Gs(i);if(r)for(const n in r)e[n]=r[n]}return e}else if(lt(t)||nt(t))return t}const fh=/;(?![^(]*\))/g,ph=/:([^]+)/,dh=/\/\*[^]*?\*\//g;function mh(t){const e={};return t.replace(dh,"").split(fh).forEach(s=>{if(s){const i=s.split(ph);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function ki(t){let e="";if(lt(t))e=t;else if(B(t))for(let s=0;s<t.length;s++){const i=ki(t[s]);i&&(e+=i+" ")}else if(nt(t))for(const s in t)t[s]&&(e+=s+" ");return e.trim()}const _h="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Rh=wi(_h);function En(t){return!!t||t===""}const In=t=>!!(t&&t.__v_isRef===!0),Dn=t=>lt(t)?t:t==null?"":B(t)||nt(t)&&(t.toString===Sn||!H(t.toString))?In(t)?Dn(t.value):JSON.stringify(t,yn,2):String(t),yn=(t,e)=>In(e)?yn(t,e.value):ve(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((s,[i,r],n)=>(s[si(i,n)+" =>"]=r,s),{})}:Rn(e)?{[`Set(${e.size})`]:[...e.values()].map(s=>si(s))}:fe(e)?si(e):nt(e)&&!B(e)&&!bn(e)?String(e):e,si=(t,e="")=>{var s;return fe(t)?`Symbol(${(s=t.description)!=null?s:e})`:t};/**
* @vue/reactivity v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Ot;class Nn{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Ot,!e&&Ot&&(this.index=(Ot.scopes||(Ot.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const s=Ot;try{return Ot=this,e()}finally{Ot=s}}}on(){Ot=this}off(){Ot=this.parent}stop(e){if(this._active){let s,i;for(s=0,i=this.effects.length;s<i;s++)this.effects[s].stop();for(s=0,i=this.cleanups.length;s<i;s++)this.cleanups[s]();if(this.scopes)for(s=0,i=this.scopes.length;s<i;s++)this.scopes[s].stop(!0);if(!this.detached&&this.parent&&!e){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.parent=void 0,this._active=!1}}}function gh(t){return new Nn(t)}function Sh(t,e=Ot){e&&e.active&&e.effects.push(t)}function bh(){return Ot}let be;class ts{constructor(e,s,i,r){this.fn=e,this.trigger=s,this.scheduler=i,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,Sh(this,r)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,pe();for(let e=0;e<this._depsLength;e++){const s=this.deps[e];if(s.computed&&(Ah(s.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),de()}return this._dirtyLevel>=4}set dirty(e){this._dirtyLevel=e?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=he,s=be;try{return he=!0,be=this,this._runnings++,ar(this),this.fn()}finally{lr(this),this._runnings--,be=s,he=e}}stop(){this.active&&(ar(this),lr(this),this.onStop&&this.onStop(),this.active=!1)}}function Ah(t){return t.value}function ar(t){t._trackId++,t._depsLength=0}function lr(t){if(t.deps.length>t._depsLength){for(let e=t._depsLength;e<t.deps.length;e++)vn(t.deps[e],t);t.deps.length=t._depsLength}}function vn(t,e){const s=t.get(e);s!==void 0&&e._trackId!==s&&(t.delete(e),t.size===0&&t.cleanup())}function Ch(t,e){t.effect instanceof ts&&(t=t.effect.fn);const s=new ts(t,Dt,()=>{s.dirty&&s.run()});s.run();const i=s.run.bind(s);return i.effect=s,i}let he=!0,di=0;const Tn=[];function pe(){Tn.push(he),he=!1}function de(){const t=Tn.pop();he=t===void 0?!0:t}function Vi(){di++}function Bi(){for(di--;!di&&mi.length;)mi.shift()()}function On(t,e,s){if(e.get(t)!==t._trackId){e.set(t,t._trackId);const i=t.deps[t._depsLength];i!==e?(i&&vn(i,t),t.deps[t._depsLength++]=e):t._depsLength++}}const mi=[];function Pn(t,e,s){Vi();for(const i of t.keys()){let r;i._dirtyLevel<e&&(r??(r=t.get(i)===i._trackId))&&(i._shouldSchedule||(i._shouldSchedule=i._dirtyLevel===0),i._dirtyLevel=e),i._shouldSchedule&&(r??(r=t.get(i)===i._trackId))&&(i.trigger(),(!i._runnings||i.allowRecurse)&&i._dirtyLevel!==2&&(i._shouldSchedule=!1,i.scheduler&&mi.push(i.scheduler)))}Bi()}const Mn=(t,e)=>{const s=new Map;return s.cleanup=t,s.computed=e,s},_i=new WeakMap,Ae=Symbol(""),Ri=Symbol("");function bt(t,e,s){if(he&&be){let i=_i.get(t);i||_i.set(t,i=new Map);let r=i.get(s);r||i.set(s,r=Mn(()=>i.delete(s))),On(be,r)}}function Wt(t,e,s,i,r,n){const o=_i.get(t);if(!o)return;let h=[];if(e==="clear")h=[...o.values()];else if(s==="length"&&B(t)){const a=Number(i);o.forEach((c,u)=>{(u==="length"||!fe(u)&&u>=a)&&h.push(c)})}else switch(s!==void 0&&h.push(o.get(s)),e){case"add":B(t)?Li(s)&&h.push(o.get("length")):(h.push(o.get(Ae)),ve(t)&&h.push(o.get(Ri)));break;case"delete":B(t)||(h.push(o.get(Ae)),ve(t)&&h.push(o.get(Ri)));break;case"set":ve(t)&&h.push(o.get(Ae));break}Vi();for(const a of h)a&&Pn(a,4);Bi()}const Eh=wi("__proto__,__v_isRef,__isVue"),wn=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(fe)),ur=Ih();function Ih(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...s){const i=z(this);for(let n=0,o=this.length;n<o;n++)bt(i,"get",n+"");const r=i[e](...s);return r===-1||r===!1?i[e](...s.map(z)):r}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...s){pe(),Vi();const i=z(this)[e].apply(this,s);return Bi(),de(),i}}),t}function Dh(t){fe(t)||(t=String(t));const e=z(this);return bt(e,"has",t),e.hasOwnProperty(t)}class Fn{constructor(e=!1,s=!1){this._isReadonly=e,this._isShallow=s}get(e,s,i){const r=this._isReadonly,n=this._isShallow;if(s==="__v_isReactive")return!r;if(s==="__v_isReadonly")return r;if(s==="__v_isShallow")return n;if(s==="__v_raw")return i===(r?n?Vh:Vn:n?kn:Ln).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(i)?e:void 0;const o=B(e);if(!r){if(o&&j(ur,s))return Reflect.get(ur,s,i);if(s==="hasOwnProperty")return Dh}const h=Reflect.get(e,s,i);return(fe(s)?wn.has(s):Eh(s))||(r||bt(e,"get",s),n)?h:At(h)?o&&Li(s)?h:h.value:nt(h)?r?Bn(h):as(h):h}}class xn extends Fn{constructor(e=!1){super(!1,e)}set(e,s,i,r){let n=e[s];if(!this._isShallow){const a=es(n);if(!vs(i)&&!es(i)&&(n=z(n),i=z(i)),!B(e)&&At(n)&&!At(i))return a?!1:(n.value=i,!0)}const o=B(e)&&Li(s)?Number(s)<e.length:j(e,s),h=Reflect.set(e,s,i,r);return e===z(r)&&(o?ce(i,n)&&Wt(e,"set",s,i):Wt(e,"add",s,i)),h}deleteProperty(e,s){const i=j(e,s);e[s];const r=Reflect.deleteProperty(e,s);return r&&i&&Wt(e,"delete",s,void 0),r}has(e,s){const i=Reflect.has(e,s);return(!fe(s)||!wn.has(s))&&bt(e,"has",s),i}ownKeys(e){return bt(e,"iterate",B(e)?"length":Ae),Reflect.ownKeys(e)}}class yh extends Fn{constructor(e=!1){super(!0,e)}set(e,s){return!0}deleteProperty(e,s){return!0}}const Nh=new xn,vh=new yh,Th=new xn(!0);const Gi=t=>t,qs=t=>Reflect.getPrototypeOf(t);function us(t,e,s=!1,i=!1){t=t.__v_raw;const r=z(t),n=z(e);s||(ce(e,n)&&bt(r,"get",e),bt(r,"get",n));const{has:o}=qs(r),h=i?Gi:s?Xi:ss;if(o.call(r,e))return h(t.get(e));if(o.call(r,n))return h(t.get(n));t!==r&&t.get(e)}function cs(t,e=!1){const s=this.__v_raw,i=z(s),r=z(t);return e||(ce(t,r)&&bt(i,"has",t),bt(i,"has",r)),t===r?s.has(t):s.has(t)||s.has(r)}function fs(t,e=!1){return t=t.__v_raw,!e&&bt(z(t),"iterate",Ae),Reflect.get(t,"size",t)}function cr(t){t=z(t);const e=z(this);return qs(e).has.call(e,t)||(e.add(t),Wt(e,"add",t,t)),this}function fr(t,e){e=z(e);const s=z(this),{has:i,get:r}=qs(s);let n=i.call(s,t);n||(t=z(t),n=i.call(s,t));const o=r.call(s,t);return s.set(t,e),n?ce(e,o)&&Wt(s,"set",t,e):Wt(s,"add",t,e),this}function pr(t){const e=z(this),{has:s,get:i}=qs(e);let r=s.call(e,t);r||(t=z(t),r=s.call(e,t)),i&&i.call(e,t);const n=e.delete(t);return r&&Wt(e,"delete",t,void 0),n}function dr(){const t=z(this),e=t.size!==0,s=t.clear();return e&&Wt(t,"clear",void 0,void 0),s}function ps(t,e){return function(i,r){const n=this,o=n.__v_raw,h=z(o),a=e?Gi:t?Xi:ss;return!t&&bt(h,"iterate",Ae),o.forEach((c,u)=>i.call(r,a(c),a(u),n))}}function ds(t,e,s){return function(...i){const r=this.__v_raw,n=z(r),o=ve(n),h=t==="entries"||t===Symbol.iterator&&o,a=t==="keys"&&o,c=r[t](...i),u=s?Gi:e?Xi:ss;return!e&&bt(n,"iterate",a?Ri:Ae),{next(){const{value:p,done:d}=c.next();return d?{value:p,done:d}:{value:h?[u(p[0]),u(p[1])]:u(p),done:d}},[Symbol.iterator](){return this}}}}function te(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Oh(){const t={get(n){return us(this,n)},get size(){return fs(this)},has:cs,add:cr,set:fr,delete:pr,clear:dr,forEach:ps(!1,!1)},e={get(n){return us(this,n,!1,!0)},get size(){return fs(this)},has:cs,add:cr,set:fr,delete:pr,clear:dr,forEach:ps(!1,!0)},s={get(n){return us(this,n,!0)},get size(){return fs(this,!0)},has(n){return cs.call(this,n,!0)},add:te("add"),set:te("set"),delete:te("delete"),clear:te("clear"),forEach:ps(!0,!1)},i={get(n){return us(this,n,!0,!0)},get size(){return fs(this,!0)},has(n){return cs.call(this,n,!0)},add:te("add"),set:te("set"),delete:te("delete"),clear:te("clear"),forEach:ps(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(n=>{t[n]=ds(n,!1,!1),s[n]=ds(n,!0,!1),e[n]=ds(n,!1,!0),i[n]=ds(n,!0,!0)}),[t,s,e,i]}const[Ph,Mh,wh,Fh]=Oh();function qi(t,e){const s=e?t?Fh:wh:t?Mh:Ph;return(i,r,n)=>r==="__v_isReactive"?!t:r==="__v_isReadonly"?t:r==="__v_raw"?i:Reflect.get(j(s,r)&&r in i?s:i,r,n)}const xh={get:qi(!1,!1)},Lh={get:qi(!1,!0)},kh={get:qi(!0,!1)};const Ln=new WeakMap,kn=new WeakMap,Vn=new WeakMap,Vh=new WeakMap;function Bh(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Gh(t){return t.__v_skip||!Object.isExtensible(t)?0:Bh(ah(t))}function as(t){return es(t)?t:Hi(t,!1,Nh,xh,Ln)}function qh(t){return Hi(t,!1,Th,Lh,kn)}function Bn(t){return Hi(t,!0,vh,kh,Vn)}function Hi(t,e,s,i,r){if(!nt(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const n=r.get(t);if(n)return n;const o=Gh(t);if(o===0)return t;const h=new Proxy(t,o===2?i:s);return r.set(t,h),h}function je(t){return es(t)?je(t.__v_raw):!!(t&&t.__v_isReactive)}function es(t){return!!(t&&t.__v_isReadonly)}function vs(t){return!!(t&&t.__v_isShallow)}function Gn(t){return t?!!t.__v_raw:!1}function z(t){const e=t&&t.__v_raw;return e?z(e):t}function qn(t){return Object.isExtensible(t)&&An(t,"__v_skip",!0),t}const ss=t=>nt(t)?as(t):t,Xi=t=>nt(t)?Bn(t):t;class Hn{constructor(e,s,i,r){this.getter=e,this._setter=s,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new ts(()=>e(this._value),()=>Ss(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=i}get value(){const e=z(this);return(!e._cacheable||e.effect.dirty)&&ce(e._value,e._value=e.effect.run())&&Ss(e,4),Xn(e),e.effect._dirtyLevel>=2&&Ss(e,2),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function Hh(t,e,s=!1){let i,r;const n=H(t);return n?(i=t,r=Dt):(i=t.get,r=t.set),new Hn(i,r,n||!r,s)}function Xn(t){var e;he&&be&&(t=z(t),On(be,(e=t.dep)!=null?e:t.dep=Mn(()=>t.dep=void 0,t instanceof Hn?t:void 0)))}function Ss(t,e=4,s,i){t=z(t);const r=t.dep;r&&Pn(r,e)}function At(t){return!!(t&&t.__v_isRef===!0)}function Hs(t){return Yn(t,!1)}function Xh(t){return Yn(t,!0)}function Yn(t,e){return At(t)?t:new Yh(t,e)}class Yh{constructor(e,s){this.__v_isShallow=s,this.dep=void 0,this.__v_isRef=!0,this._rawValue=s?e:z(e),this._value=s?e:ss(e)}get value(){return Xn(this),this._value}set value(e){const s=this.__v_isShallow||vs(e)||es(e);e=s?e:z(e),ce(e,this._rawValue)&&(this._rawValue,this._rawValue=e,this._value=s?e:ss(e),Ss(this,4))}}function Zt(t){return At(t)?t.value:t}const Uh={get:(t,e,s)=>Zt(Reflect.get(t,e,s)),set:(t,e,s,i)=>{const r=t[e];return At(r)&&!At(s)?(r.value=s,!0):Reflect.set(t,e,s,i)}};function Un(t){return je(t)?t:new Proxy(t,Uh)}/**
* @vue/runtime-core v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function ae(t,e,s,i){try{return i?t(...i):t()}catch(r){Xs(r,e,s)}}function wt(t,e,s,i){if(H(t)){const r=ae(t,e,s,i);return r&&gn(r)&&r.catch(n=>{Xs(n,e,s)}),r}if(B(t)){const r=[];for(let n=0;n<t.length;n++)r.push(wt(t[n],e,s,i));return r}}function Xs(t,e,s,i=!0){const r=e?e.vnode:null;if(e){let n=e.parent;const o=e.proxy,h=`https://vuejs.org/error-reference/#runtime-${s}`;for(;n;){const c=n.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](t,o,h)===!1)return}n=n.parent}const a=e.appContext.config.errorHandler;if(a){pe(),ae(a,null,10,[t,o,h]),de();return}}Wh(t,s,r,i)}function Wh(t,e,s,i=!0){console.error(t)}let is=!1,gi=!1;const pt=[];let Bt=0;const Te=[];let ie=null,Se=0;const Wn=Promise.resolve();let Yi=null;function Ui(t){const e=Yi||Wn;return t?e.then(this?t.bind(this):t):e}function Zh(t){let e=Bt+1,s=pt.length;for(;e<s;){const i=e+s>>>1,r=pt[i],n=rs(r);n<t||n===t&&r.pre?e=i+1:s=i}return e}function Wi(t){(!pt.length||!pt.includes(t,is&&t.allowRecurse?Bt+1:Bt))&&(t.id==null?pt.push(t):pt.splice(Zh(t.id),0,t),Zn())}function Zn(){!is&&!gi&&(gi=!0,Yi=Wn.then(Kn))}function jh(t){const e=pt.indexOf(t);e>Bt&&pt.splice(e,1)}function Kh(t){B(t)?Te.push(...t):(!ie||!ie.includes(t,t.allowRecurse?Se+1:Se))&&Te.push(t),Zn()}function mr(t,e,s=is?Bt+1:0){for(;s<pt.length;s++){const i=pt[s];if(i&&i.pre){if(t&&i.id!==t.uid)continue;pt.splice(s,1),s--,i()}}}function jn(t){if(Te.length){const e=[...new Set(Te)].sort((s,i)=>rs(s)-rs(i));if(Te.length=0,ie){ie.push(...e);return}for(ie=e,Se=0;Se<ie.length;Se++){const s=ie[Se];s.active!==!1&&s()}ie=null,Se=0}}const rs=t=>t.id==null?1/0:t.id,$h=(t,e)=>{const s=rs(t)-rs(e);if(s===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return s};function Kn(t){gi=!1,is=!0,pt.sort($h);try{for(Bt=0;Bt<pt.length;Bt++){const e=pt[Bt];e&&e.active!==!1&&ae(e,null,14)}}finally{Bt=0,pt.length=0,jn(),is=!1,Yi=null,(pt.length||Te.length)&&Kn()}}function zh(t,e,...s){if(t.isUnmounted)return;const i=t.vnode.props||it;let r=s;const n=e.startsWith("update:"),o=n&&e.slice(7);if(o&&o in i){const u=`${o==="modelValue"?"model":o}Modifiers`,{number:p,trim:d}=i[u]||it;d&&(r=s.map(A=>lt(A)?A.trim():A)),p&&(r=s.map(ch))}let h,a=i[h=ti(e)]||i[h=ti(Gt(e))];!a&&n&&(a=i[h=ti(ke(e))]),a&&wt(a,t,6,r);const c=i[h+"Once"];if(c){if(!t.emitted)t.emitted={};else if(t.emitted[h])return;t.emitted[h]=!0,wt(c,t,6,r)}}function $n(t,e,s=!1){const i=e.emitsCache,r=i.get(t);if(r!==void 0)return r;const n=t.emits;let o={},h=!1;if(!H(t)){const a=c=>{const u=$n(c,e,!0);u&&(h=!0,at(o,u))};!s&&e.mixins.length&&e.mixins.forEach(a),t.extends&&a(t.extends),t.mixins&&t.mixins.forEach(a)}return!n&&!h?(nt(t)&&i.set(t,null),null):(B(n)?n.forEach(a=>o[a]=null):at(o,n),nt(t)&&i.set(t,o),o)}function Ys(t,e){return!t||!Ls(e)?!1:(e=e.slice(2).replace(/Once$/,""),j(t,e[0].toLowerCase()+e.slice(1))||j(t,ke(e))||j(t,e))}let yt=null,zn=null;function Ts(t){const e=yt;return yt=t,zn=t&&t.type.__scopeId||null,e}function Jn(t,e=yt,s){if(!e||t._n)return t;const i=(...r)=>{i._d&&vr(-1);const n=Ts(e);let o;try{o=t(...r)}finally{Ts(n),i._d&&vr(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function ii(t){const{type:e,vnode:s,proxy:i,withProxy:r,propsOptions:[n],slots:o,attrs:h,emit:a,render:c,renderCache:u,props:p,data:d,setupState:A,ctx:v,inheritAttrs:w}=t,k=Ts(t);let M,F;try{if(s.shapeFlag&4){const Z=r||i,ot=Z;M=Vt(c.call(ot,Z,u,p,A,d,v)),F=h}else{const Z=e;M=Vt(Z.length>1?Z(p,{attrs:h,slots:o,emit:a}):Z(p,null)),F=e.props?h:Jh(h)}}catch(Z){ze.length=0,Xs(Z,t,1),M=ft(Ce)}let V=M;if(F&&w!==!1){const Z=Object.keys(F),{shapeFlag:ot}=V;Z.length&&ot&7&&(n&&Z.some(Fi)&&(F=Qh(F,n)),V=Pe(V,F,!1,!0))}return s.dirs&&(V=Pe(V,null,!1,!0),V.dirs=V.dirs?V.dirs.concat(s.dirs):s.dirs),s.transition&&(V.transition=s.transition),M=V,Ts(k),M}const Jh=t=>{let e;for(const s in t)(s==="class"||s==="style"||Ls(s))&&((e||(e={}))[s]=t[s]);return e},Qh=(t,e)=>{const s={};for(const i in t)(!Fi(i)||!(i.slice(9)in e))&&(s[i]=t[i]);return s};function ta(t,e,s){const{props:i,children:r,component:n}=t,{props:o,children:h,patchFlag:a}=e,c=n.emitsOptions;if(e.dirs||e.transition)return!0;if(s&&a>=0){if(a&1024)return!0;if(a&16)return i?_r(i,o,c):!!o;if(a&8){const u=e.dynamicProps;for(let p=0;p<u.length;p++){const d=u[p];if(o[d]!==i[d]&&!Ys(c,d))return!0}}}else return(r||h)&&(!h||!h.$stable)?!0:i===o?!1:i?o?_r(i,o,c):!0:!!o;return!1}function _r(t,e,s){const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!0;for(let r=0;r<i.length;r++){const n=i[r];if(e[n]!==t[n]&&!Ys(s,n))return!0}return!1}function ea({vnode:t,parent:e},s){for(;e;){const i=e.subTree;if(i.suspense&&i.suspense.activeBranch===t&&(i.el=t.el),i===t)(t=e.vnode).el=s,e=e.parent;else break}}const sa="components";function Rr(t,e){return ra(sa,t,!0,e)||t}const ia=Symbol.for("v-ndc");function ra(t,e,s=!0,i=!1){const r=yt||dt;if(r){const n=r.type;{const h=Ja(n,!1);if(h&&(h===e||h===Gt(e)||h===Bs(Gt(e))))return n}const o=gr(r[t]||n[t],e)||gr(r.appContext[t],e);return!o&&i?n:o}}function gr(t,e){return t&&(t[e]||t[Gt(e)]||t[Bs(Gt(e))])}const na=t=>t.__isSuspense;function oa(t,e){e&&e.pendingBranch?B(t)?e.effects.push(...t):e.effects.push(t):Kh(t)}function Us(t,e,s=dt,i=!1){if(s){const r=s[t]||(s[t]=[]),n=e.__weh||(e.__weh=(...o)=>{pe();const h=ls(s),a=wt(e,s,t,o);return h(),de(),a});return i?r.unshift(n):r.push(n),n}}const $t=t=>(e,s=dt)=>{(!js||t==="sp")&&Us(t,(...i)=>e(...i),s)},ha=$t("bm"),Zi=$t("m"),aa=$t("bu"),la=$t("u"),ji=$t("bum"),Qn=$t("um"),ua=$t("sp"),ca=$t("rtg"),fa=$t("rtc");function pa(t,e=dt){Us("ec",t,e)}function da(t,e){if(yt===null)return t;const s=Ks(yt),i=t.dirs||(t.dirs=[]);for(let r=0;r<e.length;r++){let[n,o,h,a=it]=e[r];n&&(H(n)&&(n={mounted:n,updated:n}),n.deep&&oe(o),i.push({dir:n,instance:s,value:o,oldValue:void 0,arg:h,modifiers:a}))}return t}function _e(t,e,s,i){const r=t.dirs,n=e&&e.dirs;for(let o=0;o<r.length;o++){const h=r[o];n&&(h.oldValue=n[o].value);let a=h.dir[i];a&&(pe(),wt(a,s,8,[t.el,h,t,e]),de())}}/*! #__NO_SIDE_EFFECTS__ */function Ws(t,e){return H(t)?at({name:t.name},e,{setup:t}):t}const bs=t=>!!t.type.__asyncLoader,Si=t=>t?Ao(t)?Ks(t):Si(t.parent):null,Ke=at(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Si(t.parent),$root:t=>Si(t.root),$emit:t=>t.emit,$options:t=>Ki(t),$forceUpdate:t=>t.f||(t.f=()=>{t.effect.dirty=!0,Wi(t.update)}),$nextTick:t=>t.n||(t.n=Ui.bind(t.proxy)),$watch:t=>Fa.bind(t)}),ri=(t,e)=>t!==it&&!t.__isScriptSetup&&j(t,e),ma={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:s,setupState:i,data:r,props:n,accessCache:o,type:h,appContext:a}=t;let c;if(e[0]!=="$"){const A=o[e];if(A!==void 0)switch(A){case 1:return i[e];case 2:return r[e];case 4:return s[e];case 3:return n[e]}else{if(ri(i,e))return o[e]=1,i[e];if(r!==it&&j(r,e))return o[e]=2,r[e];if((c=t.propsOptions[0])&&j(c,e))return o[e]=3,n[e];if(s!==it&&j(s,e))return o[e]=4,s[e];bi&&(o[e]=0)}}const u=Ke[e];let p,d;if(u)return e==="$attrs"&&bt(t.attrs,"get",""),u(t);if((p=h.__cssModules)&&(p=p[e]))return p;if(s!==it&&j(s,e))return o[e]=4,s[e];if(d=a.config.globalProperties,j(d,e))return d[e]},set({_:t},e,s){const{data:i,setupState:r,ctx:n}=t;return ri(r,e)?(r[e]=s,!0):i!==it&&j(i,e)?(i[e]=s,!0):j(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(n[e]=s,!0)},has({_:{data:t,setupState:e,accessCache:s,ctx:i,appContext:r,propsOptions:n}},o){let h;return!!s[o]||t!==it&&j(t,o)||ri(e,o)||(h=n[0])&&j(h,o)||j(i,o)||j(Ke,o)||j(r.config.globalProperties,o)},defineProperty(t,e,s){return s.get!=null?t._.accessCache[e]=0:j(s,"value")&&this.set(t,e,s.value,null),Reflect.defineProperty(t,e,s)}};function Sr(t){return B(t)?t.reduce((e,s)=>(e[s]=null,e),{}):t}let bi=!0;function _a(t){const e=Ki(t),s=t.proxy,i=t.ctx;bi=!1,e.beforeCreate&&br(e.beforeCreate,t,"bc");const{data:r,computed:n,methods:o,watch:h,provide:a,inject:c,created:u,beforeMount:p,mounted:d,beforeUpdate:A,updated:v,activated:w,deactivated:k,beforeDestroy:M,beforeUnmount:F,destroyed:V,unmounted:Z,render:ot,renderTracked:G,renderTriggered:ut,errorCaptured:Rt,serverPrefetch:zt,expose:Nt,inheritAttrs:Ft,components:xt,directives:Jt,filters:vt}=e;if(c&&Ra(c,i,null),o)for(const J in o){const K=o[J];H(K)&&(i[J]=K.bind(s))}if(r){const J=r.call(s,s);nt(J)&&(t.data=as(J))}if(bi=!0,n)for(const J in n){const K=n[J],Ct=H(K)?K.bind(s,s):H(K.get)?K.get.bind(s,s):Dt,Ht=!H(K)&&H(K.set)?K.set.bind(s):Dt,Et=St({get:Ct,set:Ht});Object.defineProperty(i,J,{enumerable:!0,configurable:!0,get:()=>Et.value,set:ct=>Et.value=ct})}if(h)for(const J in h)to(h[J],i,s,J);if(a){const J=H(a)?a.call(s):a;Reflect.ownKeys(J).forEach(K=>{As(K,J[K])})}u&&br(u,t,"c");function rt(J,K){B(K)?K.forEach(Ct=>J(Ct.bind(s))):K&&J(K.bind(s))}if(rt(ha,p),rt(Zi,d),rt(aa,A),rt(la,v),rt(xa,w),rt(La,k),rt(pa,Rt),rt(fa,G),rt(ca,ut),rt(ji,F),rt(Qn,Z),rt(ua,zt),B(Nt))if(Nt.length){const J=t.exposed||(t.exposed={});Nt.forEach(K=>{Object.defineProperty(J,K,{get:()=>s[K],set:Ct=>s[K]=Ct})})}else t.exposed||(t.exposed={});ot&&t.render===Dt&&(t.render=ot),Ft!=null&&(t.inheritAttrs=Ft),xt&&(t.components=xt),Jt&&(t.directives=Jt)}function Ra(t,e,s=Dt){B(t)&&(t=Ai(t));for(const i in t){const r=t[i];let n;nt(r)?"default"in r?n=jt(r.from||i,r.default,!0):n=jt(r.from||i):n=jt(r),At(n)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>n.value,set:o=>n.value=o}):e[i]=n}}function br(t,e,s){wt(B(t)?t.map(i=>i.bind(e.proxy)):t.bind(e.proxy),e,s)}function to(t,e,s,i){const r=i.includes(".")?po(s,i):()=>s[i];if(lt(t)){const n=e[t];H(n)&&Kt(r,n)}else if(H(t))Kt(r,t.bind(s));else if(nt(t))if(B(t))t.forEach(n=>to(n,e,s,i));else{const n=H(t.handler)?t.handler.bind(s):e[t.handler];H(n)&&Kt(r,n,t)}}function Ki(t){const e=t.type,{mixins:s,extends:i}=e,{mixins:r,optionsCache:n,config:{optionMergeStrategies:o}}=t.appContext,h=n.get(e);let a;return h?a=h:!r.length&&!s&&!i?a=e:(a={},r.length&&r.forEach(c=>Os(a,c,o,!0)),Os(a,e,o)),nt(e)&&n.set(e,a),a}function Os(t,e,s,i=!1){const{mixins:r,extends:n}=e;n&&Os(t,n,s,!0),r&&r.forEach(o=>Os(t,o,s,!0));for(const o in e)if(!(i&&o==="expose")){const h=ga[o]||s&&s[o];t[o]=h?h(t[o],e[o]):e[o]}return t}const ga={data:Ar,props:Cr,emits:Cr,methods:Ye,computed:Ye,beforeCreate:_t,created:_t,beforeMount:_t,mounted:_t,beforeUpdate:_t,updated:_t,beforeDestroy:_t,beforeUnmount:_t,destroyed:_t,unmounted:_t,activated:_t,deactivated:_t,errorCaptured:_t,serverPrefetch:_t,components:Ye,directives:Ye,watch:ba,provide:Ar,inject:Sa};function Ar(t,e){return e?t?function(){return at(H(t)?t.call(this,this):t,H(e)?e.call(this,this):e)}:e:t}function Sa(t,e){return Ye(Ai(t),Ai(e))}function Ai(t){if(B(t)){const e={};for(let s=0;s<t.length;s++)e[t[s]]=t[s];return e}return t}function _t(t,e){return t?[...new Set([].concat(t,e))]:e}function Ye(t,e){return t?at(Object.create(null),t,e):e}function Cr(t,e){return t?B(t)&&B(e)?[...new Set([...t,...e])]:at(Object.create(null),Sr(t),Sr(e??{})):e}function ba(t,e){if(!t)return e;if(!e)return t;const s=at(Object.create(null),t);for(const i in e)s[i]=_t(t[i],e[i]);return s}function eo(){return{app:null,config:{isNativeTag:oh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Aa=0;function Ca(t,e){return function(i,r=null){H(i)||(i=at({},i)),r!=null&&!nt(r)&&(r=null);const n=eo(),o=new WeakSet;let h=!1;const a=n.app={_uid:Aa++,_component:i,_props:r,_container:null,_context:n,_instance:null,version:tl,get config(){return n.config},set config(c){},use(c,...u){return o.has(c)||(c&&H(c.install)?(o.add(c),c.install(a,...u)):H(c)&&(o.add(c),c(a,...u))),a},mixin(c){return n.mixins.includes(c)||n.mixins.push(c),a},component(c,u){return u?(n.components[c]=u,a):n.components[c]},directive(c,u){return u?(n.directives[c]=u,a):n.directives[c]},mount(c,u,p){if(!h){const d=ft(i,r);return d.appContext=n,p===!0?p="svg":p===!1&&(p=void 0),u&&e?e(d,c):t(d,c,p),h=!0,a._container=c,c.__vue_app__=a,Ks(d.component)}},unmount(){h&&(t(null,a._container),delete a._container.__vue_app__)},provide(c,u){return n.provides[c]=u,a},runWithContext(c){const u=$e;$e=a;try{return c()}finally{$e=u}}};return a}}let $e=null;function As(t,e){if(dt){let s=dt.provides;const i=dt.parent&&dt.parent.provides;i===s&&(s=dt.provides=Object.create(i)),s[t]=e}}function jt(t,e,s=!1){const i=dt||yt;if(i||$e){const r=i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:$e._context.provides;if(r&&t in r)return r[t];if(arguments.length>1)return s&&H(e)?e.call(i&&i.proxy):e}}const so={},io=()=>Object.create(so),ro=t=>Object.getPrototypeOf(t)===so;function Ea(t,e,s,i=!1){const r={},n=io();t.propsDefaults=Object.create(null),no(t,e,r,n);for(const o in t.propsOptions[0])o in r||(r[o]=void 0);s?t.props=i?r:qh(r):t.type.props?t.props=r:t.props=n,t.attrs=n}function Ia(t,e,s,i){const{props:r,attrs:n,vnode:{patchFlag:o}}=t,h=z(r),[a]=t.propsOptions;let c=!1;if((i||o>0)&&!(o&16)){if(o&8){const u=t.vnode.dynamicProps;for(let p=0;p<u.length;p++){let d=u[p];if(Ys(t.emitsOptions,d))continue;const A=e[d];if(a)if(j(n,d))A!==n[d]&&(n[d]=A,c=!0);else{const v=Gt(d);r[v]=Ci(a,h,v,A,t,!1)}else A!==n[d]&&(n[d]=A,c=!0)}}}else{no(t,e,r,n)&&(c=!0);let u;for(const p in h)(!e||!j(e,p)&&((u=ke(p))===p||!j(e,u)))&&(a?s&&(s[p]!==void 0||s[u]!==void 0)&&(r[p]=Ci(a,h,p,void 0,t,!0)):delete r[p]);if(n!==h)for(const p in n)(!e||!j(e,p))&&(delete n[p],c=!0)}c&&Wt(t.attrs,"set","")}function no(t,e,s,i){const[r,n]=t.propsOptions;let o=!1,h;if(e)for(let a in e){if(Ze(a))continue;const c=e[a];let u;r&&j(r,u=Gt(a))?!n||!n.includes(u)?s[u]=c:(h||(h={}))[u]=c:Ys(t.emitsOptions,a)||(!(a in i)||c!==i[a])&&(i[a]=c,o=!0)}if(n){const a=z(s),c=h||it;for(let u=0;u<n.length;u++){const p=n[u];s[p]=Ci(r,a,p,c[p],t,!j(c,p))}}return o}function Ci(t,e,s,i,r,n){const o=t[s];if(o!=null){const h=j(o,"default");if(h&&i===void 0){const a=o.default;if(o.type!==Function&&!o.skipFactory&&H(a)){const{propsDefaults:c}=r;if(s in c)i=c[s];else{const u=ls(r);i=c[s]=a.call(null,e),u()}}else i=a}o[0]&&(n&&!h?i=!1:o[1]&&(i===""||i===ke(s))&&(i=!0))}return i}function oo(t,e,s=!1){const i=e.propsCache,r=i.get(t);if(r)return r;const n=t.props,o={},h=[];let a=!1;if(!H(t)){const u=p=>{a=!0;const[d,A]=oo(p,e,!0);at(o,d),A&&h.push(...A)};!s&&e.mixins.length&&e.mixins.forEach(u),t.extends&&u(t.extends),t.mixins&&t.mixins.forEach(u)}if(!n&&!a)return nt(t)&&i.set(t,Ne),Ne;if(B(n))for(let u=0;u<n.length;u++){const p=Gt(n[u]);Er(p)&&(o[p]=it)}else if(n)for(const u in n){const p=Gt(u);if(Er(p)){const d=n[u],A=o[p]=B(d)||H(d)?{type:d}:at({},d);if(A){const v=yr(Boolean,A.type),w=yr(String,A.type);A[0]=v>-1,A[1]=w<0||v<w,(v>-1||j(A,"default"))&&h.push(p)}}}const c=[o,h];return nt(t)&&i.set(t,c),c}function Er(t){return t[0]!=="$"&&!Ze(t)}function Ir(t){return t===null?"null":typeof t=="function"?t.name||"":typeof t=="object"&&t.constructor&&t.constructor.name||""}function Dr(t,e){return Ir(t)===Ir(e)}function yr(t,e){return B(e)?e.findIndex(s=>Dr(s,t)):H(e)&&Dr(e,t)?0:-1}const ho=t=>t[0]==="_"||t==="$stable",$i=t=>B(t)?t.map(Vt):[Vt(t)],Da=(t,e,s)=>{if(e._n)return e;const i=Jn((...r)=>$i(e(...r)),s);return i._c=!1,i},ao=(t,e,s)=>{const i=t._ctx;for(const r in t){if(ho(r))continue;const n=t[r];if(H(n))e[r]=Da(r,n,i);else if(n!=null){const o=$i(n);e[r]=()=>o}}},lo=(t,e)=>{const s=$i(e);t.slots.default=()=>s},ya=(t,e)=>{const s=t.slots=io();if(t.vnode.shapeFlag&32){const i=e._;i?(at(s,e),An(s,"_",i,!0)):ao(e,s)}else e&&lo(t,e)},Na=(t,e,s)=>{const{vnode:i,slots:r}=t;let n=!0,o=it;if(i.shapeFlag&32){const h=e._;h?s&&h===1?n=!1:(at(r,e),!s&&h===1&&delete r._):(n=!e.$stable,ao(e,r)),o=e}else e&&(lo(t,e),o={default:1});if(n)for(const h in r)!ho(h)&&o[h]==null&&delete r[h]};function Ei(t,e,s,i,r=!1){if(B(t)){t.forEach((d,A)=>Ei(d,e&&(B(e)?e[A]:e),s,i,r));return}if(bs(i)&&!r)return;const n=i.shapeFlag&4?Ks(i.component):i.el,o=r?null:n,{i:h,r:a}=t,c=e&&e.r,u=h.refs===it?h.refs={}:h.refs,p=h.setupState;if(c!=null&&c!==a&&(lt(c)?(u[c]=null,j(p,c)&&(p[c]=null)):At(c)&&(c.value=null)),H(a))ae(a,h,12,[o,u]);else{const d=lt(a),A=At(a);if(d||A){const v=()=>{if(t.f){const w=d?j(p,a)?p[a]:u[a]:a.value;r?B(w)&&xi(w,n):B(w)?w.includes(n)||w.push(n):d?(u[a]=[n],j(p,a)&&(p[a]=u[a])):(a.value=[n],t.k&&(u[t.k]=a.value))}else d?(u[a]=o,j(p,a)&&(p[a]=o)):A&&(a.value=o,t.k&&(u[t.k]=o))};o?(v.id=-1,gt(v,s)):v()}}}const gt=oa;function va(t){return Ta(t)}function Ta(t,e){const s=Cn();s.__VUE__=!0;const{insert:i,remove:r,patchProp:n,createElement:o,createText:h,createComment:a,setText:c,setElementText:u,parentNode:p,nextSibling:d,setScopeId:A=Dt,insertStaticContent:v}=t,w=(l,f,m,R=null,g=null,E=null,N=void 0,C=null,D=!!f.dynamicChildren)=>{if(l===f)return;l&&!Ge(l,f)&&(R=y(l),ct(l,g,E,!0),l=null),f.patchFlag===-2&&(D=!1,f.dynamicChildren=null);const{type:S,ref:T,shapeFlag:L}=f;switch(S){case Zs:k(l,f,m,R);break;case Ce:M(l,f,m,R);break;case oi:l==null&&F(f,m,R,N);break;case Ut:xt(l,f,m,R,g,E,N,C,D);break;default:L&1?ot(l,f,m,R,g,E,N,C,D):L&6?Jt(l,f,m,R,g,E,N,C,D):(L&64||L&128)&&S.process(l,f,m,R,g,E,N,C,D,et)}T!=null&&g&&Ei(T,l&&l.ref,E,f||l,!f)},k=(l,f,m,R)=>{if(l==null)i(f.el=h(f.children),m,R);else{const g=f.el=l.el;f.children!==l.children&&c(g,f.children)}},M=(l,f,m,R)=>{l==null?i(f.el=a(f.children||""),m,R):f.el=l.el},F=(l,f,m,R)=>{[l.el,l.anchor]=v(l.children,f,m,R,l.el,l.anchor)},V=({el:l,anchor:f},m,R)=>{let g;for(;l&&l!==f;)g=d(l),i(l,m,R),l=g;i(f,m,R)},Z=({el:l,anchor:f})=>{let m;for(;l&&l!==f;)m=d(l),r(l),l=m;r(f)},ot=(l,f,m,R,g,E,N,C,D)=>{f.type==="svg"?N="svg":f.type==="math"&&(N="mathml"),l==null?G(f,m,R,g,E,N,C,D):zt(l,f,g,E,N,C,D)},G=(l,f,m,R,g,E,N,C)=>{let D,S;const{props:T,shapeFlag:L,transition:x,dirs:q}=l;if(D=l.el=o(l.type,E,T&&T.is,T),L&8?u(D,l.children):L&16&&Rt(l.children,D,null,R,g,ni(l,E),N,C),q&&_e(l,null,R,"created"),ut(D,l,l.scopeId,N,R),T){for(const st in T)st!=="value"&&!Ze(st)&&n(D,st,null,T[st],E,l.children,R,g,I);"value"in T&&n(D,"value",null,T.value,E),(S=T.onVnodeBeforeMount)&&kt(S,R,l)}q&&_e(l,null,R,"beforeMount");const U=Oa(g,x);U&&x.beforeEnter(D),i(D,f,m),((S=T&&T.onVnodeMounted)||U||q)&&gt(()=>{S&&kt(S,R,l),U&&x.enter(D),q&&_e(l,null,R,"mounted")},g)},ut=(l,f,m,R,g)=>{if(m&&A(l,m),R)for(let E=0;E<R.length;E++)A(l,R[E]);if(g){let E=g.subTree;if(f===E){const N=g.vnode;ut(l,N,N.scopeId,N.slotScopeIds,g.parent)}}},Rt=(l,f,m,R,g,E,N,C,D=0)=>{for(let S=D;S<l.length;S++){const T=l[S]=C?re(l[S]):Vt(l[S]);w(null,T,f,m,R,g,E,N,C)}},zt=(l,f,m,R,g,E,N)=>{const C=f.el=l.el;let{patchFlag:D,dynamicChildren:S,dirs:T}=f;D|=l.patchFlag&16;const L=l.props||it,x=f.props||it;let q;if(m&&Re(m,!1),(q=x.onVnodeBeforeUpdate)&&kt(q,m,f,l),T&&_e(f,l,m,"beforeUpdate"),m&&Re(m,!0),S?Nt(l.dynamicChildren,S,C,m,R,ni(f,g),E):N||K(l,f,C,null,m,R,ni(f,g),E,!1),D>0){if(D&16)Ft(C,f,L,x,m,R,g);else if(D&2&&L.class!==x.class&&n(C,"class",null,x.class,g),D&4&&n(C,"style",L.style,x.style,g),D&8){const U=f.dynamicProps;for(let st=0;st<U.length;st++){const $=U[st],ht=L[$],Tt=x[$];(Tt!==ht||$==="value")&&n(C,$,ht,Tt,g,l.children,m,R,I)}}D&1&&l.children!==f.children&&u(C,f.children)}else!N&&S==null&&Ft(C,f,L,x,m,R,g);((q=x.onVnodeUpdated)||T)&&gt(()=>{q&&kt(q,m,f,l),T&&_e(f,l,m,"updated")},R)},Nt=(l,f,m,R,g,E,N)=>{for(let C=0;C<f.length;C++){const D=l[C],S=f[C],T=D.el&&(D.type===Ut||!Ge(D,S)||D.shapeFlag&70)?p(D.el):m;w(D,S,T,null,R,g,E,N,!0)}},Ft=(l,f,m,R,g,E,N)=>{if(m!==R){if(m!==it)for(const C in m)!Ze(C)&&!(C in R)&&n(l,C,m[C],null,N,f.children,g,E,I);for(const C in R){if(Ze(C))continue;const D=R[C],S=m[C];D!==S&&C!=="value"&&n(l,C,S,D,N,f.children,g,E,I)}"value"in R&&n(l,"value",m.value,R.value,N)}},xt=(l,f,m,R,g,E,N,C,D)=>{const S=f.el=l?l.el:h(""),T=f.anchor=l?l.anchor:h("");let{patchFlag:L,dynamicChildren:x,slotScopeIds:q}=f;q&&(C=C?C.concat(q):q),l==null?(i(S,m,R),i(T,m,R),Rt(f.children||[],m,T,g,E,N,C,D)):L>0&&L&64&&x&&l.dynamicChildren?(Nt(l.dynamicChildren,x,m,g,E,N,C),(f.key!=null||g&&f===g.subTree)&&uo(l,f,!0)):K(l,f,m,T,g,E,N,C,D)},Jt=(l,f,m,R,g,E,N,C,D)=>{f.slotScopeIds=C,l==null?f.shapeFlag&512?g.ctx.activate(f,m,R,N,D):vt(f,m,R,g,E,N,D):me(l,f,D)},vt=(l,f,m,R,g,E,N)=>{const C=l.component=Za(l,R,g);if(mo(l)&&(C.ctx.renderer=et),ja(C),C.asyncDep){if(g&&g.registerDep(C,rt,N),!l.el){const D=C.subTree=ft(Ce);M(null,D,f,m)}}else rt(C,l,f,m,g,E,N)},me=(l,f,m)=>{const R=f.component=l.component;if(ta(l,f,m))if(R.asyncDep&&!R.asyncResolved){J(R,f,m);return}else R.next=f,jh(R.update),R.effect.dirty=!0,R.update();else f.el=l.el,R.vnode=f},rt=(l,f,m,R,g,E,N)=>{const C=()=>{if(l.isMounted){let{next:T,bu:L,u:x,parent:q,vnode:U}=l;{const Ee=co(l);if(Ee){T&&(T.el=U.el,J(l,T,N)),Ee.asyncDep.then(()=>{l.isUnmounted||C()});return}}let st=T,$;Re(l,!1),T?(T.el=U.el,J(l,T,N)):T=U,L&&ei(L),($=T.props&&T.props.onVnodeBeforeUpdate)&&kt($,q,T,U),Re(l,!0);const ht=ii(l),Tt=l.subTree;l.subTree=ht,w(Tt,ht,p(Tt.el),y(Tt),l,g,E),T.el=ht.el,st===null&&ea(l,ht.el),x&&gt(x,g),($=T.props&&T.props.onVnodeUpdated)&&gt(()=>kt($,q,T,U),g)}else{let T;const{el:L,props:x}=f,{bm:q,m:U,parent:st}=l,$=bs(f);if(Re(l,!1),q&&ei(q),!$&&(T=x&&x.onVnodeBeforeMount)&&kt(T,st,f),Re(l,!0),L&&Y){const ht=()=>{l.subTree=ii(l),Y(L,l.subTree,l,g,null)};$?f.type.__asyncLoader().then(()=>!l.isUnmounted&&ht()):ht()}else{const ht=l.subTree=ii(l);w(null,ht,m,R,l,g,E),f.el=ht.el}if(U&&gt(U,g),!$&&(T=x&&x.onVnodeMounted)){const ht=f;gt(()=>kt(T,st,ht),g)}(f.shapeFlag&256||st&&bs(st.vnode)&&st.vnode.shapeFlag&256)&&l.a&&gt(l.a,g),l.isMounted=!0,f=m=R=null}},D=l.effect=new ts(C,Dt,()=>Wi(S),l.scope),S=l.update=()=>{D.dirty&&D.run()};S.id=l.uid,Re(l,!0),S()},J=(l,f,m)=>{f.component=l;const R=l.vnode.props;l.vnode=f,l.next=null,Ia(l,f.props,R,m),Na(l,f.children,m),pe(),mr(l),de()},K=(l,f,m,R,g,E,N,C,D=!1)=>{const S=l&&l.children,T=l?l.shapeFlag:0,L=f.children,{patchFlag:x,shapeFlag:q}=f;if(x>0){if(x&128){Ht(S,L,m,R,g,E,N,C,D);return}else if(x&256){Ct(S,L,m,R,g,E,N,C,D);return}}q&8?(T&16&&I(S,g,E),L!==S&&u(m,L)):T&16?q&16?Ht(S,L,m,R,g,E,N,C,D):I(S,g,E,!0):(T&8&&u(m,""),q&16&&Rt(L,m,R,g,E,N,C,D))},Ct=(l,f,m,R,g,E,N,C,D)=>{l=l||Ne,f=f||Ne;const S=l.length,T=f.length,L=Math.min(S,T);let x;for(x=0;x<L;x++){const q=f[x]=D?re(f[x]):Vt(f[x]);w(l[x],q,m,null,g,E,N,C,D)}S>T?I(l,g,E,!0,!1,L):Rt(f,m,R,g,E,N,C,D,L)},Ht=(l,f,m,R,g,E,N,C,D)=>{let S=0;const T=f.length;let L=l.length-1,x=T-1;for(;S<=L&&S<=x;){const q=l[S],U=f[S]=D?re(f[S]):Vt(f[S]);if(Ge(q,U))w(q,U,m,null,g,E,N,C,D);else break;S++}for(;S<=L&&S<=x;){const q=l[L],U=f[x]=D?re(f[x]):Vt(f[x]);if(Ge(q,U))w(q,U,m,null,g,E,N,C,D);else break;L--,x--}if(S>L){if(S<=x){const q=x+1,U=q<T?f[q].el:R;for(;S<=x;)w(null,f[S]=D?re(f[S]):Vt(f[S]),m,U,g,E,N,C,D),S++}}else if(S>x)for(;S<=L;)ct(l[S],g,E,!0),S++;else{const q=S,U=S,st=new Map;for(S=U;S<=x;S++){const It=f[S]=D?re(f[S]):Vt(f[S]);It.key!=null&&st.set(It.key,S)}let $,ht=0;const Tt=x-U+1;let Ee=!1,rr=0;const Be=new Array(Tt);for(S=0;S<Tt;S++)Be[S]=0;for(S=q;S<=L;S++){const It=l[S];if(ht>=Tt){ct(It,g,E,!0);continue}let Lt;if(It.key!=null)Lt=st.get(It.key);else for($=U;$<=x;$++)if(Be[$-U]===0&&Ge(It,f[$])){Lt=$;break}Lt===void 0?ct(It,g,E,!0):(Be[Lt-U]=S+1,Lt>=rr?rr=Lt:Ee=!0,w(It,f[Lt],m,null,g,E,N,C,D),ht++)}const nr=Ee?Pa(Be):Ne;for($=nr.length-1,S=Tt-1;S>=0;S--){const It=U+S,Lt=f[It],or=It+1<T?f[It+1].el:R;Be[S]===0?w(null,Lt,m,or,g,E,N,C,D):Ee&&($<0||S!==nr[$]?Et(Lt,m,or,2):$--)}}},Et=(l,f,m,R,g=null)=>{const{el:E,type:N,transition:C,children:D,shapeFlag:S}=l;if(S&6){Et(l.component.subTree,f,m,R);return}if(S&128){l.suspense.move(f,m,R);return}if(S&64){N.move(l,f,m,et);return}if(N===Ut){i(E,f,m);for(let L=0;L<D.length;L++)Et(D[L],f,m,R);i(l.anchor,f,m);return}if(N===oi){V(l,f,m);return}if(R!==2&&S&1&&C)if(R===0)C.beforeEnter(E),i(E,f,m),gt(()=>C.enter(E),g);else{const{leave:L,delayLeave:x,afterLeave:q}=C,U=()=>i(E,f,m),st=()=>{L(E,()=>{U(),q&&q()})};x?x(E,U,st):st()}else i(E,f,m)},ct=(l,f,m,R=!1,g=!1)=>{const{type:E,props:N,ref:C,children:D,dynamicChildren:S,shapeFlag:T,patchFlag:L,dirs:x,memoIndex:q}=l;if(L===-2&&(g=!1),C!=null&&Ei(C,null,m,l,!0),q!=null&&(f.renderCache[q]=void 0),T&256){f.ctx.deactivate(l);return}const U=T&1&&x,st=!bs(l);let $;if(st&&($=N&&N.onVnodeBeforeUnmount)&&kt($,f,l),T&6)_(l.component,m,R);else{if(T&128){l.suspense.unmount(m,R);return}U&&_e(l,null,f,"beforeUnmount"),T&64?l.type.remove(l,f,m,et,R):S&&(E!==Ut||L>0&&L&64)?I(S,f,m,!1,!0):(E===Ut&&L&384||!g&&T&16)&&I(D,f,m),R&&Qt(l)}(st&&($=N&&N.onVnodeUnmounted)||U)&&gt(()=>{$&&kt($,f,l),U&&_e(l,null,f,"unmounted")},m)},Qt=l=>{const{type:f,el:m,anchor:R,transition:g}=l;if(f===Ut){P(m,R);return}if(f===oi){Z(l);return}const E=()=>{r(m),g&&!g.persisted&&g.afterLeave&&g.afterLeave()};if(l.shapeFlag&1&&g&&!g.persisted){const{leave:N,delayLeave:C}=g,D=()=>N(m,E);C?C(l.el,E,D):D()}else E()},P=(l,f)=>{let m;for(;l!==f;)m=d(l),r(l),l=m;r(f)},_=(l,f,m)=>{const{bum:R,scope:g,update:E,subTree:N,um:C,m:D,a:S}=l;Nr(D),Nr(S),R&&ei(R),g.stop(),E&&(E.active=!1,ct(N,l,f,m)),C&&gt(C,f),gt(()=>{l.isUnmounted=!0},f),f&&f.pendingBranch&&!f.isUnmounted&&l.asyncDep&&!l.asyncResolved&&l.suspenseId===f.pendingId&&(f.deps--,f.deps===0&&f.resolve())},I=(l,f,m,R=!1,g=!1,E=0)=>{for(let N=E;N<l.length;N++)ct(l[N],f,m,R,g)},y=l=>l.shapeFlag&6?y(l.component.subTree):l.shapeFlag&128?l.suspense.next():d(l.anchor||l.el);let O=!1;const Q=(l,f,m)=>{l==null?f._vnode&&ct(f._vnode,null,null,!0):w(f._vnode||null,l,f,null,null,null,m),O||(O=!0,mr(),jn(),O=!1),f._vnode=l},et={p:w,um:ct,m:Et,r:Qt,mt:vt,mc:Rt,pc:K,pbc:Nt,n:y,o:t};let W,Y;return{render:Q,hydrate:W,createApp:Ca(Q,W)}}function ni({type:t,props:e},s){return s==="svg"&&t==="foreignObject"||s==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:s}function Re({effect:t,update:e},s){t.allowRecurse=e.allowRecurse=s}function Oa(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function uo(t,e,s=!1){const i=t.children,r=e.children;if(B(i)&&B(r))for(let n=0;n<i.length;n++){const o=i[n];let h=r[n];h.shapeFlag&1&&!h.dynamicChildren&&((h.patchFlag<=0||h.patchFlag===32)&&(h=r[n]=re(r[n]),h.el=o.el),!s&&h.patchFlag!==-2&&uo(o,h)),h.type===Zs&&(h.el=o.el)}}function Pa(t){const e=t.slice(),s=[0];let i,r,n,o,h;const a=t.length;for(i=0;i<a;i++){const c=t[i];if(c!==0){if(r=s[s.length-1],t[r]<c){e[i]=r,s.push(i);continue}for(n=0,o=s.length-1;n<o;)h=n+o>>1,t[s[h]]<c?n=h+1:o=h;c<t[s[n]]&&(n>0&&(e[i]=s[n-1]),s[n]=i)}}for(n=s.length,o=s[n-1];n-- >0;)s[n]=o,o=e[o];return s}function co(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:co(e)}function Nr(t){if(t)for(let e=0;e<t.length;e++)t[e].active=!1}const Ma=Symbol.for("v-scx"),wa=()=>jt(Ma),ms={};function Kt(t,e,s){return fo(t,e,s)}function fo(t,e,{immediate:s,deep:i,flush:r,once:n,onTrack:o,onTrigger:h}=it){if(e&&n){const G=e;e=(...ut)=>{G(...ut),ot()}}const a=dt,c=G=>i===!0?G:oe(G,i===!1?1:void 0);let u,p=!1,d=!1;if(At(t)?(u=()=>t.value,p=vs(t)):je(t)?(u=()=>c(t),p=!0):B(t)?(d=!0,p=t.some(G=>je(G)||vs(G)),u=()=>t.map(G=>{if(At(G))return G.value;if(je(G))return c(G);if(H(G))return ae(G,a,2)})):H(t)?e?u=()=>ae(t,a,2):u=()=>(A&&A(),wt(t,a,3,[v])):u=Dt,e&&i){const G=u;u=()=>oe(G())}let A,v=G=>{A=V.onStop=()=>{ae(G,a,4),A=V.onStop=void 0}},w;if(js)if(v=Dt,e?s&&wt(e,a,3,[u(),d?[]:void 0,v]):u(),r==="sync"){const G=wa();w=G.__watcherHandles||(G.__watcherHandles=[])}else return Dt;let k=d?new Array(t.length).fill(ms):ms;const M=()=>{if(!(!V.active||!V.dirty))if(e){const G=V.run();(i||p||(d?G.some((ut,Rt)=>ce(ut,k[Rt])):ce(G,k)))&&(A&&A(),wt(e,a,3,[G,k===ms?void 0:d&&k[0]===ms?[]:k,v]),k=G)}else V.run()};M.allowRecurse=!!e;let F;r==="sync"?F=M:r==="post"?F=()=>gt(M,a&&a.suspense):(M.pre=!0,a&&(M.id=a.uid),F=()=>Wi(M));const V=new ts(u,Dt,F),Z=bh(),ot=()=>{V.stop(),Z&&xi(Z.effects,V)};return e?s?M():k=V.run():r==="post"?gt(V.run.bind(V),a&&a.suspense):V.run(),w&&w.push(ot),ot}function Fa(t,e,s){const i=this.proxy,r=lt(t)?t.includes(".")?po(i,t):()=>i[t]:t.bind(i,i);let n;H(e)?n=e:(n=e.handler,s=e);const o=ls(this),h=fo(r,n.bind(i),s);return o(),h}function po(t,e){const s=e.split(".");return()=>{let i=t;for(let r=0;r<s.length&&i;r++)i=i[s[r]];return i}}function oe(t,e=1/0,s){if(e<=0||!nt(t)||t.__v_skip||(s=s||new Set,s.has(t)))return t;if(s.add(t),e--,At(t))oe(t.value,e,s);else if(B(t))for(let i=0;i<t.length;i++)oe(t[i],e,s);else if(Rn(t)||ve(t))t.forEach(i=>{oe(i,e,s)});else if(bn(t)){for(const i in t)oe(t[i],e,s);for(const i of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,i)&&oe(t[i],e,s)}return t}const mo=t=>t.type.__isKeepAlive;function xa(t,e){_o(t,"a",e)}function La(t,e){_o(t,"da",e)}function _o(t,e,s=dt){const i=t.__wdc||(t.__wdc=()=>{let r=s;for(;r;){if(r.isDeactivated)return;r=r.parent}return t()});if(Us(e,i,s),s){let r=s.parent;for(;r&&r.parent;)mo(r.parent.vnode)&&ka(i,e,s,r),r=r.parent}}function ka(t,e,s,i){const r=Us(e,t,i,!0);Qn(()=>{xi(i[e],r)},s)}function Ro(t,e){t.shapeFlag&6&&t.component?Ro(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}const Va=t=>t.__isTeleport,Ut=Symbol.for("v-fgt"),Zs=Symbol.for("v-txt"),Ce=Symbol.for("v-cmt"),oi=Symbol.for("v-stc"),ze=[];let Pt=null;function ns(t=!1){ze.push(Pt=t?null:[])}function Ba(){ze.pop(),Pt=ze[ze.length-1]||null}let os=1;function vr(t){os+=t}function go(t){return t.dynamicChildren=os>0?Pt||Ne:null,Ba(),os>0&&Pt&&Pt.push(t),t}function Ps(t,e,s,i,r,n){return go(le(t,e,s,i,r,n,!0))}function Ga(t,e,s,i,r){return go(ft(t,e,s,i,r,!0))}function Ii(t){return t?t.__v_isVNode===!0:!1}function Ge(t,e){return t.type===e.type&&t.key===e.key}const So=({key:t})=>t??null,Cs=({ref:t,ref_key:e,ref_for:s})=>(typeof t=="number"&&(t=""+t),t!=null?lt(t)||At(t)||H(t)?{i:yt,r:t,k:e,f:!!s}:t:null);function le(t,e=null,s=null,i=0,r=null,n=t===Ut?0:1,o=!1,h=!1){const a={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&So(e),ref:e&&Cs(e),scopeId:zn,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:n,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null,ctx:yt};return h?(zi(a,s),n&128&&t.normalize(a)):s&&(a.shapeFlag|=lt(s)?8:16),os>0&&!o&&Pt&&(a.patchFlag>0||n&6)&&a.patchFlag!==32&&Pt.push(a),a}const ft=qa;function qa(t,e=null,s=null,i=0,r=null,n=!1){if((!t||t===ia)&&(t=Ce),Ii(t)){const h=Pe(t,e,!0);return s&&zi(h,s),os>0&&!n&&Pt&&(h.shapeFlag&6?Pt[Pt.indexOf(t)]=h:Pt.push(h)),h.patchFlag=-2,h}if(Qa(t)&&(t=t.__vccOpts),e){e=Ha(e);let{class:h,style:a}=e;h&&!lt(h)&&(e.class=ki(h)),nt(a)&&(Gn(a)&&!B(a)&&(a=at({},a)),e.style=Gs(a))}const o=lt(t)?1:na(t)?128:Va(t)?64:nt(t)?4:H(t)?2:0;return le(t,e,s,i,r,o,n,!0)}function Ha(t){return t?Gn(t)||ro(t)?at({},t):t:null}function Pe(t,e,s=!1,i=!1){const{props:r,ref:n,patchFlag:o,children:h,transition:a}=t,c=e?Ya(r||{},e):r,u={__v_isVNode:!0,__v_skip:!0,type:t.type,props:c,key:c&&So(c),ref:e&&e.ref?s&&n?B(n)?n.concat(Cs(e)):[n,Cs(e)]:Cs(e):n,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:h,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Ut?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:a,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Pe(t.ssContent),ssFallback:t.ssFallback&&Pe(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return a&&i&&Ro(u,a.clone(u)),u}function bo(t=" ",e=0){return ft(Zs,null,t,e)}function Xa(t="",e=!1){return e?(ns(),Ga(Ce,null,t)):ft(Ce,null,t)}function Vt(t){return t==null||typeof t=="boolean"?ft(Ce):B(t)?ft(Ut,null,t.slice()):typeof t=="object"?re(t):ft(Zs,null,String(t))}function re(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Pe(t)}function zi(t,e){let s=0;const{shapeFlag:i}=t;if(e==null)e=null;else if(B(e))s=16;else if(typeof e=="object")if(i&65){const r=e.default;r&&(r._c&&(r._d=!1),zi(t,r()),r._c&&(r._d=!0));return}else{s=32;const r=e._;!r&&!ro(e)?e._ctx=yt:r===3&&yt&&(yt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else H(e)?(e={default:e,_ctx:yt},s=32):(e=String(e),i&64?(s=16,e=[bo(e)]):s=8);t.children=e,t.shapeFlag|=s}function Ya(...t){const e={};for(let s=0;s<t.length;s++){const i=t[s];for(const r in i)if(r==="class")e.class!==i.class&&(e.class=ki([e.class,i.class]));else if(r==="style")e.style=Gs([e.style,i.style]);else if(Ls(r)){const n=e[r],o=i[r];o&&n!==o&&!(B(n)&&n.includes(o))&&(e[r]=n?[].concat(n,o):o)}else r!==""&&(e[r]=i[r])}return e}function kt(t,e,s,i=null){wt(t,e,7,[s,i])}const Ua=eo();let Wa=0;function Za(t,e,s){const i=t.type,r=(e?e.appContext:t.appContext)||Ua,n={uid:Wa++,vnode:t,type:i,parent:e,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new Nn(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:oo(i,r),emitsOptions:$n(i,r),emit:null,emitted:null,propsDefaults:it,inheritAttrs:i.inheritAttrs,ctx:it,data:it,props:it,attrs:it,slots:it,refs:it,setupState:it,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return n.ctx={_:n},n.root=e?e.root:n,n.emit=zh.bind(null,n),t.ce&&t.ce(n),n}let dt=null,Ms,Di;{const t=Cn(),e=(s,i)=>{let r;return(r=t[s])||(r=t[s]=[]),r.push(i),n=>{r.length>1?r.forEach(o=>o(n)):r[0](n)}};Ms=e("__VUE_INSTANCE_SETTERS__",s=>dt=s),Di=e("__VUE_SSR_SETTERS__",s=>js=s)}const ls=t=>{const e=dt;return Ms(t),t.scope.on(),()=>{t.scope.off(),Ms(e)}},Tr=()=>{dt&&dt.scope.off(),Ms(null)};function Ao(t){return t.vnode.shapeFlag&4}let js=!1;function ja(t,e=!1){e&&Di(e);const{props:s,children:i}=t.vnode,r=Ao(t);Ea(t,s,r,e),ya(t,i);const n=r?Ka(t,e):void 0;return e&&Di(!1),n}function Ka(t,e){const s=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,ma);const{setup:i}=s;if(i){const r=t.setupContext=i.length>1?za(t):null,n=ls(t);pe();const o=ae(i,t,0,[t.props,r]);if(de(),n(),gn(o)){if(o.then(Tr,Tr),e)return o.then(h=>{Or(t,h,e)}).catch(h=>{Xs(h,t,0)});t.asyncDep=o}else Or(t,o,e)}else Co(t,e)}function Or(t,e,s){H(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:nt(e)&&(t.setupState=Un(e)),Co(t,s)}let Pr;function Co(t,e,s){const i=t.type;if(!t.render){if(!e&&Pr&&!i.render){const r=i.template||Ki(t).template;if(r){const{isCustomElement:n,compilerOptions:o}=t.appContext.config,{delimiters:h,compilerOptions:a}=i,c=at(at({isCustomElement:n,delimiters:h},o),a);i.render=Pr(r,c)}}t.render=i.render||Dt}{const r=ls(t);pe();try{_a(t)}finally{de(),r()}}}const $a={get(t,e){return bt(t,"get",""),t[e]}};function za(t){const e=s=>{t.exposed=s||{}};return{attrs:new Proxy(t.attrs,$a),slots:t.slots,emit:t.emit,expose:e}}function Ks(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(Un(qn(t.exposed)),{get(e,s){if(s in e)return e[s];if(s in Ke)return Ke[s](t)},has(e,s){return s in e||s in Ke}})):t.proxy}function Ja(t,e=!0){return H(t)?t.displayName||t.name:t.name||e&&t.__name}function Qa(t){return H(t)&&"__vccOpts"in t}const St=(t,e)=>Hh(t,e,js);function Eo(t,e,s){const i=arguments.length;return i===2?nt(e)&&!B(e)?Ii(e)?ft(t,null,[e]):ft(t,e):ft(t,null,e):(i>3?s=Array.prototype.slice.call(arguments,2):i===3&&Ii(s)&&(s=[s]),ft(t,e,s))}const tl="3.4.31";/**
* @vue/runtime-dom v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const el="http://www.w3.org/2000/svg",sl="http://www.w3.org/1998/Math/MathML",Xt=typeof document<"u"?document:null,Mr=Xt&&Xt.createElement("template"),il={insert:(t,e,s)=>{e.insertBefore(t,s||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,s,i)=>{const r=e==="svg"?Xt.createElementNS(el,t):e==="mathml"?Xt.createElementNS(sl,t):s?Xt.createElement(t,{is:s}):Xt.createElement(t);return t==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:t=>Xt.createTextNode(t),createComment:t=>Xt.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Xt.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,s,i,r,n){const o=s?s.previousSibling:e.lastChild;if(r&&(r===n||r.nextSibling))for(;e.insertBefore(r.cloneNode(!0),s),!(r===n||!(r=r.nextSibling)););else{Mr.innerHTML=i==="svg"?`<svg>${t}</svg>`:i==="mathml"?`<math>${t}</math>`:t;const h=Mr.content;if(i==="svg"||i==="mathml"){const a=h.firstChild;for(;a.firstChild;)h.appendChild(a.firstChild);h.removeChild(a)}e.insertBefore(h,s)}return[o?o.nextSibling:e.firstChild,s?s.previousSibling:e.lastChild]}},rl=Symbol("_vtc");function nl(t,e,s){const i=t[rl];i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?t.removeAttribute("class"):s?t.setAttribute("class",e):t.className=e}const ws=Symbol("_vod"),Io=Symbol("_vsh"),ol={beforeMount(t,{value:e},{transition:s}){t[ws]=t.style.display==="none"?"":t.style.display,s&&e?s.beforeEnter(t):qe(t,e)},mounted(t,{value:e},{transition:s}){s&&e&&s.enter(t)},updated(t,{value:e,oldValue:s},{transition:i}){!e!=!s&&(i?e?(i.beforeEnter(t),qe(t,!0),i.enter(t)):i.leave(t,()=>{qe(t,!1)}):qe(t,e))},beforeUnmount(t,{value:e}){qe(t,e)}};function qe(t,e){t.style.display=e?t[ws]:"none",t[Io]=!e}const hl=Symbol(""),al=/(^|;)\s*display\s*:/;function ll(t,e,s){const i=t.style,r=lt(s);let n=!1;if(s&&!r){if(e)if(lt(e))for(const o of e.split(";")){const h=o.slice(0,o.indexOf(":")).trim();s[h]==null&&Es(i,h,"")}else for(const o in e)s[o]==null&&Es(i,o,"");for(const o in s)o==="display"&&(n=!0),Es(i,o,s[o])}else if(r){if(e!==s){const o=i[hl];o&&(s+=";"+o),i.cssText=s,n=al.test(s)}}else e&&t.removeAttribute("style");ws in t&&(t[ws]=n?i.display:"",t[Io]&&(i.display="none"))}const wr=/\s*!important$/;function Es(t,e,s){if(B(s))s.forEach(i=>Es(t,e,i));else if(s==null&&(s=""),e.startsWith("--"))t.setProperty(e,s);else{const i=ul(t,e);wr.test(s)?t.setProperty(ke(i),s.replace(wr,""),"important"):t[i]=s}}const Fr=["Webkit","Moz","ms"],hi={};function ul(t,e){const s=hi[e];if(s)return s;let i=Gt(e);if(i!=="filter"&&i in t)return hi[e]=i;i=Bs(i);for(let r=0;r<Fr.length;r++){const n=Fr[r]+i;if(n in t)return hi[e]=n}return e}const xr="http://www.w3.org/1999/xlink";function Lr(t,e,s,i,r,n=Rh(e)){i&&e.startsWith("xlink:")?s==null?t.removeAttributeNS(xr,e.slice(6,e.length)):t.setAttributeNS(xr,e,s):s==null||n&&!En(s)?t.removeAttribute(e):t.setAttribute(e,n?"":fe(s)?String(s):s)}function cl(t,e,s,i,r,n,o){if(e==="innerHTML"||e==="textContent"){i&&o(i,r,n),t[e]=s??"";return}const h=t.tagName;if(e==="value"&&h!=="PROGRESS"&&!h.includes("-")){const c=h==="OPTION"?t.getAttribute("value")||"":t.value,u=s==null?"":String(s);(c!==u||!("_value"in t))&&(t.value=u),s==null&&t.removeAttribute(e),t._value=s;return}let a=!1;if(s===""||s==null){const c=typeof t[e];c==="boolean"?s=En(s):s==null&&c==="string"?(s="",a=!0):c==="number"&&(s=0,a=!0)}try{t[e]=s}catch{}a&&t.removeAttribute(e)}function fl(t,e,s,i){t.addEventListener(e,s,i)}function pl(t,e,s,i){t.removeEventListener(e,s,i)}const kr=Symbol("_vei");function dl(t,e,s,i,r=null){const n=t[kr]||(t[kr]={}),o=n[e];if(i&&o)o.value=i;else{const[h,a]=ml(e);if(i){const c=n[e]=gl(i,r);fl(t,h,c,a)}else o&&(pl(t,h,o,a),n[e]=void 0)}}const Vr=/(?:Once|Passive|Capture)$/;function ml(t){let e;if(Vr.test(t)){e={};let i;for(;i=t.match(Vr);)t=t.slice(0,t.length-i[0].length),e[i[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):ke(t.slice(2)),e]}let ai=0;const _l=Promise.resolve(),Rl=()=>ai||(_l.then(()=>ai=0),ai=Date.now());function gl(t,e){const s=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=s.attached)return;wt(Sl(i,s.value),e,5,[i])};return s.value=t,s.attached=Rl(),s}function Sl(t,e){if(B(e)){const s=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{s.call(t),t._stopped=!0},e.map(i=>r=>!r._stopped&&i&&i(r))}else return e}const Br=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,bl=(t,e,s,i,r,n,o,h,a)=>{const c=r==="svg";e==="class"?nl(t,i,c):e==="style"?ll(t,s,i):Ls(e)?Fi(e)||dl(t,e,s,i,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Al(t,e,i,c))?(cl(t,e,i,n,o,h,a),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Lr(t,e,i,c,o,e!=="value")):(e==="true-value"?t._trueValue=i:e==="false-value"&&(t._falseValue=i),Lr(t,e,i,c))};function Al(t,e,s,i){if(i)return!!(e==="innerHTML"||e==="textContent"||e in t&&Br(e)&&H(s));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const r=t.tagName;if(r==="IMG"||r==="VIDEO"||r==="CANVAS"||r==="SOURCE")return!1}return Br(e)&&lt(s)?!1:e in t}const Cl=at({patchProp:bl},il);let Gr;function El(){return Gr||(Gr=va(Cl))}const Il=(...t)=>{const e=El().createApp(...t),{mount:s}=e;return e.mount=i=>{const r=yl(i);if(!r)return;const n=e._component;!H(n)&&!n.render&&!n.template&&(n.template=r.innerHTML),r.innerHTML="";const o=s(r,!1,Dl(r));return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},e};function Dl(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function yl(t){return lt(t)?document.querySelector(t):t}var Nl=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */const vl=Symbol();var qr;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(qr||(qr={}));function Tl(){const t=gh(!0),e=t.run(()=>Hs({}));let s=[],i=[];const r=qn({install(n){r._a=n,n.provide(vl,r),n.config.globalProperties.$pinia=r,i.forEach(o=>s.push(o)),i=[]},use(n){return!this._a&&!Nl?i.push(n):s.push(n),this},_p:s,_a:null,_e:t,_s:new Map,state:e});return r}const Ol={id:"app"},Pl=Ws({__name:"App",setup(t){return(e,s)=>{const i=Rr("RouterLink"),r=Rr("RouterView");return ns(),Ps("div",Ol,[le("header",null,[le("nav",null,[ft(i,{to:"/test-game"},{default:Jn(()=>[bo("测试游戏")]),_:1})])]),le("main",null,[ft(r)])])}}}),Ml=(t,e)=>{const s=t.__vccOpts||t;for(const[i,r]of e)s[i]=r;return s},wl=Ml(Pl,[["__scopeId","data-v-f9a2204b"]]);/*!
  * vue-router v4.0.13
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Do=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",Ve=t=>Do?Symbol(t):"_vr_"+t,Fl=Ve("rvlm"),Hr=Ve("rvd"),Ji=Ve("r"),yo=Ve("rl"),yi=Ve("rvl"),De=typeof window<"u";function xl(t){return t.__esModule||Do&&t[Symbol.toStringTag]==="Module"}const tt=Object.assign;function li(t,e){const s={};for(const i in e){const r=e[i];s[i]=Array.isArray(r)?r.map(t):t(r)}return s}const Je=()=>{},Ll=/\/$/,kl=t=>t.replace(Ll,"");function ui(t,e,s="/"){let i,r={},n="",o="";const h=e.indexOf("?"),a=e.indexOf("#",h>-1?h:0);return h>-1&&(i=e.slice(0,h),n=e.slice(h+1,a>-1?a:e.length),r=t(n)),a>-1&&(i=i||e.slice(0,a),o=e.slice(a,e.length)),i=ql(i??e,s),{fullPath:i+(n&&"?")+n+o,path:i,query:r,hash:o}}function Vl(t,e){const s=e.query?t(e.query):"";return e.path+(s&&"?")+s+(e.hash||"")}function Xr(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function Bl(t,e,s){const i=e.matched.length-1,r=s.matched.length-1;return i>-1&&i===r&&Me(e.matched[i],s.matched[r])&&No(e.params,s.params)&&t(e.query)===t(s.query)&&e.hash===s.hash}function Me(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function No(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const s in t)if(!Gl(t[s],e[s]))return!1;return!0}function Gl(t,e){return Array.isArray(t)?Yr(t,e):Array.isArray(e)?Yr(e,t):t===e}function Yr(t,e){return Array.isArray(e)?t.length===e.length&&t.every((s,i)=>s===e[i]):t.length===1&&t[0]===e}function ql(t,e){if(t.startsWith("/"))return t;if(!t)return e;const s=e.split("/"),i=t.split("/");let r=s.length-1,n,o;for(n=0;n<i.length;n++)if(o=i[n],!(r===1||o==="."))if(o==="..")r--;else break;return s.slice(0,r).join("/")+"/"+i.slice(n-(n===i.length?1:0)).join("/")}var hs;(function(t){t.pop="pop",t.push="push"})(hs||(hs={}));var Qe;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Qe||(Qe={}));function Hl(t){if(!t)if(De){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),kl(t)}const Xl=/^[^#]+#/;function Yl(t,e){return t.replace(Xl,"#")+e}function Ul(t,e){const s=document.documentElement.getBoundingClientRect(),i=t.getBoundingClientRect();return{behavior:e.behavior,left:i.left-s.left-(e.left||0),top:i.top-s.top-(e.top||0)}}const $s=()=>({left:window.pageXOffset,top:window.pageYOffset});function Wl(t){let e;if("el"in t){const s=t.el,i=typeof s=="string"&&s.startsWith("#"),r=typeof s=="string"?i?document.getElementById(s.slice(1)):document.querySelector(s):s;if(!r)return;e=Ul(r,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function Ur(t,e){return(history.state?history.state.position-e:-1)+t}const Ni=new Map;function Zl(t,e){Ni.set(t,e)}function jl(t){const e=Ni.get(t);return Ni.delete(t),e}let Kl=()=>location.protocol+"//"+location.host;function vo(t,e){const{pathname:s,search:i,hash:r}=e,n=t.indexOf("#");if(n>-1){let h=r.includes(t.slice(n))?t.slice(n).length:1,a=r.slice(h);return a[0]!=="/"&&(a="/"+a),Xr(a,"")}return Xr(s,t)+i+r}function $l(t,e,s,i){let r=[],n=[],o=null;const h=({state:d})=>{const A=vo(t,location),v=s.value,w=e.value;let k=0;if(d){if(s.value=A,e.value=d,o&&o===v){o=null;return}k=w?d.position-w.position:0}else i(A);r.forEach(M=>{M(s.value,v,{delta:k,type:hs.pop,direction:k?k>0?Qe.forward:Qe.back:Qe.unknown})})};function a(){o=s.value}function c(d){r.push(d);const A=()=>{const v=r.indexOf(d);v>-1&&r.splice(v,1)};return n.push(A),A}function u(){const{history:d}=window;d.state&&d.replaceState(tt({},d.state,{scroll:$s()}),"")}function p(){for(const d of n)d();n=[],window.removeEventListener("popstate",h),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",h),window.addEventListener("beforeunload",u),{pauseListeners:a,listen:c,destroy:p}}function Wr(t,e,s,i=!1,r=!1){return{back:t,current:e,forward:s,replaced:i,position:window.history.length,scroll:r?$s():null}}function zl(t){const{history:e,location:s}=window,i={value:vo(t,s)},r={value:e.state};r.value||n(i.value,{back:null,current:i.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function n(a,c,u){const p=t.indexOf("#"),d=p>-1?(s.host&&document.querySelector("base")?t:t.slice(p))+a:Kl()+t+a;try{e[u?"replaceState":"pushState"](c,"",d),r.value=c}catch(A){console.error(A),s[u?"replace":"assign"](d)}}function o(a,c){const u=tt({},e.state,Wr(r.value.back,a,r.value.forward,!0),c,{position:r.value.position});n(a,u,!0),i.value=a}function h(a,c){const u=tt({},r.value,e.state,{forward:a,scroll:$s()});n(u.current,u,!0);const p=tt({},Wr(i.value,a,null),{position:u.position+1},c);n(a,p,!1),i.value=a}return{location:i,state:r,push:h,replace:o}}function Jl(t){t=Hl(t);const e=zl(t),s=$l(t,e.state,e.location,e.replace);function i(n,o=!0){o||s.pauseListeners(),history.go(n)}const r=tt({location:"",base:t,go:i,createHref:Yl.bind(null,t)},e,s);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>e.state.value}),r}function Ql(t){return typeof t=="string"||t&&typeof t=="object"}function To(t){return typeof t=="string"||typeof t=="symbol"}const ee={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Oo=Ve("nf");var Zr;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(Zr||(Zr={}));function we(t,e){return tt(new Error,{type:t,[Oo]:!0},e)}function se(t,e){return t instanceof Error&&Oo in t&&(e==null||!!(t.type&e))}const jr="[^/]+?",tu={sensitive:!1,strict:!1,start:!0,end:!0},eu=/[.+*?^${}()[\]/\\]/g;function su(t,e){const s=tt({},tu,e),i=[];let r=s.start?"^":"";const n=[];for(const c of t){const u=c.length?[]:[90];s.strict&&!c.length&&(r+="/");for(let p=0;p<c.length;p++){const d=c[p];let A=40+(s.sensitive?.25:0);if(d.type===0)p||(r+="/"),r+=d.value.replace(eu,"\\$&"),A+=40;else if(d.type===1){const{value:v,repeatable:w,optional:k,regexp:M}=d;n.push({name:v,repeatable:w,optional:k});const F=M||jr;if(F!==jr){A+=10;try{new RegExp(`(${F})`)}catch(Z){throw new Error(`Invalid custom RegExp for param "${v}" (${F}): `+Z.message)}}let V=w?`((?:${F})(?:/(?:${F}))*)`:`(${F})`;p||(V=k&&c.length<2?`(?:/${V})`:"/"+V),k&&(V+="?"),r+=V,A+=20,k&&(A+=-8),w&&(A+=-20),F===".*"&&(A+=-50)}u.push(A)}i.push(u)}if(s.strict&&s.end){const c=i.length-1;i[c][i[c].length-1]+=.7000000000000001}s.strict||(r+="/?"),s.end?r+="$":s.strict&&(r+="(?:/|$)");const o=new RegExp(r,s.sensitive?"":"i");function h(c){const u=c.match(o),p={};if(!u)return null;for(let d=1;d<u.length;d++){const A=u[d]||"",v=n[d-1];p[v.name]=A&&v.repeatable?A.split("/"):A}return p}function a(c){let u="",p=!1;for(const d of t){(!p||!u.endsWith("/"))&&(u+="/"),p=!1;for(const A of d)if(A.type===0)u+=A.value;else if(A.type===1){const{value:v,repeatable:w,optional:k}=A,M=v in c?c[v]:"";if(Array.isArray(M)&&!w)throw new Error(`Provided param "${v}" is an array but it is not repeatable (* or + modifiers)`);const F=Array.isArray(M)?M.join("/"):M;if(!F)if(k)d.length<2&&(u.endsWith("/")?u=u.slice(0,-1):p=!0);else throw new Error(`Missing required param "${v}"`);u+=F}}return u}return{re:o,score:i,keys:n,parse:h,stringify:a}}function iu(t,e){let s=0;for(;s<t.length&&s<e.length;){const i=e[s]-t[s];if(i)return i;s++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function ru(t,e){let s=0;const i=t.score,r=e.score;for(;s<i.length&&s<r.length;){const n=iu(i[s],r[s]);if(n)return n;s++}return r.length-i.length}const nu={type:0,value:""},ou=/[a-zA-Z0-9_]/;function hu(t){if(!t)return[[]];if(t==="/")return[[nu]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(A){throw new Error(`ERR (${s})/"${c}": ${A}`)}let s=0,i=s;const r=[];let n;function o(){n&&r.push(n),n=[]}let h=0,a,c="",u="";function p(){c&&(s===0?n.push({type:0,value:c}):s===1||s===2||s===3?(n.length>1&&(a==="*"||a==="+")&&e(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),n.push({type:1,value:c,regexp:u,repeatable:a==="*"||a==="+",optional:a==="*"||a==="?"})):e("Invalid state to consume buffer"),c="")}function d(){c+=a}for(;h<t.length;){if(a=t[h++],a==="\\"&&s!==2){i=s,s=4;continue}switch(s){case 0:a==="/"?(c&&p(),o()):a===":"?(p(),s=1):d();break;case 4:d(),s=i;break;case 1:a==="("?s=2:ou.test(a)?d():(p(),s=0,a!=="*"&&a!=="?"&&a!=="+"&&h--);break;case 2:a===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+a:s=3:u+=a;break;case 3:p(),s=0,a!=="*"&&a!=="?"&&a!=="+"&&h--,u="";break;default:e("Unknown state");break}}return s===2&&e(`Unfinished custom RegExp for param "${c}"`),p(),o(),r}function au(t,e,s){const i=su(hu(t.path),s),r=tt(i,{record:t,parent:e,children:[],alias:[]});return e&&!r.record.aliasOf==!e.record.aliasOf&&e.children.push(r),r}function lu(t,e){const s=[],i=new Map;e=$r({strict:!1,end:!0,sensitive:!1},e);function r(u){return i.get(u)}function n(u,p,d){const A=!d,v=cu(u);v.aliasOf=d&&d.record;const w=$r(e,u),k=[v];if("alias"in u){const V=typeof u.alias=="string"?[u.alias]:u.alias;for(const Z of V)k.push(tt({},v,{components:d?d.record.components:v.components,path:Z,aliasOf:d?d.record:v}))}let M,F;for(const V of k){const{path:Z}=V;if(p&&Z[0]!=="/"){const ot=p.record.path,G=ot[ot.length-1]==="/"?"":"/";V.path=p.record.path+(Z&&G+Z)}if(M=au(V,p,w),d?d.alias.push(M):(F=F||M,F!==M&&F.alias.push(M),A&&u.name&&!Kr(M)&&o(u.name)),"children"in v){const ot=v.children;for(let G=0;G<ot.length;G++)n(ot[G],M,d&&d.children[G])}d=d||M,a(M)}return F?()=>{o(F)}:Je}function o(u){if(To(u)){const p=i.get(u);p&&(i.delete(u),s.splice(s.indexOf(p),1),p.children.forEach(o),p.alias.forEach(o))}else{const p=s.indexOf(u);p>-1&&(s.splice(p,1),u.record.name&&i.delete(u.record.name),u.children.forEach(o),u.alias.forEach(o))}}function h(){return s}function a(u){let p=0;for(;p<s.length&&ru(u,s[p])>=0&&(u.record.path!==s[p].record.path||!Po(u,s[p]));)p++;s.splice(p,0,u),u.record.name&&!Kr(u)&&i.set(u.record.name,u)}function c(u,p){let d,A={},v,w;if("name"in u&&u.name){if(d=i.get(u.name),!d)throw we(1,{location:u});w=d.record.name,A=tt(uu(p.params,d.keys.filter(F=>!F.optional).map(F=>F.name)),u.params),v=d.stringify(A)}else if("path"in u)v=u.path,d=s.find(F=>F.re.test(v)),d&&(A=d.parse(v),w=d.record.name);else{if(d=p.name?i.get(p.name):s.find(F=>F.re.test(p.path)),!d)throw we(1,{location:u,currentLocation:p});w=d.record.name,A=tt({},p.params,u.params),v=d.stringify(A)}const k=[];let M=d;for(;M;)k.unshift(M.record),M=M.parent;return{name:w,path:v,params:A,matched:k,meta:pu(k)}}return t.forEach(u=>n(u)),{addRoute:n,resolve:c,removeRoute:o,getRoutes:h,getRecordMatcher:r}}function uu(t,e){const s={};for(const i of e)i in t&&(s[i]=t[i]);return s}function cu(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:fu(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||{}:{default:t.component}}}function fu(t){const e={},s=t.props||!1;if("component"in t)e.default=s;else for(const i in t.components)e[i]=typeof s=="boolean"?s:s[i];return e}function Kr(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function pu(t){return t.reduce((e,s)=>tt(e,s.meta),{})}function $r(t,e){const s={};for(const i in t)s[i]=i in e?e[i]:t[i];return s}function Po(t,e){return e.children.some(s=>s===t||Po(t,s))}const Mo=/#/g,du=/&/g,mu=/\//g,_u=/=/g,Ru=/\?/g,wo=/\+/g,gu=/%5B/g,Su=/%5D/g,Fo=/%5E/g,bu=/%60/g,xo=/%7B/g,Au=/%7C/g,Lo=/%7D/g,Cu=/%20/g;function Qi(t){return encodeURI(""+t).replace(Au,"|").replace(gu,"[").replace(Su,"]")}function Eu(t){return Qi(t).replace(xo,"{").replace(Lo,"}").replace(Fo,"^")}function vi(t){return Qi(t).replace(wo,"%2B").replace(Cu,"+").replace(Mo,"%23").replace(du,"%26").replace(bu,"`").replace(xo,"{").replace(Lo,"}").replace(Fo,"^")}function Iu(t){return vi(t).replace(_u,"%3D")}function Du(t){return Qi(t).replace(Mo,"%23").replace(Ru,"%3F")}function yu(t){return t==null?"":Du(t).replace(mu,"%2F")}function Fs(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function Nu(t){const e={};if(t===""||t==="?")return e;const i=(t[0]==="?"?t.slice(1):t).split("&");for(let r=0;r<i.length;++r){const n=i[r].replace(wo," "),o=n.indexOf("="),h=Fs(o<0?n:n.slice(0,o)),a=o<0?null:Fs(n.slice(o+1));if(h in e){let c=e[h];Array.isArray(c)||(c=e[h]=[c]),c.push(a)}else e[h]=a}return e}function zr(t){let e="";for(let s in t){const i=t[s];if(s=Iu(s),i==null){i!==void 0&&(e+=(e.length?"&":"")+s);continue}(Array.isArray(i)?i.map(n=>n&&vi(n)):[i&&vi(i)]).forEach(n=>{n!==void 0&&(e+=(e.length?"&":"")+s,n!=null&&(e+="="+n))})}return e}function vu(t){const e={};for(const s in t){const i=t[s];i!==void 0&&(e[s]=Array.isArray(i)?i.map(r=>r==null?null:""+r):i==null?i:""+i)}return e}function He(){let t=[];function e(i){return t.push(i),()=>{const r=t.indexOf(i);r>-1&&t.splice(r,1)}}function s(){t=[]}return{add:e,list:()=>t,reset:s}}function ne(t,e,s,i,r){const n=i&&(i.enterCallbacks[r]=i.enterCallbacks[r]||[]);return()=>new Promise((o,h)=>{const a=p=>{p===!1?h(we(4,{from:s,to:e})):p instanceof Error?h(p):Ql(p)?h(we(2,{from:e,to:p})):(n&&i.enterCallbacks[r]===n&&typeof p=="function"&&n.push(p),o())},c=t.call(i&&i.instances[r],e,s,a);let u=Promise.resolve(c);t.length<3&&(u=u.then(a)),u.catch(p=>h(p))})}function ci(t,e,s,i){const r=[];for(const n of t)for(const o in n.components){let h=n.components[o];if(!(e!=="beforeRouteEnter"&&!n.instances[o]))if(Tu(h)){const c=(h.__vccOpts||h)[e];c&&r.push(ne(c,s,i,n,o))}else{let a=h();r.push(()=>a.then(c=>{if(!c)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${n.path}"`));const u=xl(c)?c.default:c;n.components[o]=u;const d=(u.__vccOpts||u)[e];return d&&ne(d,s,i,n,o)()}))}}return r}function Tu(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function Jr(t){const e=jt(Ji),s=jt(yo),i=St(()=>e.resolve(Zt(t.to))),r=St(()=>{const{matched:a}=i.value,{length:c}=a,u=a[c-1],p=s.matched;if(!u||!p.length)return-1;const d=p.findIndex(Me.bind(null,u));if(d>-1)return d;const A=Qr(a[c-2]);return c>1&&Qr(u)===A&&p[p.length-1].path!==A?p.findIndex(Me.bind(null,a[c-2])):d}),n=St(()=>r.value>-1&&wu(s.params,i.value.params)),o=St(()=>r.value>-1&&r.value===s.matched.length-1&&No(s.params,i.value.params));function h(a={}){return Mu(a)?e[Zt(t.replace)?"replace":"push"](Zt(t.to)).catch(Je):Promise.resolve()}return{route:i,href:St(()=>i.value.href),isActive:n,isExactActive:o,navigate:h}}const Ou=Ws({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Jr,setup(t,{slots:e}){const s=as(Jr(t)),{options:i}=jt(Ji),r=St(()=>({[tn(t.activeClass,i.linkActiveClass,"router-link-active")]:s.isActive,[tn(t.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:s.isExactActive}));return()=>{const n=e.default&&e.default(s);return t.custom?n:Eo("a",{"aria-current":s.isExactActive?t.ariaCurrentValue:null,href:s.href,onClick:s.navigate,class:r.value},n)}}}),Pu=Ou;function Mu(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function wu(t,e){for(const s in e){const i=e[s],r=t[s];if(typeof i=="string"){if(i!==r)return!1}else if(!Array.isArray(r)||r.length!==i.length||i.some((n,o)=>n!==r[o]))return!1}return!0}function Qr(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const tn=(t,e,s)=>t??e??s,Fu=Ws({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},setup(t,{attrs:e,slots:s}){const i=jt(yi),r=St(()=>t.route||i.value),n=jt(Hr,0),o=St(()=>r.value.matched[n]);As(Hr,n+1),As(Fl,o),As(yi,r);const h=Hs();return Kt(()=>[h.value,o.value,t.name],([a,c,u],[p,d,A])=>{c&&(c.instances[u]=a,d&&d!==c&&a&&a===p&&(c.leaveGuards.size||(c.leaveGuards=d.leaveGuards),c.updateGuards.size||(c.updateGuards=d.updateGuards))),a&&c&&(!d||!Me(c,d)||!p)&&(c.enterCallbacks[u]||[]).forEach(v=>v(a))},{flush:"post"}),()=>{const a=r.value,c=o.value,u=c&&c.components[t.name],p=t.name;if(!u)return en(s.default,{Component:u,route:a});const d=c.props[t.name],A=d?d===!0?a.params:typeof d=="function"?d(a):d:null,w=Eo(u,tt({},A,e,{onVnodeUnmounted:k=>{k.component.isUnmounted&&(c.instances[p]=null)},ref:h}));return en(s.default,{Component:w,route:a})||w}}});function en(t,e){if(!t)return null;const s=t(e);return s.length===1?s[0]:s}const xu=Fu;function Lu(t){const e=lu(t.routes,t),s=t.parseQuery||Nu,i=t.stringifyQuery||zr,r=t.history,n=He(),o=He(),h=He(),a=Xh(ee);let c=ee;De&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=li.bind(null,_=>""+_),p=li.bind(null,yu),d=li.bind(null,Fs);function A(_,I){let y,O;return To(_)?(y=e.getRecordMatcher(_),O=I):O=_,e.addRoute(O,y)}function v(_){const I=e.getRecordMatcher(_);I&&e.removeRoute(I)}function w(){return e.getRoutes().map(_=>_.record)}function k(_){return!!e.getRecordMatcher(_)}function M(_,I){if(I=tt({},I||a.value),typeof _=="string"){const Y=ui(s,_,I.path),l=e.resolve({path:Y.path},I),f=r.createHref(Y.fullPath);return tt(Y,l,{params:d(l.params),hash:Fs(Y.hash),redirectedFrom:void 0,href:f})}let y;if("path"in _)y=tt({},_,{path:ui(s,_.path,I.path).path});else{const Y=tt({},_.params);for(const l in Y)Y[l]==null&&delete Y[l];y=tt({},_,{params:p(_.params)}),I.params=p(I.params)}const O=e.resolve(y,I),Q=_.hash||"";O.params=u(d(O.params));const et=Vl(i,tt({},_,{hash:Eu(Q),path:O.path})),W=r.createHref(et);return tt({fullPath:et,hash:Q,query:i===zr?vu(_.query):_.query||{}},O,{redirectedFrom:void 0,href:W})}function F(_){return typeof _=="string"?ui(s,_,a.value.path):tt({},_)}function V(_,I){if(c!==_)return we(8,{from:I,to:_})}function Z(_){return ut(_)}function ot(_){return Z(tt(F(_),{replace:!0}))}function G(_){const I=_.matched[_.matched.length-1];if(I&&I.redirect){const{redirect:y}=I;let O=typeof y=="function"?y(_):y;return typeof O=="string"&&(O=O.includes("?")||O.includes("#")?O=F(O):{path:O},O.params={}),tt({query:_.query,hash:_.hash,params:_.params},O)}}function ut(_,I){const y=c=M(_),O=a.value,Q=_.state,et=_.force,W=_.replace===!0,Y=G(y);if(Y)return ut(tt(F(Y),{state:Q,force:et,replace:W}),I||y);const l=y;l.redirectedFrom=I;let f;return!et&&Bl(i,O,y)&&(f=we(16,{to:l,from:O}),Ht(O,O,!0,!1)),(f?Promise.resolve(f):zt(l,O)).catch(m=>se(m)?se(m,2)?m:Ct(m):J(m,l,O)).then(m=>{if(m){if(se(m,2))return ut(tt(F(m.to),{state:Q,force:et,replace:W}),I||l)}else m=Ft(l,O,!0,W,Q);return Nt(l,O,m),m})}function Rt(_,I){const y=V(_,I);return y?Promise.reject(y):Promise.resolve()}function zt(_,I){let y;const[O,Q,et]=ku(_,I);y=ci(O.reverse(),"beforeRouteLeave",_,I);for(const Y of O)Y.leaveGuards.forEach(l=>{y.push(ne(l,_,I))});const W=Rt.bind(null,_,I);return y.push(W),Ie(y).then(()=>{y=[];for(const Y of n.list())y.push(ne(Y,_,I));return y.push(W),Ie(y)}).then(()=>{y=ci(Q,"beforeRouteUpdate",_,I);for(const Y of Q)Y.updateGuards.forEach(l=>{y.push(ne(l,_,I))});return y.push(W),Ie(y)}).then(()=>{y=[];for(const Y of _.matched)if(Y.beforeEnter&&!I.matched.includes(Y))if(Array.isArray(Y.beforeEnter))for(const l of Y.beforeEnter)y.push(ne(l,_,I));else y.push(ne(Y.beforeEnter,_,I));return y.push(W),Ie(y)}).then(()=>(_.matched.forEach(Y=>Y.enterCallbacks={}),y=ci(et,"beforeRouteEnter",_,I),y.push(W),Ie(y))).then(()=>{y=[];for(const Y of o.list())y.push(ne(Y,_,I));return y.push(W),Ie(y)}).catch(Y=>se(Y,8)?Y:Promise.reject(Y))}function Nt(_,I,y){for(const O of h.list())O(_,I,y)}function Ft(_,I,y,O,Q){const et=V(_,I);if(et)return et;const W=I===ee,Y=De?history.state:{};y&&(O||W?r.replace(_.fullPath,tt({scroll:W&&Y&&Y.scroll},Q)):r.push(_.fullPath,Q)),a.value=_,Ht(_,I,y,W),Ct()}let xt;function Jt(){xt=r.listen((_,I,y)=>{const O=M(_),Q=G(O);if(Q){ut(tt(Q,{replace:!0}),O).catch(Je);return}c=O;const et=a.value;De&&Zl(Ur(et.fullPath,y.delta),$s()),zt(O,et).catch(W=>se(W,12)?W:se(W,2)?(ut(W.to,O).then(Y=>{se(Y,20)&&!y.delta&&y.type===hs.pop&&r.go(-1,!1)}).catch(Je),Promise.reject()):(y.delta&&r.go(-y.delta,!1),J(W,O,et))).then(W=>{W=W||Ft(O,et,!1),W&&(y.delta?r.go(-y.delta,!1):y.type===hs.pop&&se(W,20)&&r.go(-1,!1)),Nt(O,et,W)}).catch(Je)})}let vt=He(),me=He(),rt;function J(_,I,y){Ct(_);const O=me.list();return O.length?O.forEach(Q=>Q(_,I,y)):console.error(_),Promise.reject(_)}function K(){return rt&&a.value!==ee?Promise.resolve():new Promise((_,I)=>{vt.add([_,I])})}function Ct(_){return rt||(rt=!_,Jt(),vt.list().forEach(([I,y])=>_?y(_):I()),vt.reset()),_}function Ht(_,I,y,O){const{scrollBehavior:Q}=t;if(!De||!Q)return Promise.resolve();const et=!y&&jl(Ur(_.fullPath,0))||(O||!y)&&history.state&&history.state.scroll||null;return Ui().then(()=>Q(_,I,et)).then(W=>W&&Wl(W)).catch(W=>J(W,_,I))}const Et=_=>r.go(_);let ct;const Qt=new Set;return{currentRoute:a,addRoute:A,removeRoute:v,hasRoute:k,getRoutes:w,resolve:M,options:t,push:Z,replace:ot,go:Et,back:()=>Et(-1),forward:()=>Et(1),beforeEach:n.add,beforeResolve:o.add,afterEach:h.add,onError:me.add,isReady:K,install(_){const I=this;_.component("RouterLink",Pu),_.component("RouterView",xu),_.config.globalProperties.$router=I,Object.defineProperty(_.config.globalProperties,"$route",{enumerable:!0,get:()=>Zt(a)}),De&&!ct&&a.value===ee&&(ct=!0,Z(r.location).catch(Q=>{}));const y={};for(const Q in ee)y[Q]=St(()=>a.value[Q]);_.provide(Ji,I),_.provide(yo,as(y)),_.provide(yi,a);const O=_.unmount;Qt.add(_),_.unmount=function(){Qt.delete(_),Qt.size<1&&(c=ee,xt&&xt(),a.value=ee,ct=!1,rt=!1),O()}}}}function Ie(t){return t.reduce((e,s)=>e.then(()=>s()),Promise.resolve())}function ku(t,e){const s=[],i=[],r=[],n=Math.max(e.matched.length,t.matched.length);for(let o=0;o<n;o++){const h=e.matched[o];h&&(t.matched.find(c=>Me(c,h))?i.push(h):s.push(h));const a=t.matched[o];a&&(e.matched.find(c=>Me(c,a))||r.push(a))}return[s,i,r]}var Vu=Object.defineProperty,Bu=(t,e,s)=>e in t?Vu(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,mt=(t,e,s)=>(Bu(t,typeof e!="symbol"?e+"":e,s),s);function tr(t,e,s){return e>s&&([e,s]=[s,e]),Math.min(s,Math.max(e,t))}function Mt(t,e){return Array.from({length:t}).fill(e)}function Gu(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function qu(t){return t===void 0}function Hu(t){return t===null}function zs(t){return typeof t=="number"?isNaN(t):Hu(t)||qu(t)}function Xu(t){return!zs(t)}function Yu(t,e=!0){const s=e?!1:zs(t);return Array.isArray(t)?t.length===0:s}function Uu(t,e=!0){const s=e?!1:zs(t);return Gu(t)?Yu(Object.keys(t)):s}function Wu(t){return Object.keys(t)}function fi(t){return Object.entries(t)}function Xe(t,e=16){e=tr(e,2,36);let s="";for(let i=1;i<=t;i++)s+=Math.floor(Math.random()*e).toString(e);return s}function ko(){let t="";if(typeof crypto<"u"&&"randomUUID"in crypto)t=crypto.randomUUID();else if(typeof Blob>"u")t=`${Xe(8)}-${Xe(4)}-${Xe(4)}-${Xe(4)}-${Xe(12)}`;else{const e=URL.createObjectURL(new Blob);t=e.toString().substring(e.lastIndexOf("/")+1),URL.revokeObjectURL(e)}return t}function Zu(t,e=ko()){const s=document.createElement("a");s.href=t,s.download=e,s.click()}function ju(t,e=ko()){Zu(t.toDataURL("image/png"),e)}class Ku{constructor(e,s,i){mt(this,"_dataFactory",window.indexedDB),mt(this,"_dbName"),mt(this,"_storeName"),mt(this,"_database"),mt(this,"_res"),this._dataFactory=window.indexedDB,this._dbName=e,this._storeName=s,this._res=this._dataFactory.open(this._dbName,i),this._res.addEventListener("success",()=>{this._database=this._res.result,this._database.objectStoreNames.contains(this._storeName)||this._database.createObjectStore(this._storeName,{keyPath:"id"})}),this._res.addEventListener("error",()=>{console.error("indexedDB load error")}),this._res.addEventListener("upgradeneeded",()=>{this._database=this._res.result,this._database.objectStoreNames.contains(this._storeName)||this._database.createObjectStore(this._storeName,{keyPath:"id"})})}get _store(){return this._database.transaction([this._storeName],"readwrite").objectStore(this._storeName)}set_item(e,s){this._store.put({id:e,data:s})}get_item(e){const s=this._store.get(e);return new Promise((i,r)=>{s.addEventListener("success",()=>{i(s.result.data)}),s.addEventListener("error",r)})}remove_item(e){this._store.delete(e)}clear(){this._store.clear()}}function $u(t,e){return new Ku(t,e)}var qt=function(){this.state=new Array(8);for(var t=0;t<this.state.length;t++)this.state[t]=64};qt.BUTTON_A=0;qt.BUTTON_B=1;qt.BUTTON_SELECT=2;qt.BUTTON_START=3;qt.BUTTON_UP=4;qt.BUTTON_DOWN=5;qt.BUTTON_LEFT=6;qt.BUTTON_RIGHT=7;qt.prototype={buttonDown:function(t){this.state[t]=65},buttonUp:function(t){this.state[t]=64}};var Vo=qt,er={copyArrayElements:function(t,e,s,i,r){for(var n=0;n<r;++n)s[i+n]=t[e+n]},copyArray:function(t){return t.slice(0)},fromJSON:function(t,e){for(var s=0;s<t.JSON_PROPERTIES.length;s++)t[t.JSON_PROPERTIES[s]]=e[t.JSON_PROPERTIES[s]]},toJSON:function(t){for(var e={},s=0;s<t.JSON_PROPERTIES.length;s++)e[t.JSON_PROPERTIES[s]]=t[t.JSON_PROPERTIES[s]];return e}},sn=er,Bo=function(t){this.nes=t,this.mem=null,this.REG_ACC=null,this.REG_X=null,this.REG_Y=null,this.REG_SP=null,this.REG_PC=null,this.REG_PC_NEW=null,this.REG_STATUS=null,this.F_CARRY=null,this.F_DECIMAL=null,this.F_INTERRUPT=null,this.F_INTERRUPT_NEW=null,this.F_OVERFLOW=null,this.F_SIGN=null,this.F_ZERO=null,this.F_NOTUSED=null,this.F_NOTUSED_NEW=null,this.F_BRK=null,this.F_BRK_NEW=null,this.opdata=null,this.cyclesToHalt=null,this.crash=null,this.irqRequested=null,this.irqType=null,this.reset()};Bo.prototype={IRQ_NORMAL:0,IRQ_NMI:1,IRQ_RESET:2,reset:function(){this.mem=new Array(65536);for(var t=0;t<8192;t++)this.mem[t]=255;for(var e=0;e<4;e++){var s=e*2048;this.mem[s+8]=247,this.mem[s+9]=239,this.mem[s+10]=223,this.mem[s+15]=191}for(var i=8193;i<this.mem.length;i++)this.mem[i]=0;this.REG_ACC=0,this.REG_X=0,this.REG_Y=0,this.REG_SP=511,this.REG_PC=32767,this.REG_PC_NEW=32767,this.REG_STATUS=40,this.setStatus(40),this.F_CARRY=0,this.F_DECIMAL=0,this.F_INTERRUPT=1,this.F_INTERRUPT_NEW=1,this.F_OVERFLOW=0,this.F_SIGN=0,this.F_ZERO=1,this.F_NOTUSED=1,this.F_NOTUSED_NEW=1,this.F_BRK=1,this.F_BRK_NEW=1,this.opdata=new Go().opdata,this.cyclesToHalt=0,this.crash=!1,this.irqRequested=!1,this.irqType=null},emulate:function(){var t,e;if(this.irqRequested){switch(t=this.F_CARRY|(this.F_ZERO===0?1:0)<<1|this.F_INTERRUPT<<2|this.F_DECIMAL<<3|this.F_BRK<<4|this.F_NOTUSED<<5|this.F_OVERFLOW<<6|this.F_SIGN<<7,this.REG_PC_NEW=this.REG_PC,this.F_INTERRUPT_NEW=this.F_INTERRUPT,this.irqType){case 0:{if(this.F_INTERRUPT!==0)break;this.doIrq(t);break}case 1:{this.doNonMaskableInterrupt(t);break}case 2:{this.doResetInterrupt();break}}this.REG_PC=this.REG_PC_NEW,this.F_INTERRUPT=this.F_INTERRUPT_NEW,this.F_BRK=this.F_BRK_NEW,this.irqRequested=!1}var s=this.opdata[this.nes.mmap.load(this.REG_PC+1)],i=s>>24,r=0,n=s>>8&255,o=this.REG_PC;this.REG_PC+=s>>16&255;var h=0;switch(n){case 0:{h=this.load(o+2);break}case 1:{h=this.load(o+2),h<128?h+=this.REG_PC:h+=this.REG_PC-256;break}case 2:break;case 3:{h=this.load16bit(o+2);break}case 4:{h=this.REG_ACC;break}case 5:{h=this.REG_PC;break}case 6:{h=this.load(o+2)+this.REG_X&255;break}case 7:{h=this.load(o+2)+this.REG_Y&255;break}case 8:{h=this.load16bit(o+2),(h&65280)!==(h+this.REG_X&65280)&&(r=1),h+=this.REG_X;break}case 9:{h=this.load16bit(o+2),(h&65280)!==(h+this.REG_Y&65280)&&(r=1),h+=this.REG_Y;break}case 10:{h=this.load(o+2),(h&65280)!==(h+this.REG_X&65280)&&(r=1),h+=this.REG_X,h&=255,h=this.load16bit(h);break}case 11:{h=this.load16bit(this.load(o+2)),(h&65280)!==(h+this.REG_Y&65280)&&(r=1),h+=this.REG_Y;break}case 12:{h=this.load16bit(o+2),h<8191?h=this.mem[h]+(this.mem[h&65280|(h&255)+1&255]<<8):h=this.nes.mmap.load(h)+(this.nes.mmap.load(h&65280|(h&255)+1&255)<<8);break}}switch(h&=65535,s&255){case 0:{t=this.REG_ACC+this.load(h)+this.F_CARRY,!((this.REG_ACC^this.load(h))&128)&&(this.REG_ACC^t)&128?this.F_OVERFLOW=1:this.F_OVERFLOW=0,this.F_CARRY=t>255?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255,this.REG_ACC=t&255,i+=r;break}case 1:{this.REG_ACC=this.REG_ACC&this.load(h),this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,n!==11&&(i+=r);break}case 2:{n===4?(this.F_CARRY=this.REG_ACC>>7&1,this.REG_ACC=this.REG_ACC<<1&255,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC):(t=this.load(h),this.F_CARRY=t>>7&1,t=t<<1&255,this.F_SIGN=t>>7&1,this.F_ZERO=t,this.write(h,t));break}case 3:{this.F_CARRY===0&&(i+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 4:{this.F_CARRY===1&&(i+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 5:{this.F_ZERO===0&&(i+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 6:{t=this.load(h),this.F_SIGN=t>>7&1,this.F_OVERFLOW=t>>6&1,t&=this.REG_ACC,this.F_ZERO=t;break}case 7:{this.F_SIGN===1&&(i++,this.REG_PC=h);break}case 8:{this.F_ZERO!==0&&(i+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 9:{this.F_SIGN===0&&(i+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 10:{this.REG_PC+=2,this.push(this.REG_PC>>8&255),this.push(this.REG_PC&255),this.F_BRK=1,this.push(this.F_CARRY|(this.F_ZERO===0?1:0)<<1|this.F_INTERRUPT<<2|this.F_DECIMAL<<3|this.F_BRK<<4|this.F_NOTUSED<<5|this.F_OVERFLOW<<6|this.F_SIGN<<7),this.F_INTERRUPT=1,this.REG_PC=this.load16bit(65534),this.REG_PC--;break}case 11:{this.F_OVERFLOW===0&&(i+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 12:{this.F_OVERFLOW===1&&(i+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 13:{this.F_CARRY=0;break}case 14:{this.F_DECIMAL=0;break}case 15:{this.F_INTERRUPT=0;break}case 16:{this.F_OVERFLOW=0;break}case 17:{t=this.REG_ACC-this.load(h),this.F_CARRY=t>=0?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255,i+=r;break}case 18:{t=this.REG_X-this.load(h),this.F_CARRY=t>=0?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255;break}case 19:{t=this.REG_Y-this.load(h),this.F_CARRY=t>=0?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255;break}case 20:{t=this.load(h)-1&255,this.F_SIGN=t>>7&1,this.F_ZERO=t,this.write(h,t);break}case 21:{this.REG_X=this.REG_X-1&255,this.F_SIGN=this.REG_X>>7&1,this.F_ZERO=this.REG_X;break}case 22:{this.REG_Y=this.REG_Y-1&255,this.F_SIGN=this.REG_Y>>7&1,this.F_ZERO=this.REG_Y;break}case 23:{this.REG_ACC=(this.load(h)^this.REG_ACC)&255,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,i+=r;break}case 24:{t=this.load(h)+1&255,this.F_SIGN=t>>7&1,this.F_ZERO=t,this.write(h,t&255);break}case 25:{this.REG_X=this.REG_X+1&255,this.F_SIGN=this.REG_X>>7&1,this.F_ZERO=this.REG_X;break}case 26:{this.REG_Y++,this.REG_Y&=255,this.F_SIGN=this.REG_Y>>7&1,this.F_ZERO=this.REG_Y;break}case 27:{this.REG_PC=h-1;break}case 28:{this.push(this.REG_PC>>8&255),this.push(this.REG_PC&255),this.REG_PC=h-1;break}case 29:{this.REG_ACC=this.load(h),this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,i+=r;break}case 30:{this.REG_X=this.load(h),this.F_SIGN=this.REG_X>>7&1,this.F_ZERO=this.REG_X,i+=r;break}case 31:{this.REG_Y=this.load(h),this.F_SIGN=this.REG_Y>>7&1,this.F_ZERO=this.REG_Y,i+=r;break}case 32:{n===4?(t=this.REG_ACC&255,this.F_CARRY=t&1,t>>=1,this.REG_ACC=t):(t=this.load(h)&255,this.F_CARRY=t&1,t>>=1,this.write(h,t)),this.F_SIGN=0,this.F_ZERO=t;break}case 33:break;case 34:{t=(this.load(h)|this.REG_ACC)&255,this.F_SIGN=t>>7&1,this.F_ZERO=t,this.REG_ACC=t,n!==11&&(i+=r);break}case 35:{this.push(this.REG_ACC);break}case 36:{this.F_BRK=1,this.push(this.F_CARRY|(this.F_ZERO===0?1:0)<<1|this.F_INTERRUPT<<2|this.F_DECIMAL<<3|this.F_BRK<<4|this.F_NOTUSED<<5|this.F_OVERFLOW<<6|this.F_SIGN<<7);break}case 37:{this.REG_ACC=this.pull(),this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC;break}case 38:{t=this.pull(),this.F_CARRY=t&1,this.F_ZERO=(t>>1&1)===1?0:1,this.F_INTERRUPT=t>>2&1,this.F_DECIMAL=t>>3&1,this.F_BRK=t>>4&1,this.F_NOTUSED=t>>5&1,this.F_OVERFLOW=t>>6&1,this.F_SIGN=t>>7&1,this.F_NOTUSED=1;break}case 39:{n===4?(t=this.REG_ACC,e=this.F_CARRY,this.F_CARRY=t>>7&1,t=(t<<1&255)+e,this.REG_ACC=t):(t=this.load(h),e=this.F_CARRY,this.F_CARRY=t>>7&1,t=(t<<1&255)+e,this.write(h,t)),this.F_SIGN=t>>7&1,this.F_ZERO=t;break}case 40:{n===4?(e=this.F_CARRY<<7,this.F_CARRY=this.REG_ACC&1,t=(this.REG_ACC>>1)+e,this.REG_ACC=t):(t=this.load(h),e=this.F_CARRY<<7,this.F_CARRY=t&1,t=(t>>1)+e,this.write(h,t)),this.F_SIGN=t>>7&1,this.F_ZERO=t;break}case 41:{if(t=this.pull(),this.F_CARRY=t&1,this.F_ZERO=t>>1&1?0:1,this.F_INTERRUPT=t>>2&1,this.F_DECIMAL=t>>3&1,this.F_BRK=t>>4&1,this.F_NOTUSED=t>>5&1,this.F_OVERFLOW=t>>6&1,this.F_SIGN=t>>7&1,this.REG_PC=this.pull(),this.REG_PC+=this.pull()<<8,this.REG_PC===65535)return;this.REG_PC--,this.F_NOTUSED=1;break}case 42:{if(this.REG_PC=this.pull(),this.REG_PC+=this.pull()<<8,this.REG_PC===65535)return;break}case 43:{t=this.REG_ACC-this.load(h)-(1-this.F_CARRY),this.F_SIGN=t>>7&1,this.F_ZERO=t&255,(this.REG_ACC^t)&128&&(this.REG_ACC^this.load(h))&128?this.F_OVERFLOW=1:this.F_OVERFLOW=0,this.F_CARRY=t<0?0:1,this.REG_ACC=t&255,n!==11&&(i+=r);break}case 44:{this.F_CARRY=1;break}case 45:{this.F_DECIMAL=1;break}case 46:{this.F_INTERRUPT=1;break}case 47:{this.write(h,this.REG_ACC);break}case 48:{this.write(h,this.REG_X);break}case 49:{this.write(h,this.REG_Y);break}case 50:{this.REG_X=this.REG_ACC,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC;break}case 51:{this.REG_Y=this.REG_ACC,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC;break}case 52:{this.REG_X=this.REG_SP-256,this.F_SIGN=this.REG_SP>>7&1,this.F_ZERO=this.REG_X;break}case 53:{this.REG_ACC=this.REG_X,this.F_SIGN=this.REG_X>>7&1,this.F_ZERO=this.REG_X;break}case 54:{this.REG_SP=this.REG_X+256,this.stackWrap();break}case 55:{this.REG_ACC=this.REG_Y,this.F_SIGN=this.REG_Y>>7&1,this.F_ZERO=this.REG_Y;break}case 56:{t=this.REG_ACC&this.load(h),this.F_CARRY=t&1,this.REG_ACC=this.F_ZERO=t>>1,this.F_SIGN=0;break}case 57:{this.REG_ACC=this.F_ZERO=this.REG_ACC&this.load(h),this.F_CARRY=this.F_SIGN=this.REG_ACC>>7&1;break}case 58:{t=this.REG_ACC&this.load(h),this.REG_ACC=this.F_ZERO=(t>>1)+(this.F_CARRY<<7),this.F_SIGN=this.F_CARRY,this.F_CARRY=t>>7&1,this.F_OVERFLOW=(t>>7^t>>6)&1;break}case 59:{t=(this.REG_X&this.REG_ACC)-this.load(h),this.F_SIGN=t>>7&1,this.F_ZERO=t&255,(this.REG_X^t)&128&&(this.REG_X^this.load(h))&128?this.F_OVERFLOW=1:this.F_OVERFLOW=0,this.F_CARRY=t<0?0:1,this.REG_X=t&255;break}case 60:{this.REG_ACC=this.REG_X=this.F_ZERO=this.load(h),this.F_SIGN=this.REG_ACC>>7&1,i+=r;break}case 61:{this.write(h,this.REG_ACC&this.REG_X);break}case 62:{t=this.load(h)-1&255,this.write(h,t),t=this.REG_ACC-t,this.F_CARRY=t>=0?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255,n!==11&&(i+=r);break}case 63:{t=this.load(h)+1&255,this.write(h,t),t=this.REG_ACC-t-(1-this.F_CARRY),this.F_SIGN=t>>7&1,this.F_ZERO=t&255,(this.REG_ACC^t)&128&&(this.REG_ACC^this.load(h))&128?this.F_OVERFLOW=1:this.F_OVERFLOW=0,this.F_CARRY=t<0?0:1,this.REG_ACC=t&255,n!==11&&(i+=r);break}case 64:{t=this.load(h),e=this.F_CARRY,this.F_CARRY=t>>7&1,t=(t<<1&255)+e,this.write(h,t),this.REG_ACC=this.REG_ACC&t,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,n!==11&&(i+=r);break}case 65:{t=this.load(h),e=this.F_CARRY<<7,this.F_CARRY=t&1,t=(t>>1)+e,this.write(h,t),t=this.REG_ACC+this.load(h)+this.F_CARRY,!((this.REG_ACC^this.load(h))&128)&&(this.REG_ACC^t)&128?this.F_OVERFLOW=1:this.F_OVERFLOW=0,this.F_CARRY=t>255?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255,this.REG_ACC=t&255,n!==11&&(i+=r);break}case 66:{t=this.load(h),this.F_CARRY=t>>7&1,t=t<<1&255,this.write(h,t),this.REG_ACC=this.REG_ACC|t,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,n!==11&&(i+=r);break}case 67:{t=this.load(h)&255,this.F_CARRY=t&1,t>>=1,this.write(h,t),this.REG_ACC=this.REG_ACC^t,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,n!==11&&(i+=r);break}case 68:break;case 69:{this.load(h),n!==11&&(i+=r);break}default:{this.nes.stop(),this.nes.crashMessage="Game crashed, invalid opcode at address $"+o.toString(16);break}}return i},load:function(t){return t<8192?this.mem[t&2047]:this.nes.mmap.load(t)},load16bit:function(t){return t<8191?this.mem[t&2047]|this.mem[t+1&2047]<<8:this.nes.mmap.load(t)|this.nes.mmap.load(t+1)<<8},write:function(t,e){t<8192?this.mem[t&2047]=e:this.nes.mmap.write(t,e)},requestIrq:function(t){this.irqRequested&&t===this.IRQ_NORMAL||(this.irqRequested=!0,this.irqType=t)},push:function(t){this.nes.mmap.write(this.REG_SP,t),this.REG_SP--,this.REG_SP=256|this.REG_SP&255},stackWrap:function(){this.REG_SP=256|this.REG_SP&255},pull:function(){return this.REG_SP++,this.REG_SP=256|this.REG_SP&255,this.nes.mmap.load(this.REG_SP)},pageCrossed:function(t,e){return(t&65280)!==(e&65280)},haltCycles:function(t){this.cyclesToHalt+=t},doNonMaskableInterrupt:function(t){this.nes.mmap.load(8192)&128&&(this.REG_PC_NEW++,this.push(this.REG_PC_NEW>>8&255),this.push(this.REG_PC_NEW&255),this.push(t),this.REG_PC_NEW=this.nes.mmap.load(65530)|this.nes.mmap.load(65531)<<8,this.REG_PC_NEW--)},doResetInterrupt:function(){this.REG_PC_NEW=this.nes.mmap.load(65532)|this.nes.mmap.load(65533)<<8,this.REG_PC_NEW--},doIrq:function(t){this.REG_PC_NEW++,this.push(this.REG_PC_NEW>>8&255),this.push(this.REG_PC_NEW&255),this.push(t),this.F_INTERRUPT_NEW=1,this.F_BRK_NEW=0,this.REG_PC_NEW=this.nes.mmap.load(65534)|this.nes.mmap.load(65535)<<8,this.REG_PC_NEW--},getStatus:function(){return this.F_CARRY|this.F_ZERO<<1|this.F_INTERRUPT<<2|this.F_DECIMAL<<3|this.F_BRK<<4|this.F_NOTUSED<<5|this.F_OVERFLOW<<6|this.F_SIGN<<7},setStatus:function(t){this.F_CARRY=t&1,this.F_ZERO=t>>1&1,this.F_INTERRUPT=t>>2&1,this.F_DECIMAL=t>>3&1,this.F_BRK=t>>4&1,this.F_NOTUSED=t>>5&1,this.F_OVERFLOW=t>>6&1,this.F_SIGN=t>>7&1},JSON_PROPERTIES:["mem","cyclesToHalt","irqRequested","irqType","REG_ACC","REG_X","REG_Y","REG_SP","REG_PC","REG_PC_NEW","REG_STATUS","F_CARRY","F_DECIMAL","F_INTERRUPT","F_INTERRUPT_NEW","F_OVERFLOW","F_SIGN","F_ZERO","F_NOTUSED","F_NOTUSED_NEW","F_BRK","F_BRK_NEW"],toJSON:function(){return sn.toJSON(this)},fromJSON:function(t){sn.fromJSON(this,t)}};var Go=function(){this.opdata=new Array(256);for(var t=0;t<256;t++)this.opdata[t]=255;this.setOp(this.INS_ADC,105,this.ADDR_IMM,2,2),this.setOp(this.INS_ADC,101,this.ADDR_ZP,2,3),this.setOp(this.INS_ADC,117,this.ADDR_ZPX,2,4),this.setOp(this.INS_ADC,109,this.ADDR_ABS,3,4),this.setOp(this.INS_ADC,125,this.ADDR_ABSX,3,4),this.setOp(this.INS_ADC,121,this.ADDR_ABSY,3,4),this.setOp(this.INS_ADC,97,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_ADC,113,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_AND,41,this.ADDR_IMM,2,2),this.setOp(this.INS_AND,37,this.ADDR_ZP,2,3),this.setOp(this.INS_AND,53,this.ADDR_ZPX,2,4),this.setOp(this.INS_AND,45,this.ADDR_ABS,3,4),this.setOp(this.INS_AND,61,this.ADDR_ABSX,3,4),this.setOp(this.INS_AND,57,this.ADDR_ABSY,3,4),this.setOp(this.INS_AND,33,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_AND,49,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_ASL,10,this.ADDR_ACC,1,2),this.setOp(this.INS_ASL,6,this.ADDR_ZP,2,5),this.setOp(this.INS_ASL,22,this.ADDR_ZPX,2,6),this.setOp(this.INS_ASL,14,this.ADDR_ABS,3,6),this.setOp(this.INS_ASL,30,this.ADDR_ABSX,3,7),this.setOp(this.INS_BCC,144,this.ADDR_REL,2,2),this.setOp(this.INS_BCS,176,this.ADDR_REL,2,2),this.setOp(this.INS_BEQ,240,this.ADDR_REL,2,2),this.setOp(this.INS_BIT,36,this.ADDR_ZP,2,3),this.setOp(this.INS_BIT,44,this.ADDR_ABS,3,4),this.setOp(this.INS_BMI,48,this.ADDR_REL,2,2),this.setOp(this.INS_BNE,208,this.ADDR_REL,2,2),this.setOp(this.INS_BPL,16,this.ADDR_REL,2,2),this.setOp(this.INS_BRK,0,this.ADDR_IMP,1,7),this.setOp(this.INS_BVC,80,this.ADDR_REL,2,2),this.setOp(this.INS_BVS,112,this.ADDR_REL,2,2),this.setOp(this.INS_CLC,24,this.ADDR_IMP,1,2),this.setOp(this.INS_CLD,216,this.ADDR_IMP,1,2),this.setOp(this.INS_CLI,88,this.ADDR_IMP,1,2),this.setOp(this.INS_CLV,184,this.ADDR_IMP,1,2),this.setOp(this.INS_CMP,201,this.ADDR_IMM,2,2),this.setOp(this.INS_CMP,197,this.ADDR_ZP,2,3),this.setOp(this.INS_CMP,213,this.ADDR_ZPX,2,4),this.setOp(this.INS_CMP,205,this.ADDR_ABS,3,4),this.setOp(this.INS_CMP,221,this.ADDR_ABSX,3,4),this.setOp(this.INS_CMP,217,this.ADDR_ABSY,3,4),this.setOp(this.INS_CMP,193,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_CMP,209,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_CPX,224,this.ADDR_IMM,2,2),this.setOp(this.INS_CPX,228,this.ADDR_ZP,2,3),this.setOp(this.INS_CPX,236,this.ADDR_ABS,3,4),this.setOp(this.INS_CPY,192,this.ADDR_IMM,2,2),this.setOp(this.INS_CPY,196,this.ADDR_ZP,2,3),this.setOp(this.INS_CPY,204,this.ADDR_ABS,3,4),this.setOp(this.INS_DEC,198,this.ADDR_ZP,2,5),this.setOp(this.INS_DEC,214,this.ADDR_ZPX,2,6),this.setOp(this.INS_DEC,206,this.ADDR_ABS,3,6),this.setOp(this.INS_DEC,222,this.ADDR_ABSX,3,7),this.setOp(this.INS_DEX,202,this.ADDR_IMP,1,2),this.setOp(this.INS_DEY,136,this.ADDR_IMP,1,2),this.setOp(this.INS_EOR,73,this.ADDR_IMM,2,2),this.setOp(this.INS_EOR,69,this.ADDR_ZP,2,3),this.setOp(this.INS_EOR,85,this.ADDR_ZPX,2,4),this.setOp(this.INS_EOR,77,this.ADDR_ABS,3,4),this.setOp(this.INS_EOR,93,this.ADDR_ABSX,3,4),this.setOp(this.INS_EOR,89,this.ADDR_ABSY,3,4),this.setOp(this.INS_EOR,65,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_EOR,81,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_INC,230,this.ADDR_ZP,2,5),this.setOp(this.INS_INC,246,this.ADDR_ZPX,2,6),this.setOp(this.INS_INC,238,this.ADDR_ABS,3,6),this.setOp(this.INS_INC,254,this.ADDR_ABSX,3,7),this.setOp(this.INS_INX,232,this.ADDR_IMP,1,2),this.setOp(this.INS_INY,200,this.ADDR_IMP,1,2),this.setOp(this.INS_JMP,76,this.ADDR_ABS,3,3),this.setOp(this.INS_JMP,108,this.ADDR_INDABS,3,5),this.setOp(this.INS_JSR,32,this.ADDR_ABS,3,6),this.setOp(this.INS_LDA,169,this.ADDR_IMM,2,2),this.setOp(this.INS_LDA,165,this.ADDR_ZP,2,3),this.setOp(this.INS_LDA,181,this.ADDR_ZPX,2,4),this.setOp(this.INS_LDA,173,this.ADDR_ABS,3,4),this.setOp(this.INS_LDA,189,this.ADDR_ABSX,3,4),this.setOp(this.INS_LDA,185,this.ADDR_ABSY,3,4),this.setOp(this.INS_LDA,161,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_LDA,177,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_LDX,162,this.ADDR_IMM,2,2),this.setOp(this.INS_LDX,166,this.ADDR_ZP,2,3),this.setOp(this.INS_LDX,182,this.ADDR_ZPY,2,4),this.setOp(this.INS_LDX,174,this.ADDR_ABS,3,4),this.setOp(this.INS_LDX,190,this.ADDR_ABSY,3,4),this.setOp(this.INS_LDY,160,this.ADDR_IMM,2,2),this.setOp(this.INS_LDY,164,this.ADDR_ZP,2,3),this.setOp(this.INS_LDY,180,this.ADDR_ZPX,2,4),this.setOp(this.INS_LDY,172,this.ADDR_ABS,3,4),this.setOp(this.INS_LDY,188,this.ADDR_ABSX,3,4),this.setOp(this.INS_LSR,74,this.ADDR_ACC,1,2),this.setOp(this.INS_LSR,70,this.ADDR_ZP,2,5),this.setOp(this.INS_LSR,86,this.ADDR_ZPX,2,6),this.setOp(this.INS_LSR,78,this.ADDR_ABS,3,6),this.setOp(this.INS_LSR,94,this.ADDR_ABSX,3,7),this.setOp(this.INS_NOP,26,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,58,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,90,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,122,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,218,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,234,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,250,this.ADDR_IMP,1,2),this.setOp(this.INS_ORA,9,this.ADDR_IMM,2,2),this.setOp(this.INS_ORA,5,this.ADDR_ZP,2,3),this.setOp(this.INS_ORA,21,this.ADDR_ZPX,2,4),this.setOp(this.INS_ORA,13,this.ADDR_ABS,3,4),this.setOp(this.INS_ORA,29,this.ADDR_ABSX,3,4),this.setOp(this.INS_ORA,25,this.ADDR_ABSY,3,4),this.setOp(this.INS_ORA,1,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_ORA,17,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_PHA,72,this.ADDR_IMP,1,3),this.setOp(this.INS_PHP,8,this.ADDR_IMP,1,3),this.setOp(this.INS_PLA,104,this.ADDR_IMP,1,4),this.setOp(this.INS_PLP,40,this.ADDR_IMP,1,4),this.setOp(this.INS_ROL,42,this.ADDR_ACC,1,2),this.setOp(this.INS_ROL,38,this.ADDR_ZP,2,5),this.setOp(this.INS_ROL,54,this.ADDR_ZPX,2,6),this.setOp(this.INS_ROL,46,this.ADDR_ABS,3,6),this.setOp(this.INS_ROL,62,this.ADDR_ABSX,3,7),this.setOp(this.INS_ROR,106,this.ADDR_ACC,1,2),this.setOp(this.INS_ROR,102,this.ADDR_ZP,2,5),this.setOp(this.INS_ROR,118,this.ADDR_ZPX,2,6),this.setOp(this.INS_ROR,110,this.ADDR_ABS,3,6),this.setOp(this.INS_ROR,126,this.ADDR_ABSX,3,7),this.setOp(this.INS_RTI,64,this.ADDR_IMP,1,6),this.setOp(this.INS_RTS,96,this.ADDR_IMP,1,6),this.setOp(this.INS_SBC,233,this.ADDR_IMM,2,2),this.setOp(this.INS_SBC,229,this.ADDR_ZP,2,3),this.setOp(this.INS_SBC,245,this.ADDR_ZPX,2,4),this.setOp(this.INS_SBC,237,this.ADDR_ABS,3,4),this.setOp(this.INS_SBC,253,this.ADDR_ABSX,3,4),this.setOp(this.INS_SBC,249,this.ADDR_ABSY,3,4),this.setOp(this.INS_SBC,225,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_SBC,241,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_SEC,56,this.ADDR_IMP,1,2),this.setOp(this.INS_SED,248,this.ADDR_IMP,1,2),this.setOp(this.INS_SEI,120,this.ADDR_IMP,1,2),this.setOp(this.INS_STA,133,this.ADDR_ZP,2,3),this.setOp(this.INS_STA,149,this.ADDR_ZPX,2,4),this.setOp(this.INS_STA,141,this.ADDR_ABS,3,4),this.setOp(this.INS_STA,157,this.ADDR_ABSX,3,5),this.setOp(this.INS_STA,153,this.ADDR_ABSY,3,5),this.setOp(this.INS_STA,129,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_STA,145,this.ADDR_POSTIDXIND,2,6),this.setOp(this.INS_STX,134,this.ADDR_ZP,2,3),this.setOp(this.INS_STX,150,this.ADDR_ZPY,2,4),this.setOp(this.INS_STX,142,this.ADDR_ABS,3,4),this.setOp(this.INS_STY,132,this.ADDR_ZP,2,3),this.setOp(this.INS_STY,148,this.ADDR_ZPX,2,4),this.setOp(this.INS_STY,140,this.ADDR_ABS,3,4),this.setOp(this.INS_TAX,170,this.ADDR_IMP,1,2),this.setOp(this.INS_TAY,168,this.ADDR_IMP,1,2),this.setOp(this.INS_TSX,186,this.ADDR_IMP,1,2),this.setOp(this.INS_TXA,138,this.ADDR_IMP,1,2),this.setOp(this.INS_TXS,154,this.ADDR_IMP,1,2),this.setOp(this.INS_TYA,152,this.ADDR_IMP,1,2),this.setOp(this.INS_ALR,75,this.ADDR_IMM,2,2),this.setOp(this.INS_ANC,11,this.ADDR_IMM,2,2),this.setOp(this.INS_ANC,43,this.ADDR_IMM,2,2),this.setOp(this.INS_ARR,107,this.ADDR_IMM,2,2),this.setOp(this.INS_AXS,203,this.ADDR_IMM,2,2),this.setOp(this.INS_LAX,163,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_LAX,167,this.ADDR_ZP,2,3),this.setOp(this.INS_LAX,175,this.ADDR_ABS,3,4),this.setOp(this.INS_LAX,179,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_LAX,183,this.ADDR_ZPY,2,4),this.setOp(this.INS_LAX,191,this.ADDR_ABSY,3,4),this.setOp(this.INS_SAX,131,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_SAX,135,this.ADDR_ZP,2,3),this.setOp(this.INS_SAX,143,this.ADDR_ABS,3,4),this.setOp(this.INS_SAX,151,this.ADDR_ZPY,2,4),this.setOp(this.INS_DCP,195,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_DCP,199,this.ADDR_ZP,2,5),this.setOp(this.INS_DCP,207,this.ADDR_ABS,3,6),this.setOp(this.INS_DCP,211,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_DCP,215,this.ADDR_ZPX,2,6),this.setOp(this.INS_DCP,219,this.ADDR_ABSY,3,7),this.setOp(this.INS_DCP,223,this.ADDR_ABSX,3,7),this.setOp(this.INS_ISC,227,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_ISC,231,this.ADDR_ZP,2,5),this.setOp(this.INS_ISC,239,this.ADDR_ABS,3,6),this.setOp(this.INS_ISC,243,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_ISC,247,this.ADDR_ZPX,2,6),this.setOp(this.INS_ISC,251,this.ADDR_ABSY,3,7),this.setOp(this.INS_ISC,255,this.ADDR_ABSX,3,7),this.setOp(this.INS_RLA,35,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_RLA,39,this.ADDR_ZP,2,5),this.setOp(this.INS_RLA,47,this.ADDR_ABS,3,6),this.setOp(this.INS_RLA,51,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_RLA,55,this.ADDR_ZPX,2,6),this.setOp(this.INS_RLA,59,this.ADDR_ABSY,3,7),this.setOp(this.INS_RLA,63,this.ADDR_ABSX,3,7),this.setOp(this.INS_RRA,99,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_RRA,103,this.ADDR_ZP,2,5),this.setOp(this.INS_RRA,111,this.ADDR_ABS,3,6),this.setOp(this.INS_RRA,115,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_RRA,119,this.ADDR_ZPX,2,6),this.setOp(this.INS_RRA,123,this.ADDR_ABSY,3,7),this.setOp(this.INS_RRA,127,this.ADDR_ABSX,3,7),this.setOp(this.INS_SLO,3,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_SLO,7,this.ADDR_ZP,2,5),this.setOp(this.INS_SLO,15,this.ADDR_ABS,3,6),this.setOp(this.INS_SLO,19,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_SLO,23,this.ADDR_ZPX,2,6),this.setOp(this.INS_SLO,27,this.ADDR_ABSY,3,7),this.setOp(this.INS_SLO,31,this.ADDR_ABSX,3,7),this.setOp(this.INS_SRE,67,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_SRE,71,this.ADDR_ZP,2,5),this.setOp(this.INS_SRE,79,this.ADDR_ABS,3,6),this.setOp(this.INS_SRE,83,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_SRE,87,this.ADDR_ZPX,2,6),this.setOp(this.INS_SRE,91,this.ADDR_ABSY,3,7),this.setOp(this.INS_SRE,95,this.ADDR_ABSX,3,7),this.setOp(this.INS_SKB,128,this.ADDR_IMM,2,2),this.setOp(this.INS_SKB,130,this.ADDR_IMM,2,2),this.setOp(this.INS_SKB,137,this.ADDR_IMM,2,2),this.setOp(this.INS_SKB,194,this.ADDR_IMM,2,2),this.setOp(this.INS_SKB,226,this.ADDR_IMM,2,2),this.setOp(this.INS_IGN,12,this.ADDR_ABS,3,4),this.setOp(this.INS_IGN,28,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,60,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,92,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,124,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,220,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,252,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,4,this.ADDR_ZP,2,3),this.setOp(this.INS_IGN,68,this.ADDR_ZP,2,3),this.setOp(this.INS_IGN,100,this.ADDR_ZP,2,3),this.setOp(this.INS_IGN,20,this.ADDR_ZPX,2,4),this.setOp(this.INS_IGN,52,this.ADDR_ZPX,2,4),this.setOp(this.INS_IGN,84,this.ADDR_ZPX,2,4),this.setOp(this.INS_IGN,116,this.ADDR_ZPX,2,4),this.setOp(this.INS_IGN,212,this.ADDR_ZPX,2,4),this.setOp(this.INS_IGN,244,this.ADDR_ZPX,2,4),this.cycTable=new Array(7,6,2,8,3,3,5,5,3,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,6,6,2,8,3,3,5,5,4,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,6,6,2,8,3,3,5,5,3,2,2,2,3,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,6,6,2,8,3,3,5,5,4,2,2,2,5,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,2,6,2,6,3,3,3,3,2,2,2,2,4,4,4,4,2,6,2,6,4,4,4,4,2,5,2,5,5,5,5,5,2,6,2,6,3,3,3,3,2,2,2,2,4,4,4,4,2,5,2,5,4,4,4,4,2,4,2,4,4,4,4,4,2,6,2,8,3,3,5,5,2,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,2,6,3,8,3,3,5,5,2,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7),this.instname=new Array(70),this.instname[0]="ADC",this.instname[1]="AND",this.instname[2]="ASL",this.instname[3]="BCC",this.instname[4]="BCS",this.instname[5]="BEQ",this.instname[6]="BIT",this.instname[7]="BMI",this.instname[8]="BNE",this.instname[9]="BPL",this.instname[10]="BRK",this.instname[11]="BVC",this.instname[12]="BVS",this.instname[13]="CLC",this.instname[14]="CLD",this.instname[15]="CLI",this.instname[16]="CLV",this.instname[17]="CMP",this.instname[18]="CPX",this.instname[19]="CPY",this.instname[20]="DEC",this.instname[21]="DEX",this.instname[22]="DEY",this.instname[23]="EOR",this.instname[24]="INC",this.instname[25]="INX",this.instname[26]="INY",this.instname[27]="JMP",this.instname[28]="JSR",this.instname[29]="LDA",this.instname[30]="LDX",this.instname[31]="LDY",this.instname[32]="LSR",this.instname[33]="NOP",this.instname[34]="ORA",this.instname[35]="PHA",this.instname[36]="PHP",this.instname[37]="PLA",this.instname[38]="PLP",this.instname[39]="ROL",this.instname[40]="ROR",this.instname[41]="RTI",this.instname[42]="RTS",this.instname[43]="SBC",this.instname[44]="SEC",this.instname[45]="SED",this.instname[46]="SEI",this.instname[47]="STA",this.instname[48]="STX",this.instname[49]="STY",this.instname[50]="TAX",this.instname[51]="TAY",this.instname[52]="TSX",this.instname[53]="TXA",this.instname[54]="TXS",this.instname[55]="TYA",this.instname[56]="ALR",this.instname[57]="ANC",this.instname[58]="ARR",this.instname[59]="AXS",this.instname[60]="LAX",this.instname[61]="SAX",this.instname[62]="DCP",this.instname[63]="ISC",this.instname[64]="RLA",this.instname[65]="RRA",this.instname[66]="SLO",this.instname[67]="SRE",this.instname[68]="SKB",this.instname[69]="IGN",this.addrDesc=new Array("Zero Page           ","Relative            ","Implied             ","Absolute            ","Accumulator         ","Immediate           ","Zero Page,X         ","Zero Page,Y         ","Absolute,X          ","Absolute,Y          ","Preindexed Indirect ","Postindexed Indirect","Indirect Absolute   ")};Go.prototype={INS_ADC:0,INS_AND:1,INS_ASL:2,INS_BCC:3,INS_BCS:4,INS_BEQ:5,INS_BIT:6,INS_BMI:7,INS_BNE:8,INS_BPL:9,INS_BRK:10,INS_BVC:11,INS_BVS:12,INS_CLC:13,INS_CLD:14,INS_CLI:15,INS_CLV:16,INS_CMP:17,INS_CPX:18,INS_CPY:19,INS_DEC:20,INS_DEX:21,INS_DEY:22,INS_EOR:23,INS_INC:24,INS_INX:25,INS_INY:26,INS_JMP:27,INS_JSR:28,INS_LDA:29,INS_LDX:30,INS_LDY:31,INS_LSR:32,INS_NOP:33,INS_ORA:34,INS_PHA:35,INS_PHP:36,INS_PLA:37,INS_PLP:38,INS_ROL:39,INS_ROR:40,INS_RTI:41,INS_RTS:42,INS_SBC:43,INS_SEC:44,INS_SED:45,INS_SEI:46,INS_STA:47,INS_STX:48,INS_STY:49,INS_TAX:50,INS_TAY:51,INS_TSX:52,INS_TXA:53,INS_TXS:54,INS_TYA:55,INS_ALR:56,INS_ANC:57,INS_ARR:58,INS_AXS:59,INS_LAX:60,INS_SAX:61,INS_DCP:62,INS_ISC:63,INS_RLA:64,INS_RRA:65,INS_SLO:66,INS_SRE:67,INS_SKB:68,INS_IGN:69,INS_DUMMY:70,ADDR_ZP:0,ADDR_REL:1,ADDR_IMP:2,ADDR_ABS:3,ADDR_ACC:4,ADDR_IMM:5,ADDR_ZPX:6,ADDR_ZPY:7,ADDR_ABSX:8,ADDR_ABSY:9,ADDR_PREIDXIND:10,ADDR_POSTIDXIND:11,ADDR_INDABS:12,setOp:function(t,e,s,i,r){this.opdata[e]=t&255|(s&255)<<8|(i&255)<<16|(r&255)<<24}};var zu=Bo,qo=function(){this.pix=new Array(64),this.fbIndex=null,this.tIndex=null,this.x=null,this.y=null,this.w=null,this.h=null,this.incX=null,this.incY=null,this.palIndex=null,this.tpri=null,this.c=null,this.initialized=!1,this.opaque=new Array(8)};qo.prototype={setBuffer:function(t){for(this.y=0;this.y<8;this.y++)this.setScanline(this.y,t[this.y],t[this.y+8])},setScanline:function(t,e,s){for(this.initialized=!0,this.tIndex=t<<3,this.x=0;this.x<8;this.x++)this.pix[this.tIndex+this.x]=(e>>7-this.x&1)+((s>>7-this.x&1)<<1),this.pix[this.tIndex+this.x]===0&&(this.opaque[t]=!1)},render:function(t,e,s,i,r,n,o,h,a,c,u,p,d){if(!(n<-7||n>=256||o<-7||o>=240))if(this.w=i-e,this.h=r-s,n<0&&(e-=n),n+i>=256&&(i=256-n),o<0&&(s-=o),o+r>=240&&(r=240-o),!c&&!u)for(this.fbIndex=(o<<8)+n,this.tIndex=0,this.y=0;this.y<8;this.y++){for(this.x=0;this.x<8;this.x++)this.x>=e&&this.x<i&&this.y>=s&&this.y<r&&(this.palIndex=this.pix[this.tIndex],this.tpri=d[this.fbIndex],this.palIndex!==0&&p<=(this.tpri&255)&&(t[this.fbIndex]=a[this.palIndex+h],this.tpri=this.tpri&3840|p,d[this.fbIndex]=this.tpri)),this.fbIndex++,this.tIndex++;this.fbIndex-=8,this.fbIndex+=256}else if(c&&!u)for(this.fbIndex=(o<<8)+n,this.tIndex=7,this.y=0;this.y<8;this.y++){for(this.x=0;this.x<8;this.x++)this.x>=e&&this.x<i&&this.y>=s&&this.y<r&&(this.palIndex=this.pix[this.tIndex],this.tpri=d[this.fbIndex],this.palIndex!==0&&p<=(this.tpri&255)&&(t[this.fbIndex]=a[this.palIndex+h],this.tpri=this.tpri&3840|p,d[this.fbIndex]=this.tpri)),this.fbIndex++,this.tIndex--;this.fbIndex-=8,this.fbIndex+=256,this.tIndex+=16}else if(u&&!c)for(this.fbIndex=(o<<8)+n,this.tIndex=56,this.y=0;this.y<8;this.y++){for(this.x=0;this.x<8;this.x++)this.x>=e&&this.x<i&&this.y>=s&&this.y<r&&(this.palIndex=this.pix[this.tIndex],this.tpri=d[this.fbIndex],this.palIndex!==0&&p<=(this.tpri&255)&&(t[this.fbIndex]=a[this.palIndex+h],this.tpri=this.tpri&3840|p,d[this.fbIndex]=this.tpri)),this.fbIndex++,this.tIndex++;this.fbIndex-=8,this.fbIndex+=256,this.tIndex-=16}else for(this.fbIndex=(o<<8)+n,this.tIndex=63,this.y=0;this.y<8;this.y++){for(this.x=0;this.x<8;this.x++)this.x>=e&&this.x<i&&this.y>=s&&this.y<r&&(this.palIndex=this.pix[this.tIndex],this.tpri=d[this.fbIndex],this.palIndex!==0&&p<=(this.tpri&255)&&(t[this.fbIndex]=a[this.palIndex+h],this.tpri=this.tpri&3840|p,d[this.fbIndex]=this.tpri)),this.fbIndex++,this.tIndex--;this.fbIndex-=8,this.fbIndex+=256}},isTransparent:function(t,e){return this.pix[(e<<3)+t]===0},toJSON:function(){return{opaque:this.opaque,pix:this.pix}},fromJSON:function(t){this.opaque=t.opaque,this.pix=t.pix}};var Ho=qo,Ju=Ho,rn=er,Xo=function(t){this.nes=t,this.vramMem=null,this.spriteMem=null,this.vramAddress=null,this.vramTmpAddress=null,this.vramBufferedReadValue=null,this.firstWrite=null,this.sramAddress=null,this.currentMirroring=null,this.requestEndFrame=null,this.nmiOk=null,this.dummyCycleToggle=null,this.validTileData=null,this.nmiCounter=null,this.scanlineAlreadyRendered=null,this.f_nmiOnVblank=null,this.f_spriteSize=null,this.f_bgPatternTable=null,this.f_spPatternTable=null,this.f_addrInc=null,this.f_nTblAddress=null,this.f_color=null,this.f_spVisibility=null,this.f_bgVisibility=null,this.f_spClipping=null,this.f_bgClipping=null,this.f_dispType=null,this.cntFV=null,this.cntV=null,this.cntH=null,this.cntVT=null,this.cntHT=null,this.regFV=null,this.regV=null,this.regH=null,this.regVT=null,this.regHT=null,this.regFH=null,this.regS=null,this.curNt=null,this.attrib=null,this.buffer=null,this.bgbuffer=null,this.pixrendered=null,this.validTileData=null,this.scantile=null,this.scanline=null,this.lastRenderedScanline=null,this.curX=null,this.sprX=null,this.sprY=null,this.sprTile=null,this.sprCol=null,this.vertFlip=null,this.horiFlip=null,this.bgPriority=null,this.spr0HitX=null,this.spr0HitY=null,this.hitSpr0=null,this.sprPalette=null,this.imgPalette=null,this.ptTile=null,this.ntable1=null,this.currentMirroring=null,this.nameTable=null,this.vramMirrorTable=null,this.palTable=null,this.showSpr0Hit=!1,this.clipToTvSize=!0,this.reset()};Xo.prototype={STATUS_VRAMWRITE:4,STATUS_SLSPRITECOUNT:5,STATUS_SPRITE0HIT:6,STATUS_VBLANK:7,reset:function(){var t;for(this.vramMem=new Array(32768),this.spriteMem=new Array(256),t=0;t<this.vramMem.length;t++)this.vramMem[t]=0;for(t=0;t<this.spriteMem.length;t++)this.spriteMem[t]=0;for(this.vramAddress=null,this.vramTmpAddress=null,this.vramBufferedReadValue=0,this.firstWrite=!0,this.sramAddress=0,this.currentMirroring=-1,this.requestEndFrame=!1,this.nmiOk=!1,this.dummyCycleToggle=!1,this.validTileData=!1,this.nmiCounter=0,this.scanlineAlreadyRendered=null,this.f_nmiOnVblank=0,this.f_spriteSize=0,this.f_bgPatternTable=0,this.f_spPatternTable=0,this.f_addrInc=0,this.f_nTblAddress=0,this.f_color=0,this.f_spVisibility=0,this.f_bgVisibility=0,this.f_spClipping=0,this.f_bgClipping=0,this.f_dispType=0,this.cntFV=0,this.cntV=0,this.cntH=0,this.cntVT=0,this.cntHT=0,this.regFV=0,this.regV=0,this.regH=0,this.regVT=0,this.regHT=0,this.regFH=0,this.regS=0,this.curNt=null,this.attrib=new Array(32),this.buffer=new Array(256*240),this.bgbuffer=new Array(256*240),this.pixrendered=new Array(256*240),this.validTileData=null,this.scantile=new Array(32),this.scanline=0,this.lastRenderedScanline=-1,this.curX=0,this.sprX=new Array(64),this.sprY=new Array(64),this.sprTile=new Array(64),this.sprCol=new Array(64),this.vertFlip=new Array(64),this.horiFlip=new Array(64),this.bgPriority=new Array(64),this.spr0HitX=0,this.spr0HitY=0,this.hitSpr0=!1,this.sprPalette=new Array(16),this.imgPalette=new Array(16),this.ptTile=new Array(512),t=0;t<512;t++)this.ptTile[t]=new Ju;for(this.ntable1=new Array(4),this.currentMirroring=-1,this.nameTable=new Array(4),t=0;t<4;t++)this.nameTable[t]=new Yo(32,32,"Nt"+t);for(this.vramMirrorTable=new Array(32768),t=0;t<32768;t++)this.vramMirrorTable[t]=t;this.palTable=new Uo,this.palTable.loadNTSCPalette(),this.updateControlReg1(0),this.updateControlReg2(0)},setMirroring:function(t){if(t!==this.currentMirroring){this.currentMirroring=t,this.triggerRendering(),this.vramMirrorTable===null&&(this.vramMirrorTable=new Array(32768));for(var e=0;e<32768;e++)this.vramMirrorTable[e]=e;this.defineMirrorRegion(16160,16128,32),this.defineMirrorRegion(16192,16128,32),this.defineMirrorRegion(16256,16128,32),this.defineMirrorRegion(16320,16128,32),this.defineMirrorRegion(12288,8192,3840),this.defineMirrorRegion(16384,0,16384),t===this.nes.rom.HORIZONTAL_MIRRORING?(this.ntable1[0]=0,this.ntable1[1]=0,this.ntable1[2]=1,this.ntable1[3]=1,this.defineMirrorRegion(9216,8192,1024),this.defineMirrorRegion(11264,10240,1024)):t===this.nes.rom.VERTICAL_MIRRORING?(this.ntable1[0]=0,this.ntable1[1]=1,this.ntable1[2]=0,this.ntable1[3]=1,this.defineMirrorRegion(10240,8192,1024),this.defineMirrorRegion(11264,9216,1024)):t===this.nes.rom.SINGLESCREEN_MIRRORING?(this.ntable1[0]=0,this.ntable1[1]=0,this.ntable1[2]=0,this.ntable1[3]=0,this.defineMirrorRegion(9216,8192,1024),this.defineMirrorRegion(10240,8192,1024),this.defineMirrorRegion(11264,8192,1024)):t===this.nes.rom.SINGLESCREEN_MIRRORING2?(this.ntable1[0]=1,this.ntable1[1]=1,this.ntable1[2]=1,this.ntable1[3]=1,this.defineMirrorRegion(9216,9216,1024),this.defineMirrorRegion(10240,9216,1024),this.defineMirrorRegion(11264,9216,1024)):(this.ntable1[0]=0,this.ntable1[1]=1,this.ntable1[2]=2,this.ntable1[3]=3)}},defineMirrorRegion:function(t,e,s){for(var i=0;i<s;i++)this.vramMirrorTable[t+i]=e+i},startVBlank:function(){this.nes.cpu.requestIrq(this.nes.cpu.IRQ_NMI),this.lastRenderedScanline<239&&this.renderFramePartially(this.lastRenderedScanline+1,240-this.lastRenderedScanline),this.endFrame(),this.lastRenderedScanline=-1},endScanline:function(){switch(this.scanline){case 19:this.dummyCycleToggle&&(this.curX=1,this.dummyCycleToggle=!this.dummyCycleToggle);break;case 20:this.setStatusFlag(this.STATUS_VBLANK,!1),this.setStatusFlag(this.STATUS_SPRITE0HIT,!1),this.hitSpr0=!1,this.spr0HitX=-1,this.spr0HitY=-1,(this.f_bgVisibility===1||this.f_spVisibility===1)&&(this.cntFV=this.regFV,this.cntV=this.regV,this.cntH=this.regH,this.cntVT=this.regVT,this.cntHT=this.regHT,this.f_bgVisibility===1&&this.renderBgScanline(!1,0)),this.f_bgVisibility===1&&this.f_spVisibility===1&&this.checkSprite0(0),(this.f_bgVisibility===1||this.f_spVisibility===1)&&this.nes.mmap.clockIrqCounter();break;case 261:this.setStatusFlag(this.STATUS_VBLANK,!0),this.requestEndFrame=!0,this.nmiCounter=9,this.scanline=-1;break;default:this.scanline>=21&&this.scanline<=260&&(this.f_bgVisibility===1&&(this.scanlineAlreadyRendered||(this.cntHT=this.regHT,this.cntH=this.regH,this.renderBgScanline(!0,this.scanline+1-21)),this.scanlineAlreadyRendered=!1,!this.hitSpr0&&this.f_spVisibility===1&&this.sprX[0]>=-7&&this.sprX[0]<256&&this.sprY[0]+1<=this.scanline-20&&this.sprY[0]+1+(this.f_spriteSize===0?8:16)>=this.scanline-20&&this.checkSprite0(this.scanline-20)&&(this.hitSpr0=!0)),(this.f_bgVisibility===1||this.f_spVisibility===1)&&this.nes.mmap.clockIrqCounter())}this.scanline++,this.regsToAddress(),this.cntsToAddress()},startFrame:function(){var t=0;if(this.f_dispType===0)t=this.imgPalette[0];else switch(this.f_color){case 0:t=0;break;case 1:t=65280;break;case 2:t=16711680;break;case 3:t=0;break;case 4:t=255;break;default:t=0}var e=this.buffer,s;for(s=0;s<256*240;s++)e[s]=t;var i=this.pixrendered;for(s=0;s<i.length;s++)i[s]=65},endFrame:function(){var t,e,s,i=this.buffer;if(this.showSpr0Hit){if(this.sprX[0]>=0&&this.sprX[0]<256&&this.sprY[0]>=0&&this.sprY[0]<240){for(t=0;t<256;t++)i[(this.sprY[0]<<8)+t]=16733525;for(t=0;t<240;t++)i[(t<<8)+this.sprX[0]]=16733525}if(this.spr0HitX>=0&&this.spr0HitX<256&&this.spr0HitY>=0&&this.spr0HitY<240){for(t=0;t<256;t++)i[(this.spr0HitY<<8)+t]=5635925;for(t=0;t<240;t++)i[(t<<8)+this.spr0HitX]=5635925}}if(this.clipToTvSize||this.f_bgClipping===0||this.f_spClipping===0)for(s=0;s<240;s++)for(e=0;e<8;e++)i[(s<<8)+e]=0;if(this.clipToTvSize)for(s=0;s<240;s++)for(e=0;e<8;e++)i[(s<<8)+255-e]=0;if(this.clipToTvSize)for(s=0;s<8;s++)for(e=0;e<256;e++)i[(s<<8)+e]=0,i[(239-s<<8)+e]=0;this.nes.ui.writeFrame(i)},updateControlReg1:function(t){this.triggerRendering(),this.f_nmiOnVblank=t>>7&1,this.f_spriteSize=t>>5&1,this.f_bgPatternTable=t>>4&1,this.f_spPatternTable=t>>3&1,this.f_addrInc=t>>2&1,this.f_nTblAddress=t&3,this.regV=t>>1&1,this.regH=t&1,this.regS=t>>4&1},updateControlReg2:function(t){this.triggerRendering(),this.f_color=t>>5&7,this.f_spVisibility=t>>4&1,this.f_bgVisibility=t>>3&1,this.f_spClipping=t>>2&1,this.f_bgClipping=t>>1&1,this.f_dispType=t&1,this.f_dispType===0&&this.palTable.setEmphasis(this.f_color),this.updatePalettes()},setStatusFlag:function(t,e){var s=1<<t;this.nes.cpu.mem[8194]=this.nes.cpu.mem[8194]&255-s|(e?s:0)},readStatusRegister:function(){var t=this.nes.cpu.mem[8194];return this.firstWrite=!0,this.setStatusFlag(this.STATUS_VBLANK,!1),t},writeSRAMAddress:function(t){this.sramAddress=t},sramLoad:function(){return this.spriteMem[this.sramAddress]},sramWrite:function(t){this.spriteMem[this.sramAddress]=t,this.spriteRamWriteUpdate(this.sramAddress,t),this.sramAddress++,this.sramAddress%=256},scrollWrite:function(t){this.triggerRendering(),this.firstWrite?(this.regHT=t>>3&31,this.regFH=t&7):(this.regFV=t&7,this.regVT=t>>3&31),this.firstWrite=!this.firstWrite},writeVRAMAddress:function(t){this.firstWrite?(this.regFV=t>>4&3,this.regV=t>>3&1,this.regH=t>>2&1,this.regVT=this.regVT&7|(t&3)<<3):(this.triggerRendering(),this.regVT=this.regVT&24|t>>5&7,this.regHT=t&31,this.cntFV=this.regFV,this.cntV=this.regV,this.cntH=this.regH,this.cntVT=this.regVT,this.cntHT=this.regHT,this.checkSprite0(this.scanline-20)),this.firstWrite=!this.firstWrite,this.cntsToAddress(),this.vramAddress<8192&&this.nes.mmap.latchAccess(this.vramAddress)},vramLoad:function(){var t;return this.cntsToAddress(),this.regsToAddress(),this.vramAddress<=16127?(t=this.vramBufferedReadValue,this.vramAddress<8192?this.vramBufferedReadValue=this.vramMem[this.vramAddress]:this.vramBufferedReadValue=this.mirroredLoad(this.vramAddress),this.vramAddress<8192&&this.nes.mmap.latchAccess(this.vramAddress),this.vramAddress+=this.f_addrInc===1?32:1,this.cntsFromAddress(),this.regsFromAddress(),t):(t=this.mirroredLoad(this.vramAddress),this.vramAddress+=this.f_addrInc===1?32:1,this.cntsFromAddress(),this.regsFromAddress(),t)},vramWrite:function(t){this.triggerRendering(),this.cntsToAddress(),this.regsToAddress(),this.vramAddress>=8192?this.mirroredWrite(this.vramAddress,t):(this.writeMem(this.vramAddress,t),this.nes.mmap.latchAccess(this.vramAddress)),this.vramAddress+=this.f_addrInc===1?32:1,this.regsFromAddress(),this.cntsFromAddress()},sramDMA:function(t){for(var e=t*256,s,i=this.sramAddress;i<256;i++)s=this.nes.cpu.mem[e+i],this.spriteMem[i]=s,this.spriteRamWriteUpdate(i,s);this.nes.cpu.haltCycles(513)},regsFromAddress:function(){var t=this.vramTmpAddress>>8&255;this.regFV=t>>4&7,this.regV=t>>3&1,this.regH=t>>2&1,this.regVT=this.regVT&7|(t&3)<<3,t=this.vramTmpAddress&255,this.regVT=this.regVT&24|t>>5&7,this.regHT=t&31},cntsFromAddress:function(){var t=this.vramAddress>>8&255;this.cntFV=t>>4&3,this.cntV=t>>3&1,this.cntH=t>>2&1,this.cntVT=this.cntVT&7|(t&3)<<3,t=this.vramAddress&255,this.cntVT=this.cntVT&24|t>>5&7,this.cntHT=t&31},regsToAddress:function(){var t=(this.regFV&7)<<4;t|=(this.regV&1)<<3,t|=(this.regH&1)<<2,t|=this.regVT>>3&3;var e=(this.regVT&7)<<5;e|=this.regHT&31,this.vramTmpAddress=(t<<8|e)&32767},cntsToAddress:function(){var t=(this.cntFV&7)<<4;t|=(this.cntV&1)<<3,t|=(this.cntH&1)<<2,t|=this.cntVT>>3&3;var e=(this.cntVT&7)<<5;e|=this.cntHT&31,this.vramAddress=(t<<8|e)&32767},incTileCounter:function(t){for(var e=t;e!==0;e--)this.cntHT++,this.cntHT===32&&(this.cntHT=0,this.cntVT++,this.cntVT>=30&&(this.cntH++,this.cntH===2&&(this.cntH=0,this.cntV++,this.cntV===2&&(this.cntV=0,this.cntFV++,this.cntFV&=7))))},mirroredLoad:function(t){return this.vramMem[this.vramMirrorTable[t]]},mirroredWrite:function(t,e){if(t>=16128&&t<16160)t===16128||t===16144?(this.writeMem(16128,e),this.writeMem(16144,e)):t===16132||t===16148?(this.writeMem(16132,e),this.writeMem(16148,e)):t===16136||t===16152?(this.writeMem(16136,e),this.writeMem(16152,e)):t===16140||t===16156?(this.writeMem(16140,e),this.writeMem(16156,e)):this.writeMem(t,e);else if(t<this.vramMirrorTable.length)this.writeMem(this.vramMirrorTable[t],e);else throw new Error("Invalid VRAM address: "+t.toString(16))},triggerRendering:function(){this.scanline>=21&&this.scanline<=260&&(this.renderFramePartially(this.lastRenderedScanline+1,this.scanline-21-this.lastRenderedScanline),this.lastRenderedScanline=this.scanline-21)},renderFramePartially:function(t,e){if(this.f_spVisibility===1&&this.renderSpritesPartially(t,e,!0),this.f_bgVisibility===1){var s=t<<8,i=t+e<<8;i>61440&&(i=61440);for(var r=this.buffer,n=this.bgbuffer,o=this.pixrendered,h=s;h<i;h++)o[h]>255&&(r[h]=n[h])}this.f_spVisibility===1&&this.renderSpritesPartially(t,e,!1),this.validTileData=!1},renderBgScanline:function(t,e){var s=this.regS===0?0:256,i=(e<<8)-this.regFH;if(this.curNt=this.ntable1[this.cntV+this.cntV+this.cntH],this.cntHT=this.regHT,this.cntH=this.regH,this.curNt=this.ntable1[this.cntV+this.cntV+this.cntH],e<240&&e-this.cntFV>=0){for(var r=this.cntFV<<3,n=this.scantile,o=this.attrib,h=this.ptTile,a=this.nameTable,c=this.imgPalette,u=this.pixrendered,p=t?this.bgbuffer:this.buffer,d,A,v,w,k=0;k<32;k++){if(e>=0){if(this.validTileData){if(d=n[k],typeof d>"u")continue;A=d.pix,v=o[k]}else{if(d=h[s+a[this.curNt].getTileIndex(this.cntHT,this.cntVT)],typeof d>"u")continue;A=d.pix,v=a[this.curNt].getAttrib(this.cntHT,this.cntVT),n[k]=d,o[k]=v}var M=0,F=(k<<3)-this.regFH;if(F>-8)if(F<0&&(i-=F,M=-F),d.opaque[this.cntFV])for(;M<8;M++)p[i]=c[A[r+M]+v],u[i]|=256,i++;else for(;M<8;M++)w=A[r+M],w!==0&&(p[i]=c[w+v],u[i]|=256),i++}++this.cntHT===32&&(this.cntHT=0,this.cntH++,this.cntH%=2,this.curNt=this.ntable1[(this.cntV<<1)+this.cntH])}this.validTileData=!0}this.cntFV++,this.cntFV===8&&(this.cntFV=0,this.cntVT++,this.cntVT===30?(this.cntVT=0,this.cntV++,this.cntV%=2,this.curNt=this.ntable1[(this.cntV<<1)+this.cntH]):this.cntVT===32&&(this.cntVT=0),this.validTileData=!1)},renderSpritesPartially:function(t,e,s){if(this.f_spVisibility===1){for(var i=0;i<64;i++)if(this.bgPriority[i]===s&&this.sprX[i]>=0&&this.sprX[i]<256&&this.sprY[i]+8>=t&&this.sprY[i]<t+e)if(this.f_spriteSize===0)this.srcy1=0,this.srcy2=8,this.sprY[i]<t&&(this.srcy1=t-this.sprY[i]-1),this.sprY[i]+8>t+e&&(this.srcy2=t+e-this.sprY[i]+1),this.f_spPatternTable===0?this.ptTile[this.sprTile[i]].render(this.buffer,0,this.srcy1,8,this.srcy2,this.sprX[i],this.sprY[i]+1,this.sprCol[i],this.sprPalette,this.horiFlip[i],this.vertFlip[i],i,this.pixrendered):this.ptTile[this.sprTile[i]+256].render(this.buffer,0,this.srcy1,8,this.srcy2,this.sprX[i],this.sprY[i]+1,this.sprCol[i],this.sprPalette,this.horiFlip[i],this.vertFlip[i],i,this.pixrendered);else{var r=this.sprTile[i];r&1&&(r=this.sprTile[i]-1+256);var n=0,o=8;this.sprY[i]<t&&(n=t-this.sprY[i]-1),this.sprY[i]+8>t+e&&(o=t+e-this.sprY[i]),this.ptTile[r+(this.vertFlip[i]?1:0)].render(this.buffer,0,n,8,o,this.sprX[i],this.sprY[i]+1,this.sprCol[i],this.sprPalette,this.horiFlip[i],this.vertFlip[i],i,this.pixrendered),n=0,o=8,this.sprY[i]+8<t&&(n=t-(this.sprY[i]+8+1)),this.sprY[i]+16>t+e&&(o=t+e-(this.sprY[i]+8)),this.ptTile[r+(this.vertFlip[i]?0:1)].render(this.buffer,0,n,8,o,this.sprX[i],this.sprY[i]+1+8,this.sprCol[i],this.sprPalette,this.horiFlip[i],this.vertFlip[i],i,this.pixrendered)}}},checkSprite0:function(t){this.spr0HitX=-1,this.spr0HitY=-1;var e,s=this.f_spPatternTable===0?0:256,i,r,n,o,h;if(i=this.sprX[0],r=this.sprY[0]+1,this.f_spriteSize===0){if(r<=t&&r+8>t&&i>=-7&&i<256)if(n=this.ptTile[this.sprTile[0]+s],this.vertFlip[0]?e=7-(t-r):e=t-r,e*=8,h=t*256+i,this.horiFlip[0])for(o=7;o>=0;o--){if(i>=0&&i<256&&h>=0&&h<61440&&this.pixrendered[h]!==0&&n.pix[e+o]!==0)return this.spr0HitX=h%256,this.spr0HitY=t,!0;i++,h++}else for(o=0;o<8;o++){if(i>=0&&i<256&&h>=0&&h<61440&&this.pixrendered[h]!==0&&n.pix[e+o]!==0)return this.spr0HitX=h%256,this.spr0HitY=t,!0;i++,h++}}else if(r<=t&&r+16>t&&i>=-7&&i<256)if(this.vertFlip[0]?e=15-(t-r):e=t-r,e<8?n=this.ptTile[this.sprTile[0]+(this.vertFlip[0]?1:0)+(this.sprTile[0]&1?255:0)]:(n=this.ptTile[this.sprTile[0]+(this.vertFlip[0]?0:1)+(this.sprTile[0]&1?255:0)],this.vertFlip[0]?e=15-e:e-=8),e*=8,h=t*256+i,this.horiFlip[0])for(o=7;o>=0;o--){if(i>=0&&i<256&&h>=0&&h<61440&&this.pixrendered[h]!==0&&n.pix[e+o]!==0)return this.spr0HitX=h%256,this.spr0HitY=t,!0;i++,h++}else for(o=0;o<8;o++){if(i>=0&&i<256&&h>=0&&h<61440&&this.pixrendered[h]!==0&&n.pix[e+o]!==0)return this.spr0HitX=h%256,this.spr0HitY=t,!0;i++,h++}return!1},writeMem:function(t,e){this.vramMem[t]=e,t<8192?(this.vramMem[t]=e,this.patternWrite(t,e)):t>=8192&&t<9152?this.nameTableWrite(this.ntable1[0],t-8192,e):t>=9152&&t<9216?this.attribTableWrite(this.ntable1[0],t-9152,e):t>=9216&&t<10176?this.nameTableWrite(this.ntable1[1],t-9216,e):t>=10176&&t<10240?this.attribTableWrite(this.ntable1[1],t-10176,e):t>=10240&&t<11200?this.nameTableWrite(this.ntable1[2],t-10240,e):t>=11200&&t<11264?this.attribTableWrite(this.ntable1[2],t-11200,e):t>=11264&&t<12224?this.nameTableWrite(this.ntable1[3],t-11264,e):t>=12224&&t<12288?this.attribTableWrite(this.ntable1[3],t-12224,e):t>=16128&&t<16160&&this.updatePalettes()},updatePalettes:function(){var t;for(t=0;t<16;t++)this.f_dispType===0?this.imgPalette[t]=this.palTable.getEntry(this.vramMem[16128+t]&63):this.imgPalette[t]=this.palTable.getEntry(this.vramMem[16128+t]&32);for(t=0;t<16;t++)this.f_dispType===0?this.sprPalette[t]=this.palTable.getEntry(this.vramMem[16144+t]&63):this.sprPalette[t]=this.palTable.getEntry(this.vramMem[16144+t]&32)},patternWrite:function(t,e){var s=Math.floor(t/16),i=t%16;i<8?this.ptTile[s].setScanline(i,e,this.vramMem[t+8]):this.ptTile[s].setScanline(i-8,this.vramMem[t-8],e)},nameTableWrite:function(t,e,s){this.nameTable[t].tile[e]=s,this.checkSprite0(this.scanline-20)},attribTableWrite:function(t,e,s){this.nameTable[t].writeAttrib(e,s)},spriteRamWriteUpdate:function(t,e){var s=Math.floor(t/4);s===0&&this.checkSprite0(this.scanline-20),t%4===0?this.sprY[s]=e:t%4===1?this.sprTile[s]=e:t%4===2?(this.vertFlip[s]=(e&128)!==0,this.horiFlip[s]=(e&64)!==0,this.bgPriority[s]=(e&32)!==0,this.sprCol[s]=(e&3)<<2):t%4===3&&(this.sprX[s]=e)},doNMI:function(){this.setStatusFlag(this.STATUS_VBLANK,!0),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_NMI)},isPixelWhite:function(t,e){return this.triggerRendering(),this.nes.ppu.buffer[(e<<8)+t]===16777215},JSON_PROPERTIES:["vramMem","spriteMem","cntFV","cntV","cntH","cntVT","cntHT","regFV","regV","regH","regVT","regHT","regFH","regS","vramAddress","vramTmpAddress","f_nmiOnVblank","f_spriteSize","f_bgPatternTable","f_spPatternTable","f_addrInc","f_nTblAddress","f_color","f_spVisibility","f_bgVisibility","f_spClipping","f_bgClipping","f_dispType","vramBufferedReadValue","firstWrite","currentMirroring","vramMirrorTable","ntable1","sramAddress","hitSpr0","sprPalette","imgPalette","curX","scanline","lastRenderedScanline","curNt","scantile","attrib","buffer","bgbuffer","pixrendered","requestEndFrame","nmiOk","dummyCycleToggle","nmiCounter","validTileData","scanlineAlreadyRendered"],toJSON:function(){var t,e=rn.toJSON(this);for(e.nameTable=[],t=0;t<this.nameTable.length;t++)e.nameTable[t]=this.nameTable[t].toJSON();for(e.ptTile=[],t=0;t<this.ptTile.length;t++)e.ptTile[t]=this.ptTile[t].toJSON();return e},fromJSON:function(t){var e;for(rn.fromJSON(this,t),e=0;e<this.nameTable.length;e++)this.nameTable[e].fromJSON(t.nameTable[e]);for(e=0;e<this.ptTile.length;e++)this.ptTile[e].fromJSON(t.ptTile[e]);for(e=0;e<this.spriteMem.length;e++)this.spriteRamWriteUpdate(e,this.spriteMem[e])}};var Yo=function(t,e,s){this.width=t,this.height=e,this.name=s,this.tile=new Array(t*e),this.attrib=new Array(t*e);for(var i=0;i<t*e;i++)this.tile[i]=0,this.attrib[i]=0};Yo.prototype={getTileIndex:function(t,e){return this.tile[e*this.width+t]},getAttrib:function(t,e){return this.attrib[e*this.width+t]},writeAttrib:function(t,e){for(var s=t%8*4,i=Math.floor(t/8)*4,r,n,o,h,a=0;a<2;a++)for(var c=0;c<2;c++){r=e>>2*(a*2+c)&3;for(var u=0;u<2;u++)for(var p=0;p<2;p++)n=s+c*2+p,o=i+a*2+u,h=o*this.width+n,this.attrib[h]=r<<2&12}},toJSON:function(){return{tile:this.tile,attrib:this.attrib}},fromJSON:function(t){this.tile=t.tile,this.attrib=t.attrib}};var Uo=function(){this.curTable=new Array(64),this.emphTable=new Array(8),this.currentEmph=-1};Uo.prototype={reset:function(){this.setEmphasis(0)},loadNTSCPalette:function(){this.curTable=[5395026,11796480,10485760,11599933,7602281,91,95,6208,12048,543240,26368,1196544,7153664,0,0,0,12899815,16728064,14421538,16729963,14090399,6818519,6588,21681,27227,35843,43776,2918400,10777088,0,0,0,16316664,16755516,16742785,16735173,16730354,14633471,4681215,46327,57599,58229,259115,7911470,15065624,7895160,0,0,16777215,16773822,16300216,16300248,16758527,16761855,13095423,10148607,8973816,8650717,12122296,16119980,16777136,16308472,0,0],this.makeTables(),this.setEmphasis(0)},loadPALPalette:function(){this.curTable=[5395026,11796480,10485760,11599933,7602281,91,95,6208,12048,543240,26368,1196544,7153664,0,0,0,12899815,16728064,14421538,16729963,14090399,6818519,6588,21681,27227,35843,43776,2918400,10777088,0,0,0,16316664,16755516,16742785,16735173,16730354,14633471,4681215,46327,57599,58229,259115,7911470,15065624,7895160,0,0,16777215,16773822,16300216,16300248,16758527,16761855,13095423,10148607,8973816,8650717,12122296,16119980,16777136,16308472,0,0],this.makeTables(),this.setEmphasis(0)},makeTables:function(){for(var t,e,s,i,r,n,o,h,a=0;a<8;a++)for(n=1,o=1,h=1,a&1&&(n=.75,h=.75),a&2&&(n=.75,o=.75),a&4&&(o=.75,h=.75),this.emphTable[a]=new Array(64),r=0;r<64;r++)i=this.curTable[r],t=Math.floor(this.getRed(i)*n),e=Math.floor(this.getGreen(i)*o),s=Math.floor(this.getBlue(i)*h),this.emphTable[a][r]=this.getRgb(t,e,s)},setEmphasis:function(t){if(t!==this.currentEmph){this.currentEmph=t;for(var e=0;e<64;e++)this.curTable[e]=this.emphTable[t][e]}},getEntry:function(t){return this.curTable[t]},getRed:function(t){return t>>16&255},getGreen:function(t){return t>>8&255},getBlue:function(t){return t&255},getRgb:function(t,e,s){return t<<16|e<<8|s},loadDefaultPalette:function(){this.curTable[0]=this.getRgb(117,117,117),this.curTable[1]=this.getRgb(39,27,143),this.curTable[2]=this.getRgb(0,0,171),this.curTable[3]=this.getRgb(71,0,159),this.curTable[4]=this.getRgb(143,0,119),this.curTable[5]=this.getRgb(171,0,19),this.curTable[6]=this.getRgb(167,0,0),this.curTable[7]=this.getRgb(127,11,0),this.curTable[8]=this.getRgb(67,47,0),this.curTable[9]=this.getRgb(0,71,0),this.curTable[10]=this.getRgb(0,81,0),this.curTable[11]=this.getRgb(0,63,23),this.curTable[12]=this.getRgb(27,63,95),this.curTable[13]=this.getRgb(0,0,0),this.curTable[14]=this.getRgb(0,0,0),this.curTable[15]=this.getRgb(0,0,0),this.curTable[16]=this.getRgb(188,188,188),this.curTable[17]=this.getRgb(0,115,239),this.curTable[18]=this.getRgb(35,59,239),this.curTable[19]=this.getRgb(131,0,243),this.curTable[20]=this.getRgb(191,0,191),this.curTable[21]=this.getRgb(231,0,91),this.curTable[22]=this.getRgb(219,43,0),this.curTable[23]=this.getRgb(203,79,15),this.curTable[24]=this.getRgb(139,115,0),this.curTable[25]=this.getRgb(0,151,0),this.curTable[26]=this.getRgb(0,171,0),this.curTable[27]=this.getRgb(0,147,59),this.curTable[28]=this.getRgb(0,131,139),this.curTable[29]=this.getRgb(0,0,0),this.curTable[30]=this.getRgb(0,0,0),this.curTable[31]=this.getRgb(0,0,0),this.curTable[32]=this.getRgb(255,255,255),this.curTable[33]=this.getRgb(63,191,255),this.curTable[34]=this.getRgb(95,151,255),this.curTable[35]=this.getRgb(167,139,253),this.curTable[36]=this.getRgb(247,123,255),this.curTable[37]=this.getRgb(255,119,183),this.curTable[38]=this.getRgb(255,119,99),this.curTable[39]=this.getRgb(255,155,59),this.curTable[40]=this.getRgb(243,191,63),this.curTable[41]=this.getRgb(131,211,19),this.curTable[42]=this.getRgb(79,223,75),this.curTable[43]=this.getRgb(88,248,152),this.curTable[44]=this.getRgb(0,235,219),this.curTable[45]=this.getRgb(0,0,0),this.curTable[46]=this.getRgb(0,0,0),this.curTable[47]=this.getRgb(0,0,0),this.curTable[48]=this.getRgb(255,255,255),this.curTable[49]=this.getRgb(171,231,255),this.curTable[50]=this.getRgb(199,215,255),this.curTable[51]=this.getRgb(215,203,255),this.curTable[52]=this.getRgb(255,199,255),this.curTable[53]=this.getRgb(255,199,219),this.curTable[54]=this.getRgb(255,191,179),this.curTable[55]=this.getRgb(255,219,171),this.curTable[56]=this.getRgb(255,231,163),this.curTable[57]=this.getRgb(227,255,163),this.curTable[58]=this.getRgb(171,243,191),this.curTable[59]=this.getRgb(179,255,207),this.curTable[60]=this.getRgb(159,255,243),this.curTable[61]=this.getRgb(0,0,0),this.curTable[62]=this.getRgb(0,0,0),this.curTable[63]=this.getRgb(0,0,0),this.makeTables(),this.setEmphasis(0)}};var Qu=Xo,tc=17897725e-1,Wo=function(t){this.nes=t,this.square1=new Ti(this,!0),this.square2=new Ti(this,!1),this.triangle=new Ko(this),this.noise=new jo(this),this.dmc=new Zo(this),this.frameIrqCounter=null,this.frameIrqCounterMax=4,this.initCounter=2048,this.channelEnableValue=null,this.sampleRate=44100,this.lengthLookup=null,this.dmcFreqLookup=null,this.noiseWavelengthLookup=null,this.square_table=null,this.tnd_table=null,this.frameIrqEnabled=!1,this.frameIrqActive=null,this.frameClockNow=null,this.startedPlaying=!1,this.recordOutput=!1,this.initingHardware=!1,this.masterFrameCounter=null,this.derivedFrameCounter=null,this.countSequence=null,this.sampleTimer=null,this.frameTime=null,this.sampleTimerMax=null,this.sampleCount=null,this.triValue=0,this.smpSquare1=null,this.smpSquare2=null,this.smpTriangle=null,this.smpDmc=null,this.accCount=null,this.prevSampleL=0,this.prevSampleR=0,this.smpAccumL=0,this.smpAccumR=0,this.dacRange=0,this.dcValue=0,this.masterVolume=256,this.stereoPosLSquare1=null,this.stereoPosLSquare2=null,this.stereoPosLTriangle=null,this.stereoPosLNoise=null,this.stereoPosLDMC=null,this.stereoPosRSquare1=null,this.stereoPosRSquare2=null,this.stereoPosRTriangle=null,this.stereoPosRNoise=null,this.stereoPosRDMC=null,this.extraCycles=null,this.maxSample=null,this.minSample=null,this.panning=[80,170,100,150,128],this.setPanning(this.panning),this.initLengthLookup(),this.initDmcFrequencyLookup(),this.initNoiseWavelengthLookup(),this.initDACtables();for(var e=0;e<20;e++)e===16?this.writeReg(16400,16):this.writeReg(16384+e,0);this.reset()};Wo.prototype={reset:function(){this.sampleRate=this.nes.opts.sampleRate,this.sampleTimerMax=Math.floor(1024*tc*this.nes.opts.preferredFrameRate/(this.sampleRate*60)),this.frameTime=Math.floor(14915*this.nes.opts.preferredFrameRate/60),this.sampleTimer=0,this.updateChannelEnable(0),this.masterFrameCounter=0,this.derivedFrameCounter=0,this.countSequence=0,this.sampleCount=0,this.initCounter=2048,this.frameIrqEnabled=!1,this.initingHardware=!1,this.resetCounter(),this.square1.reset(),this.square2.reset(),this.triangle.reset(),this.noise.reset(),this.dmc.reset(),this.accCount=0,this.smpSquare1=0,this.smpSquare2=0,this.smpTriangle=0,this.smpDmc=0,this.frameIrqEnabled=!1,this.frameIrqCounterMax=4,this.channelEnableValue=255,this.startedPlaying=!1,this.prevSampleL=0,this.prevSampleR=0,this.smpAccumL=0,this.smpAccumR=0,this.maxSample=-5e5,this.minSample=5e5},readReg:function(t){var e=0;return e|=this.square1.getLengthStatus(),e|=this.square2.getLengthStatus()<<1,e|=this.triangle.getLengthStatus()<<2,e|=this.noise.getLengthStatus()<<3,e|=this.dmc.getLengthStatus()<<4,e|=(this.frameIrqActive&&this.frameIrqEnabled?1:0)<<6,e|=this.dmc.getIrqStatus()<<7,this.frameIrqActive=!1,this.dmc.irqGenerated=!1,e&65535},writeReg:function(t,e){t>=16384&&t<16388?this.square1.writeReg(t,e):t>=16388&&t<16392?this.square2.writeReg(t,e):t>=16392&&t<16396?this.triangle.writeReg(t,e):t>=16396&&t<=16399?this.noise.writeReg(t,e):t===16400?this.dmc.writeReg(t,e):t===16401?this.dmc.writeReg(t,e):t===16402?this.dmc.writeReg(t,e):t===16403?this.dmc.writeReg(t,e):t===16405?(this.updateChannelEnable(e),e!==0&&this.initCounter>0&&(this.initingHardware=!0),this.dmc.writeReg(t,e)):t===16407&&(this.countSequence=e>>7&1,this.masterFrameCounter=0,this.frameIrqActive=!1,e>>6&1?this.frameIrqEnabled=!1:this.frameIrqEnabled=!0,this.countSequence===0?(this.frameIrqCounterMax=4,this.derivedFrameCounter=4):(this.frameIrqCounterMax=5,this.derivedFrameCounter=0,this.frameCounterTick()))},resetCounter:function(){this.countSequence===0?this.derivedFrameCounter=4:this.derivedFrameCounter=0},updateChannelEnable:function(t){this.channelEnableValue=t&65535,this.square1.setEnabled((t&1)!==0),this.square2.setEnabled((t&2)!==0),this.triangle.setEnabled((t&4)!==0),this.noise.setEnabled((t&8)!==0),this.dmc.setEnabled((t&16)!==0)},clockFrameCounter:function(t){if(this.initCounter>0&&this.initingHardware){this.initCounter-=t,this.initCounter<=0&&(this.initingHardware=!1);return}t+=this.extraCycles;var e=this.sampleTimerMax-this.sampleTimer;t<<10>e?(this.extraCycles=(t<<10)-e>>10,t-=this.extraCycles):this.extraCycles=0;var s=this.dmc,i=this.triangle,r=this.square1,n=this.square2,o=this.noise;if(s.isEnabled)for(s.shiftCounter-=t<<3;s.shiftCounter<=0&&s.dmaFrequency>0;)s.shiftCounter+=s.dmaFrequency,s.clockDmc();if(i.progTimerMax>0)for(i.progTimerCount-=t;i.progTimerCount<=0;)i.progTimerCount+=i.progTimerMax+1,i.linearCounter>0&&i.lengthCounter>0&&(i.triangleCounter++,i.triangleCounter&=31,i.isEnabled&&(i.triangleCounter>=16?i.sampleValue=i.triangleCounter&15:i.sampleValue=15-(i.triangleCounter&15),i.sampleValue<<=4));r.progTimerCount-=t,r.progTimerCount<=0&&(r.progTimerCount+=r.progTimerMax+1<<1,r.squareCounter++,r.squareCounter&=7,r.updateSampleValue()),n.progTimerCount-=t,n.progTimerCount<=0&&(n.progTimerCount+=n.progTimerMax+1<<1,n.squareCounter++,n.squareCounter&=7,n.updateSampleValue());var h=t;if(o.progTimerCount-h>0)o.progTimerCount-=h,o.accCount+=h,o.accValue+=h*o.sampleValue;else for(;h-- >0;)--o.progTimerCount<=0&&o.progTimerMax>0&&(o.shiftReg<<=1,o.tmp=(o.shiftReg<<(o.randomMode===0?1:6)^o.shiftReg)&32768,o.tmp!==0?(o.shiftReg|=1,o.randomBit=0,o.sampleValue=0):(o.randomBit=1,o.isEnabled&&o.lengthCounter>0?o.sampleValue=o.masterVolume:o.sampleValue=0),o.progTimerCount+=o.progTimerMax),o.accValue+=o.sampleValue,o.accCount++;this.frameIrqEnabled&&this.frameIrqActive&&this.nes.cpu.requestIrq(this.nes.cpu.IRQ_NORMAL),this.masterFrameCounter+=t<<1,this.masterFrameCounter>=this.frameTime&&(this.masterFrameCounter-=this.frameTime,this.frameCounterTick()),this.accSample(t),this.sampleTimer+=t<<10,this.sampleTimer>=this.sampleTimerMax&&(this.sample(),this.sampleTimer-=this.sampleTimerMax)},accSample:function(t){this.triangle.sampleCondition&&(this.triValue=Math.floor((this.triangle.progTimerCount<<4)/(this.triangle.progTimerMax+1)),this.triValue>16&&(this.triValue=16),this.triangle.triangleCounter>=16&&(this.triValue=16-this.triValue),this.triValue+=this.triangle.sampleValue),t===2?(this.smpTriangle+=this.triValue<<1,this.smpDmc+=this.dmc.sample<<1,this.smpSquare1+=this.square1.sampleValue<<1,this.smpSquare2+=this.square2.sampleValue<<1,this.accCount+=2):t===4?(this.smpTriangle+=this.triValue<<2,this.smpDmc+=this.dmc.sample<<2,this.smpSquare1+=this.square1.sampleValue<<2,this.smpSquare2+=this.square2.sampleValue<<2,this.accCount+=4):(this.smpTriangle+=t*this.triValue,this.smpDmc+=t*this.dmc.sample,this.smpSquare1+=t*this.square1.sampleValue,this.smpSquare2+=t*this.square2.sampleValue,this.accCount+=t)},frameCounterTick:function(){this.derivedFrameCounter++,this.derivedFrameCounter>=this.frameIrqCounterMax&&(this.derivedFrameCounter=0),(this.derivedFrameCounter===1||this.derivedFrameCounter===3)&&(this.triangle.clockLengthCounter(),this.square1.clockLengthCounter(),this.square2.clockLengthCounter(),this.noise.clockLengthCounter(),this.square1.clockSweep(),this.square2.clockSweep()),this.derivedFrameCounter>=0&&this.derivedFrameCounter<4&&(this.square1.clockEnvDecay(),this.square2.clockEnvDecay(),this.noise.clockEnvDecay(),this.triangle.clockLinearCounter()),this.derivedFrameCounter===3&&this.countSequence===0&&(this.frameIrqActive=!0)},sample:function(){var t,e;this.accCount>0?(this.smpSquare1<<=4,this.smpSquare1=Math.floor(this.smpSquare1/this.accCount),this.smpSquare2<<=4,this.smpSquare2=Math.floor(this.smpSquare2/this.accCount),this.smpTriangle=Math.floor(this.smpTriangle/this.accCount),this.smpDmc<<=4,this.smpDmc=Math.floor(this.smpDmc/this.accCount),this.accCount=0):(this.smpSquare1=this.square1.sampleValue<<4,this.smpSquare2=this.square2.sampleValue<<4,this.smpTriangle=this.triangle.sampleValue,this.smpDmc=this.dmc.sample<<4);var s=Math.floor((this.noise.accValue<<4)/this.noise.accCount);this.noise.accValue=s>>4,this.noise.accCount=1,t=this.smpSquare1*this.stereoPosLSquare1+this.smpSquare2*this.stereoPosLSquare2>>8,e=3*this.smpTriangle*this.stereoPosLTriangle+(s<<1)*this.stereoPosLNoise+this.smpDmc*this.stereoPosLDMC>>8,t>=this.square_table.length&&(t=this.square_table.length-1),e>=this.tnd_table.length&&(e=this.tnd_table.length-1);var i=this.square_table[t]+this.tnd_table[e]-this.dcValue;t=this.smpSquare1*this.stereoPosRSquare1+this.smpSquare2*this.stereoPosRSquare2>>8,e=3*this.smpTriangle*this.stereoPosRTriangle+(s<<1)*this.stereoPosRNoise+this.smpDmc*this.stereoPosRDMC>>8,t>=this.square_table.length&&(t=this.square_table.length-1),e>=this.tnd_table.length&&(e=this.tnd_table.length-1);var r=this.square_table[t]+this.tnd_table[e]-this.dcValue,n=i-this.prevSampleL;this.prevSampleL+=n,this.smpAccumL+=n-(this.smpAccumL>>10),i=this.smpAccumL;var o=r-this.prevSampleR;this.prevSampleR+=o,this.smpAccumR+=o-(this.smpAccumR>>10),r=this.smpAccumR,i>this.maxSample&&(this.maxSample=i),i<this.minSample&&(this.minSample=i),this.nes.opts.onAudioSample&&this.nes.opts.onAudioSample(i/32768,r/32768),this.smpSquare1=0,this.smpSquare2=0,this.smpTriangle=0,this.smpDmc=0},getLengthMax:function(t){return this.lengthLookup[t>>3]},getDmcFrequency:function(t){return t>=0&&t<16?this.dmcFreqLookup[t]:0},getNoiseWaveLength:function(t){return t>=0&&t<16?this.noiseWavelengthLookup[t]:0},setPanning:function(t){for(var e=0;e<5;e++)this.panning[e]=t[e];this.updateStereoPos()},setMasterVolume:function(t){t<0&&(t=0),t>256&&(t=256),this.masterVolume=t,this.updateStereoPos()},updateStereoPos:function(){this.stereoPosLSquare1=this.panning[0]*this.masterVolume>>8,this.stereoPosLSquare2=this.panning[1]*this.masterVolume>>8,this.stereoPosLTriangle=this.panning[2]*this.masterVolume>>8,this.stereoPosLNoise=this.panning[3]*this.masterVolume>>8,this.stereoPosLDMC=this.panning[4]*this.masterVolume>>8,this.stereoPosRSquare1=this.masterVolume-this.stereoPosLSquare1,this.stereoPosRSquare2=this.masterVolume-this.stereoPosLSquare2,this.stereoPosRTriangle=this.masterVolume-this.stereoPosLTriangle,this.stereoPosRNoise=this.masterVolume-this.stereoPosLNoise,this.stereoPosRDMC=this.masterVolume-this.stereoPosLDMC},initLengthLookup:function(){this.lengthLookup=[10,254,20,2,40,4,80,6,160,8,60,10,14,12,26,14,12,16,24,18,48,20,96,22,192,24,72,26,16,28,32,30]},initDmcFrequencyLookup:function(){this.dmcFreqLookup=new Array(16),this.dmcFreqLookup[0]=3424,this.dmcFreqLookup[1]=3040,this.dmcFreqLookup[2]=2720,this.dmcFreqLookup[3]=2560,this.dmcFreqLookup[4]=2288,this.dmcFreqLookup[5]=2032,this.dmcFreqLookup[6]=1808,this.dmcFreqLookup[7]=1712,this.dmcFreqLookup[8]=1520,this.dmcFreqLookup[9]=1280,this.dmcFreqLookup[10]=1136,this.dmcFreqLookup[11]=1024,this.dmcFreqLookup[12]=848,this.dmcFreqLookup[13]=672,this.dmcFreqLookup[14]=576,this.dmcFreqLookup[15]=432},initNoiseWavelengthLookup:function(){this.noiseWavelengthLookup=new Array(16),this.noiseWavelengthLookup[0]=4,this.noiseWavelengthLookup[1]=8,this.noiseWavelengthLookup[2]=16,this.noiseWavelengthLookup[3]=32,this.noiseWavelengthLookup[4]=64,this.noiseWavelengthLookup[5]=96,this.noiseWavelengthLookup[6]=128,this.noiseWavelengthLookup[7]=160,this.noiseWavelengthLookup[8]=202,this.noiseWavelengthLookup[9]=254,this.noiseWavelengthLookup[10]=380,this.noiseWavelengthLookup[11]=508,this.noiseWavelengthLookup[12]=762,this.noiseWavelengthLookup[13]=1016,this.noiseWavelengthLookup[14]=2034,this.noiseWavelengthLookup[15]=4068},initDACtables:function(){var t,e,s,i=0,r=0;for(this.square_table=new Array(32*16),this.tnd_table=new Array(204*16),s=0;s<32*16;s++)t=95.52/(8128/(s/16)+100),t*=.98411,t*=5e4,e=Math.floor(t),this.square_table[s]=e,e>i&&(i=e);for(s=0;s<204*16;s++)t=163.67/(24329/(s/16)+100),t*=.98411,t*=5e4,e=Math.floor(t),this.tnd_table[s]=e,e>r&&(r=e);this.dacRange=i+r,this.dcValue=this.dacRange/2}};var Zo=function(t){this.papu=t,this.MODE_NORMAL=0,this.MODE_LOOP=1,this.MODE_IRQ=2,this.isEnabled=null,this.hasSample=null,this.irqGenerated=!1,this.playMode=null,this.dmaFrequency=null,this.dmaCounter=null,this.deltaCounter=null,this.playStartAddress=null,this.playAddress=null,this.playLength=null,this.playLengthCounter=null,this.shiftCounter=null,this.reg4012=null,this.reg4013=null,this.sample=null,this.dacLsb=null,this.data=null,this.reset()};Zo.prototype={clockDmc:function(){this.hasSample&&(this.data&1?this.deltaCounter<63&&this.deltaCounter++:this.deltaCounter>0&&this.deltaCounter--,this.sample=this.isEnabled?(this.deltaCounter<<1)+this.dacLsb:0,this.data>>=1),this.dmaCounter--,this.dmaCounter<=0&&(this.hasSample=!1,this.endOfSample(),this.dmaCounter=8),this.irqGenerated&&this.papu.nes.cpu.requestIrq(this.papu.nes.cpu.IRQ_NORMAL)},endOfSample:function(){this.playLengthCounter===0&&this.playMode===this.MODE_LOOP&&(this.playAddress=this.playStartAddress,this.playLengthCounter=this.playLength),this.playLengthCounter>0&&(this.nextSample(),this.playLengthCounter===0&&this.playMode===this.MODE_IRQ&&(this.irqGenerated=!0))},nextSample:function(){this.data=this.papu.nes.mmap.load(this.playAddress),this.papu.nes.cpu.haltCycles(4),this.playLengthCounter--,this.playAddress++,this.playAddress>65535&&(this.playAddress=32768),this.hasSample=!0},writeReg:function(t,e){t===16400?(e>>6?(e>>6&1)===1?this.playMode=this.MODE_LOOP:e>>6===2&&(this.playMode=this.MODE_IRQ):this.playMode=this.MODE_NORMAL,!(e&128)&&(this.irqGenerated=!1),this.dmaFrequency=this.papu.getDmcFrequency(e&15)):t===16401?(this.deltaCounter=e>>1&63,this.dacLsb=e&1,this.sample=(this.deltaCounter<<1)+this.dacLsb):t===16402?(this.playStartAddress=e<<6|49152,this.playAddress=this.playStartAddress,this.reg4012=e):t===16403?(this.playLength=(e<<4)+1,this.playLengthCounter=this.playLength,this.reg4013=e):t===16405&&(e>>4&1?(this.playAddress=this.playStartAddress,this.playLengthCounter=this.playLength):this.playLengthCounter=0,this.irqGenerated=!1)},setEnabled:function(t){!this.isEnabled&&t&&(this.playLengthCounter=this.playLength),this.isEnabled=t},getLengthStatus:function(){return this.playLengthCounter===0||!this.isEnabled?0:1},getIrqStatus:function(){return this.irqGenerated?1:0},reset:function(){this.isEnabled=!1,this.irqGenerated=!1,this.playMode=this.MODE_NORMAL,this.dmaFrequency=0,this.dmaCounter=0,this.deltaCounter=0,this.playStartAddress=0,this.playAddress=0,this.playLength=0,this.playLengthCounter=0,this.sample=0,this.dacLsb=0,this.shiftCounter=0,this.reg4012=0,this.reg4013=0,this.data=0}};var jo=function(t){this.papu=t,this.isEnabled=null,this.envDecayDisable=null,this.envDecayLoopEnable=null,this.lengthCounterEnable=null,this.envReset=null,this.shiftNow=null,this.lengthCounter=null,this.progTimerCount=null,this.progTimerMax=null,this.envDecayRate=null,this.envDecayCounter=null,this.envVolume=null,this.masterVolume=null,this.shiftReg=16384,this.randomBit=null,this.randomMode=null,this.sampleValue=null,this.accValue=0,this.accCount=1,this.tmp=null,this.reset()};jo.prototype={reset:function(){this.progTimerCount=0,this.progTimerMax=0,this.isEnabled=!1,this.lengthCounter=0,this.lengthCounterEnable=!1,this.envDecayDisable=!1,this.envDecayLoopEnable=!1,this.shiftNow=!1,this.envDecayRate=0,this.envDecayCounter=0,this.envVolume=0,this.masterVolume=0,this.shiftReg=1,this.randomBit=0,this.randomMode=0,this.sampleValue=0,this.tmp=0},clockLengthCounter:function(){this.lengthCounterEnable&&this.lengthCounter>0&&(this.lengthCounter--,this.lengthCounter===0&&this.updateSampleValue())},clockEnvDecay:function(){this.envReset?(this.envReset=!1,this.envDecayCounter=this.envDecayRate+1,this.envVolume=15):--this.envDecayCounter<=0&&(this.envDecayCounter=this.envDecayRate+1,this.envVolume>0?this.envVolume--:this.envVolume=this.envDecayLoopEnable?15:0),this.envDecayDisable?this.masterVolume=this.envDecayRate:this.masterVolume=this.envVolume,this.updateSampleValue()},updateSampleValue:function(){this.isEnabled&&this.lengthCounter>0&&(this.sampleValue=this.randomBit*this.masterVolume)},writeReg:function(t,e){t===16396?(this.envDecayDisable=(e&16)!==0,this.envDecayRate=e&15,this.envDecayLoopEnable=(e&32)!==0,this.lengthCounterEnable=(e&32)===0,this.envDecayDisable?this.masterVolume=this.envDecayRate:this.masterVolume=this.envVolume):t===16398?(this.progTimerMax=this.papu.getNoiseWaveLength(e&15),this.randomMode=e>>7):t===16399&&(this.lengthCounter=this.papu.getLengthMax(e&248),this.envReset=!0)},setEnabled:function(t){this.isEnabled=t,t||(this.lengthCounter=0),this.updateSampleValue()},getLengthStatus:function(){return this.lengthCounter===0||!this.isEnabled?0:1}};var Ti=function(t,e){this.papu=t,this.dutyLookup=[0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,1,0,0,1,1,1,1,1],this.impLookup=[1,-1,0,0,0,0,0,0,1,0,-1,0,0,0,0,0,1,0,0,0,-1,0,0,0,-1,0,1,0,0,0,0,0],this.sqr1=e,this.isEnabled=null,this.lengthCounterEnable=null,this.sweepActive=null,this.envDecayDisable=null,this.envDecayLoopEnable=null,this.envReset=null,this.sweepCarry=null,this.updateSweepPeriod=null,this.progTimerCount=null,this.progTimerMax=null,this.lengthCounter=null,this.squareCounter=null,this.sweepCounter=null,this.sweepCounterMax=null,this.sweepMode=null,this.sweepShiftAmount=null,this.envDecayRate=null,this.envDecayCounter=null,this.envVolume=null,this.masterVolume=null,this.dutyMode=null,this.sweepResult=null,this.sampleValue=null,this.vol=null,this.reset()};Ti.prototype={reset:function(){this.progTimerCount=0,this.progTimerMax=0,this.lengthCounter=0,this.squareCounter=0,this.sweepCounter=0,this.sweepCounterMax=0,this.sweepMode=0,this.sweepShiftAmount=0,this.envDecayRate=0,this.envDecayCounter=0,this.envVolume=0,this.masterVolume=0,this.dutyMode=0,this.vol=0,this.isEnabled=!1,this.lengthCounterEnable=!1,this.sweepActive=!1,this.sweepCarry=!1,this.envDecayDisable=!1,this.envDecayLoopEnable=!1},clockLengthCounter:function(){this.lengthCounterEnable&&this.lengthCounter>0&&(this.lengthCounter--,this.lengthCounter===0&&this.updateSampleValue())},clockEnvDecay:function(){this.envReset?(this.envReset=!1,this.envDecayCounter=this.envDecayRate+1,this.envVolume=15):--this.envDecayCounter<=0&&(this.envDecayCounter=this.envDecayRate+1,this.envVolume>0?this.envVolume--:this.envVolume=this.envDecayLoopEnable?15:0),this.envDecayDisable?this.masterVolume=this.envDecayRate:this.masterVolume=this.envVolume,this.updateSampleValue()},clockSweep:function(){--this.sweepCounter<=0&&(this.sweepCounter=this.sweepCounterMax+1,this.sweepActive&&this.sweepShiftAmount>0&&this.progTimerMax>7&&(this.sweepCarry=!1,this.sweepMode===0?(this.progTimerMax+=this.progTimerMax>>this.sweepShiftAmount,this.progTimerMax>4095&&(this.progTimerMax=4095,this.sweepCarry=!0)):this.progTimerMax=this.progTimerMax-((this.progTimerMax>>this.sweepShiftAmount)-(this.sqr1?1:0)))),this.updateSweepPeriod&&(this.updateSweepPeriod=!1,this.sweepCounter=this.sweepCounterMax+1)},updateSampleValue:function(){this.isEnabled&&this.lengthCounter>0&&this.progTimerMax>7?this.sweepMode===0&&this.progTimerMax+(this.progTimerMax>>this.sweepShiftAmount)>4095?this.sampleValue=0:this.sampleValue=this.masterVolume*this.dutyLookup[(this.dutyMode<<3)+this.squareCounter]:this.sampleValue=0},writeReg:function(t,e){var s=this.sqr1?0:4;t===16384+s?(this.envDecayDisable=(e&16)!==0,this.envDecayRate=e&15,this.envDecayLoopEnable=(e&32)!==0,this.dutyMode=e>>6&3,this.lengthCounterEnable=(e&32)===0,this.envDecayDisable?this.masterVolume=this.envDecayRate:this.masterVolume=this.envVolume,this.updateSampleValue()):t===16385+s?(this.sweepActive=(e&128)!==0,this.sweepCounterMax=e>>4&7,this.sweepMode=e>>3&1,this.sweepShiftAmount=e&7,this.updateSweepPeriod=!0):t===16386+s?(this.progTimerMax&=1792,this.progTimerMax|=e):t===16387+s&&(this.progTimerMax&=255,this.progTimerMax|=(e&7)<<8,this.isEnabled&&(this.lengthCounter=this.papu.getLengthMax(e&248)),this.envReset=!0)},setEnabled:function(t){this.isEnabled=t,t||(this.lengthCounter=0),this.updateSampleValue()},getLengthStatus:function(){return this.lengthCounter===0||!this.isEnabled?0:1}};var Ko=function(t){this.papu=t,this.isEnabled=null,this.sampleCondition=null,this.lengthCounterEnable=null,this.lcHalt=null,this.lcControl=null,this.progTimerCount=null,this.progTimerMax=null,this.triangleCounter=null,this.lengthCounter=null,this.linearCounter=null,this.lcLoadValue=null,this.sampleValue=null,this.tmp=null,this.reset()};Ko.prototype={reset:function(){this.progTimerCount=0,this.progTimerMax=0,this.triangleCounter=0,this.isEnabled=!1,this.sampleCondition=!1,this.lengthCounter=0,this.lengthCounterEnable=!1,this.linearCounter=0,this.lcLoadValue=0,this.lcHalt=!0,this.lcControl=!1,this.tmp=0,this.sampleValue=15},clockLengthCounter:function(){this.lengthCounterEnable&&this.lengthCounter>0&&(this.lengthCounter--,this.lengthCounter===0&&this.updateSampleCondition())},clockLinearCounter:function(){this.lcHalt?(this.linearCounter=this.lcLoadValue,this.updateSampleCondition()):this.linearCounter>0&&(this.linearCounter--,this.updateSampleCondition()),this.lcControl||(this.lcHalt=!1)},getLengthStatus:function(){return this.lengthCounter===0||!this.isEnabled?0:1},readReg:function(t){return 0},writeReg:function(t,e){t===16392?(this.lcControl=(e&128)!==0,this.lcLoadValue=e&127,this.lengthCounterEnable=!this.lcControl):t===16394?(this.progTimerMax&=1792,this.progTimerMax|=e):t===16395&&(this.progTimerMax&=255,this.progTimerMax|=(e&7)<<8,this.lengthCounter=this.papu.getLengthMax(e&248),this.lcHalt=!0),this.updateSampleCondition()},clockProgrammableTimer:function(t){if(this.progTimerMax>0)for(this.progTimerCount+=t;this.progTimerMax>0&&this.progTimerCount>=this.progTimerMax;)this.progTimerCount-=this.progTimerMax,this.isEnabled&&this.lengthCounter>0&&this.linearCounter>0&&this.clockTriangleGenerator()},clockTriangleGenerator:function(){this.triangleCounter++,this.triangleCounter&=31},setEnabled:function(t){this.isEnabled=t,t||(this.lengthCounter=0),this.updateSampleCondition()},updateSampleCondition:function(){this.sampleCondition=this.isEnabled&&this.progTimerMax>7&&this.linearCounter>0&&this.lengthCounter>0}};var ec=Wo,ge=er,b={};b[0]=function(t){this.nes=t};b[0].prototype={reset:function(){this.joy1StrobeState=0,this.joy2StrobeState=0,this.joypadLastWrite=0,this.zapperFired=!1,this.zapperX=null,this.zapperY=null},write:function(t,e){t<8192?this.nes.cpu.mem[t&2047]=e:t>16407?(this.nes.cpu.mem[t]=e,t>=24576&&t<32768&&this.nes.opts.onBatteryRamWrite(t,e)):t>8199&&t<16384?this.regWrite(8192+(t&7),e):this.regWrite(t,e)},writelow:function(t,e){t<8192?this.nes.cpu.mem[t&2047]=e:t>16407?this.nes.cpu.mem[t]=e:t>8199&&t<16384?this.regWrite(8192+(t&7),e):this.regWrite(t,e)},load:function(t){return t&=65535,t>16407?this.nes.cpu.mem[t]:t>=8192?this.regLoad(t):this.nes.cpu.mem[t&2047]},regLoad:function(t){switch(t>>12){case 0:break;case 1:break;case 2:case 3:switch(t&7){case 0:return this.nes.cpu.mem[8192];case 1:return this.nes.cpu.mem[8193];case 2:return this.nes.ppu.readStatusRegister();case 3:return 0;case 4:return this.nes.ppu.sramLoad();case 5:return 0;case 6:return 0;case 7:return this.nes.ppu.vramLoad()}break;case 4:switch(t-16405){case 0:return this.nes.papu.readReg(t);case 1:return this.joy1Read();case 2:var e;return this.zapperX!==null&&this.zapperY!==null&&this.nes.ppu.isPixelWhite(this.zapperX,this.zapperY)?e=0:e=8,this.zapperFired&&(e|=16),(this.joy2Read()|e)&65535}break}return 0},regWrite:function(t,e){switch(t){case 8192:this.nes.cpu.mem[t]=e,this.nes.ppu.updateControlReg1(e);break;case 8193:this.nes.cpu.mem[t]=e,this.nes.ppu.updateControlReg2(e);break;case 8195:this.nes.ppu.writeSRAMAddress(e);break;case 8196:this.nes.ppu.sramWrite(e);break;case 8197:this.nes.ppu.scrollWrite(e);break;case 8198:this.nes.ppu.writeVRAMAddress(e);break;case 8199:this.nes.ppu.vramWrite(e);break;case 16404:this.nes.ppu.sramDMA(e);break;case 16405:this.nes.papu.writeReg(t,e);break;case 16406:!(e&1)&&(this.joypadLastWrite&1)===1&&(this.joy1StrobeState=0,this.joy2StrobeState=0),this.joypadLastWrite=e;break;case 16407:this.nes.papu.writeReg(t,e);break;default:t>=16384&&t<=16407&&this.nes.papu.writeReg(t,e)}},joy1Read:function(){var t;switch(this.joy1StrobeState){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t=this.nes.controllers[1].state[this.joy1StrobeState];break;case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:t=0;break;case 19:t=1;break;default:t=0}return this.joy1StrobeState++,this.joy1StrobeState===24&&(this.joy1StrobeState=0),t},joy2Read:function(){var t;switch(this.joy2StrobeState){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t=this.nes.controllers[2].state[this.joy2StrobeState];break;case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:t=0;break;case 19:t=1;break;default:t=0}return this.joy2StrobeState++,this.joy2StrobeState===24&&(this.joy2StrobeState=0),t},loadROM:function(){if(!this.nes.rom.valid||this.nes.rom.romCount<1)throw new Error("NoMapper: Invalid ROM! Unable to load.");this.loadPRGROM(),this.loadCHRROM(),this.loadBatteryRam(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)},loadPRGROM:function(){this.nes.rom.romCount>1?(this.loadRomBank(0,32768),this.loadRomBank(1,49152)):(this.loadRomBank(0,32768),this.loadRomBank(0,49152))},loadCHRROM:function(){this.nes.rom.vromCount>0&&(this.nes.rom.vromCount===1?(this.loadVromBank(0,0),this.loadVromBank(0,4096)):(this.loadVromBank(0,0),this.loadVromBank(1,4096)))},loadBatteryRam:function(){if(this.nes.rom.batteryRam){var t=this.nes.rom.batteryRam;t!==null&&t.length===8192&&ge.copyArrayElements(t,0,this.nes.cpu.mem,24576,8192)}},loadRomBank:function(t,e){t%=this.nes.rom.romCount,ge.copyArrayElements(this.nes.rom.rom[t],0,this.nes.cpu.mem,e,16384)},loadVromBank:function(t,e){if(this.nes.rom.vromCount!==0){this.nes.ppu.triggerRendering(),ge.copyArrayElements(this.nes.rom.vrom[t%this.nes.rom.vromCount],0,this.nes.ppu.vramMem,e,4096);var s=this.nes.rom.vromTile[t%this.nes.rom.vromCount];ge.copyArrayElements(s,0,this.nes.ppu.ptTile,e>>4,256)}},load32kRomBank:function(t,e){this.loadRomBank(t*2%this.nes.rom.romCount,e),this.loadRomBank((t*2+1)%this.nes.rom.romCount,e+16384)},load8kVromBank:function(t,e){this.nes.rom.vromCount!==0&&(this.nes.ppu.triggerRendering(),this.loadVromBank(t%this.nes.rom.vromCount,e),this.loadVromBank((t+1)%this.nes.rom.vromCount,e+4096))},load1kVromBank:function(t,e){if(this.nes.rom.vromCount!==0){this.nes.ppu.triggerRendering();var s=Math.floor(t/4)%this.nes.rom.vromCount,i=t%4*1024;ge.copyArrayElements(this.nes.rom.vrom[s],i,this.nes.ppu.vramMem,e,1024);for(var r=this.nes.rom.vromTile[s],n=e>>4,o=0;o<64;o++)this.nes.ppu.ptTile[n+o]=r[(t%4<<6)+o]}},load2kVromBank:function(t,e){if(this.nes.rom.vromCount!==0){this.nes.ppu.triggerRendering();var s=Math.floor(t/2)%this.nes.rom.vromCount,i=t%2*2048;ge.copyArrayElements(this.nes.rom.vrom[s],i,this.nes.ppu.vramMem,e,2048);for(var r=this.nes.rom.vromTile[s],n=e>>4,o=0;o<128;o++)this.nes.ppu.ptTile[n+o]=r[(t%2<<7)+o]}},load8kRomBank:function(t,e){var s=Math.floor(t/2)%this.nes.rom.romCount,i=t%2*8192;ge.copyArrayElements(this.nes.rom.rom[s],i,this.nes.cpu.mem,e,8192)},clockIrqCounter:function(){},latchAccess:function(t){},toJSON:function(){return{joy1StrobeState:this.joy1StrobeState,joy2StrobeState:this.joy2StrobeState,joypadLastWrite:this.joypadLastWrite}},fromJSON:function(t){this.joy1StrobeState=t.joy1StrobeState,this.joy2StrobeState=t.joy2StrobeState,this.joypadLastWrite=t.joypadLastWrite}};b[1]=function(t){this.nes=t};b[1].prototype=new b[0];b[1].prototype.reset=function(){b[0].prototype.reset.apply(this),this.regBuffer=0,this.regBufferCounter=0,this.mirroring=0,this.oneScreenMirroring=0,this.prgSwitchingArea=1,this.prgSwitchingSize=1,this.vromSwitchingSize=0,this.romSelectionReg0=0,this.romSelectionReg1=0,this.romBankSelect=0};b[1].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}e&128?(this.regBufferCounter=0,this.regBuffer=0,this.getRegNumber(t)===0&&(this.prgSwitchingArea=1,this.prgSwitchingSize=1)):(this.regBuffer=this.regBuffer&255-(1<<this.regBufferCounter)|(e&1)<<this.regBufferCounter,this.regBufferCounter++,this.regBufferCounter===5&&(this.setReg(this.getRegNumber(t),this.regBuffer),this.regBuffer=0,this.regBufferCounter=0))};b[1].prototype.setReg=function(t,e){var s;switch(t){case 0:s=e&3,s!==this.mirroring&&(this.mirroring=s,this.mirroring&2?this.mirroring&1?this.nes.ppu.setMirroring(this.nes.rom.HORIZONTAL_MIRRORING):this.nes.ppu.setMirroring(this.nes.rom.VERTICAL_MIRRORING):this.nes.ppu.setMirroring(this.nes.rom.SINGLESCREEN_MIRRORING)),this.prgSwitchingArea=e>>2&1,this.prgSwitchingSize=e>>3&1,this.vromSwitchingSize=e>>4&1;break;case 1:this.romSelectionReg0=e>>4&1,this.nes.rom.vromCount>0&&(this.vromSwitchingSize===0?this.romSelectionReg0===0?this.load8kVromBank(e&15,0):this.load8kVromBank(Math.floor(this.nes.rom.vromCount/2)+(e&15),0):this.romSelectionReg0===0?this.loadVromBank(e&15,0):this.loadVromBank(Math.floor(this.nes.rom.vromCount/2)+(e&15),0));break;case 2:this.romSelectionReg1=e>>4&1,this.nes.rom.vromCount>0&&this.vromSwitchingSize===1&&(this.romSelectionReg1===0?this.loadVromBank(e&15,4096):this.loadVromBank(Math.floor(this.nes.rom.vromCount/2)+(e&15),4096));break;default:s=e&15;var i,r=0;this.nes.rom.romCount>=32?this.vromSwitchingSize===0?this.romSelectionReg0===1&&(r=16):r=(this.romSelectionReg0|this.romSelectionReg1<<1)<<3:this.nes.rom.romCount>=16&&this.romSelectionReg0===1&&(r=8),this.prgSwitchingSize===0?(i=r+(e&15),this.load32kRomBank(i,32768)):(i=r*2+(e&15),this.prgSwitchingArea===0?this.loadRomBank(i,49152):this.loadRomBank(i,32768))}};b[1].prototype.getRegNumber=function(t){return t>=32768&&t<=40959?0:t>=40960&&t<=49151?1:t>=49152&&t<=57343?2:3};b[1].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("MMC1: Invalid ROM! Unable to load.");this.loadRomBank(0,32768),this.loadRomBank(this.nes.rom.romCount-1,49152),this.loadCHRROM(),this.loadBatteryRam(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};b[1].prototype.switchLowHighPrgRom=function(t){};b[1].prototype.switch16to32=function(){};b[1].prototype.switch32to16=function(){};b[1].prototype.toJSON=function(){var t=b[0].prototype.toJSON.apply(this);return t.mirroring=this.mirroring,t.oneScreenMirroring=this.oneScreenMirroring,t.prgSwitchingArea=this.prgSwitchingArea,t.prgSwitchingSize=this.prgSwitchingSize,t.vromSwitchingSize=this.vromSwitchingSize,t.romSelectionReg0=this.romSelectionReg0,t.romSelectionReg1=this.romSelectionReg1,t.romBankSelect=this.romBankSelect,t.regBuffer=this.regBuffer,t.regBufferCounter=this.regBufferCounter,t};b[1].prototype.fromJSON=function(t){b[0].prototype.fromJSON.apply(this,arguments),this.mirroring=t.mirroring,this.oneScreenMirroring=t.oneScreenMirroring,this.prgSwitchingArea=t.prgSwitchingArea,this.prgSwitchingSize=t.prgSwitchingSize,this.vromSwitchingSize=t.vromSwitchingSize,this.romSelectionReg0=t.romSelectionReg0,this.romSelectionReg1=t.romSelectionReg1,this.romBankSelect=t.romBankSelect,this.regBuffer=t.regBuffer,this.regBufferCounter=t.regBufferCounter};b[2]=function(t){this.nes=t};b[2].prototype=new b[0];b[2].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}else this.loadRomBank(e,32768)};b[2].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("UNROM: Invalid ROM! Unable to load.");this.loadRomBank(0,32768),this.loadRomBank(this.nes.rom.romCount-1,49152),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};b[3]=function(t){this.nes=t};b[3].prototype=new b[0];b[3].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}else{var s=e%(this.nes.rom.vromCount/2)*2;this.loadVromBank(s,0),this.loadVromBank(s+1,4096),this.load8kVromBank(e*2,0)}};b[4]=function(t){this.nes=t,this.CMD_SEL_2_1K_VROM_0000=0,this.CMD_SEL_2_1K_VROM_0800=1,this.CMD_SEL_1K_VROM_1000=2,this.CMD_SEL_1K_VROM_1400=3,this.CMD_SEL_1K_VROM_1800=4,this.CMD_SEL_1K_VROM_1C00=5,this.CMD_SEL_ROM_PAGE1=6,this.CMD_SEL_ROM_PAGE2=7,this.command=null,this.prgAddressSelect=null,this.chrAddressSelect=null,this.pageNumber=null,this.irqCounter=null,this.irqLatchValue=null,this.irqEnable=null,this.prgAddressChanged=!1};b[4].prototype=new b[0];b[4].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}switch(t){case 32768:this.command=e&7;var s=e>>6&1;s!==this.prgAddressSelect&&(this.prgAddressChanged=!0),this.prgAddressSelect=s,this.chrAddressSelect=e>>7&1;break;case 32769:this.executeCommand(this.command,e);break;case 40960:e&1?this.nes.ppu.setMirroring(this.nes.rom.HORIZONTAL_MIRRORING):this.nes.ppu.setMirroring(this.nes.rom.VERTICAL_MIRRORING);break;case 40961:break;case 49152:this.irqCounter=e;break;case 49153:this.irqLatchValue=e;break;case 57344:this.irqEnable=0;break;case 57345:this.irqEnable=1;break}};b[4].prototype.executeCommand=function(t,e){switch(t){case this.CMD_SEL_2_1K_VROM_0000:this.chrAddressSelect===0?(this.load1kVromBank(e,0),this.load1kVromBank(e+1,1024)):(this.load1kVromBank(e,4096),this.load1kVromBank(e+1,5120));break;case this.CMD_SEL_2_1K_VROM_0800:this.chrAddressSelect===0?(this.load1kVromBank(e,2048),this.load1kVromBank(e+1,3072)):(this.load1kVromBank(e,6144),this.load1kVromBank(e+1,7168));break;case this.CMD_SEL_1K_VROM_1000:this.chrAddressSelect===0?this.load1kVromBank(e,4096):this.load1kVromBank(e,0);break;case this.CMD_SEL_1K_VROM_1400:this.chrAddressSelect===0?this.load1kVromBank(e,5120):this.load1kVromBank(e,1024);break;case this.CMD_SEL_1K_VROM_1800:this.chrAddressSelect===0?this.load1kVromBank(e,6144):this.load1kVromBank(e,2048);break;case this.CMD_SEL_1K_VROM_1C00:this.chrAddressSelect===0?this.load1kVromBank(e,7168):this.load1kVromBank(e,3072);break;case this.CMD_SEL_ROM_PAGE1:this.prgAddressChanged&&(this.prgAddressSelect===0?this.load8kRomBank((this.nes.rom.romCount-1)*2,49152):this.load8kRomBank((this.nes.rom.romCount-1)*2,32768),this.prgAddressChanged=!1),this.prgAddressSelect===0?this.load8kRomBank(e,32768):this.load8kRomBank(e,49152);break;case this.CMD_SEL_ROM_PAGE2:this.load8kRomBank(e,40960),this.prgAddressChanged&&(this.prgAddressSelect===0?this.load8kRomBank((this.nes.rom.romCount-1)*2,49152):this.load8kRomBank((this.nes.rom.romCount-1)*2,32768),this.prgAddressChanged=!1)}};b[4].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("MMC3: Invalid ROM! Unable to load.");this.load8kRomBank((this.nes.rom.romCount-1)*2,49152),this.load8kRomBank((this.nes.rom.romCount-1)*2+1,57344),this.load8kRomBank(0,32768),this.load8kRomBank(1,40960),this.loadCHRROM(),this.loadBatteryRam(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};b[4].prototype.clockIrqCounter=function(){this.irqEnable===1&&(this.irqCounter--,this.irqCounter<0&&(this.nes.cpu.requestIrq(this.nes.cpu.IRQ_NORMAL),this.irqCounter=this.irqLatchValue))};b[4].prototype.toJSON=function(){var t=b[0].prototype.toJSON.apply(this);return t.command=this.command,t.prgAddressSelect=this.prgAddressSelect,t.chrAddressSelect=this.chrAddressSelect,t.pageNumber=this.pageNumber,t.irqCounter=this.irqCounter,t.irqLatchValue=this.irqLatchValue,t.irqEnable=this.irqEnable,t.prgAddressChanged=this.prgAddressChanged,t};b[4].prototype.fromJSON=function(t){b[0].prototype.fromJSON.apply(this,arguments),this.command=t.command,this.prgAddressSelect=t.prgAddressSelect,this.chrAddressSelect=t.chrAddressSelect,this.pageNumber=t.pageNumber,this.irqCounter=t.irqCounter,this.irqLatchValue=t.irqLatchValue,this.irqEnable=t.irqEnable,this.prgAddressChanged=t.prgAddressChanged};b[5]=function(t){this.nes=t};b[5].prototype=new b[0];b[5].prototype.write=function(t,e){t<32768?b[0].prototype.write.apply(this,arguments):this.load8kVromBank(e,0)};b[5].prototype.write=function(t,e){if(t<20480){b[0].prototype.write.apply(this,arguments);return}switch(t){case 20736:this.prg_size=e&3;break;case 20737:this.chr_size=e&3;break;case 20738:this.sram_we_a=e&3;break;case 20739:this.sram_we_b=e&3;break;case 20740:this.graphic_mode=e&3;break;case 20741:this.nametable_mode=e,this.nametable_type[0]=e&3,this.load1kVromBank(e&3,8192),e>>=2,this.nametable_type[1]=e&3,this.load1kVromBank(e&3,9216),e>>=2,this.nametable_type[2]=e&3,this.load1kVromBank(e&3,10240),e>>=2,this.nametable_type[3]=e&3,this.load1kVromBank(e&3,11264);break;case 20742:this.fill_chr=e;break;case 20743:this.fill_pal=e&3;break;case 20755:this.SetBank_SRAM(3,e&3);break;case 20756:case 20757:case 20758:case 20759:this.SetBank_CPU(t,e);break;case 20768:case 20769:case 20770:case 20771:case 20772:case 20773:case 20774:case 20775:this.chr_mode=0,this.chr_page[0][t&7]=e,this.SetBank_PPU();break;case 20776:case 20777:case 20778:case 20779:this.chr_mode=1,this.chr_page[1][(t&3)+0]=e,this.chr_page[1][(t&3)+4]=e,this.SetBank_PPU();break;case 20992:this.split_control=e;break;case 20993:this.split_scroll=e;break;case 20994:this.split_page=e&63;break;case 20995:this.irq_line=e,this.nes.cpu.ClearIRQ();break;case 20996:this.irq_enable=e,this.nes.cpu.ClearIRQ();break;case 20997:this.mult_a=e;break;case 20998:this.mult_b=e;break;default:t>=20480&&t<=20501?this.nes.papu.exWrite(t,e):t>=23552&&t<=24575?this.graphic_mode===2||this.graphic_mode!==3&&this.irq_status&64:t>=24576&&t<=32767&&this.sram_we_a===2&&this.sram_we_b;break}};b[5].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("UNROM: Invalid ROM! Unable to load.");this.load8kRomBank(this.nes.rom.romCount*2-1,32768),this.load8kRomBank(this.nes.rom.romCount*2-1,40960),this.load8kRomBank(this.nes.rom.romCount*2-1,49152),this.load8kRomBank(this.nes.rom.romCount*2-1,57344),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};b[7]=function(t){this.nes=t};b[7].prototype=new b[0];b[7].prototype.write=function(t,e){t<32768?b[0].prototype.write.apply(this,arguments):(this.load32kRomBank(e&7,32768),e&16?this.nes.ppu.setMirroring(this.nes.rom.SINGLESCREEN_MIRRORING2):this.nes.ppu.setMirroring(this.nes.rom.SINGLESCREEN_MIRRORING))};b[7].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("AOROM: Invalid ROM! Unable to load.");this.loadPRGROM(),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};b[11]=function(t){this.nes=t};b[11].prototype=new b[0];b[11].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}else{var s=(e&15)*2%this.nes.rom.romCount,i=((e&15)*2+1)%this.nes.rom.romCount;if(this.loadRomBank(s,32768),this.loadRomBank(i,49152),this.nes.rom.vromCount>0){var r=(e>>4)*2%this.nes.rom.vromCount;this.loadVromBank(r,0),this.loadVromBank(r+1,4096)}}};b[34]=function(t){this.nes=t};b[34].prototype=new b[0];b[34].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}else this.load32kRomBank(e,32768)};b[38]=function(t){this.nes=t};b[38].prototype=new b[0];b[38].prototype.write=function(t,e){if(t<28672||t>32767){b[0].prototype.write.apply(this,arguments);return}else this.load32kRomBank(e&3,32768),this.load8kVromBank((e>>2&3)*2,0)};b[66]=function(t){this.nes=t};b[66].prototype=new b[0];b[66].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}else this.load32kRomBank(e>>4&3,32768),this.load8kVromBank((e&3)*2,0)};b[94]=function(t){this.nes=t};b[94].prototype=new b[0];b[94].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}else this.loadRomBank(e>>2,32768)};b[94].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("UN1ROM: Invalid ROM! Unable to load.");this.loadRomBank(0,32768),this.loadRomBank(this.nes.rom.romCount-1,49152),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};b[140]=function(t){this.nes=t};b[140].prototype=new b[0];b[140].prototype.write=function(t,e){if(t<24576||t>32767){b[0].prototype.write.apply(this,arguments);return}else this.load32kRomBank(e>>4&3,32768),this.load8kVromBank((e&15)*2,0)};b[180]=function(t){this.nes=t};b[180].prototype=new b[0];b[180].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}else this.loadRomBank(e,49152)};b[180].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("Mapper 180: Invalid ROM! Unable to load.");this.loadRomBank(0,32768),this.loadRomBank(this.nes.rom.romCount-1,49152),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};var sc=b,nn=sc,ic=Ho,$o=function(t){this.nes=t,this.mapperName=new Array(92);for(var e=0;e<92;e++)this.mapperName[e]="Unknown Mapper";this.mapperName[0]="Direct Access",this.mapperName[1]="Nintendo MMC1",this.mapperName[2]="UNROM",this.mapperName[3]="CNROM",this.mapperName[4]="Nintendo MMC3",this.mapperName[5]="Nintendo MMC5",this.mapperName[6]="FFE F4xxx",this.mapperName[7]="AOROM",this.mapperName[8]="FFE F3xxx",this.mapperName[9]="Nintendo MMC2",this.mapperName[10]="Nintendo MMC4",this.mapperName[11]="Color Dreams Chip",this.mapperName[12]="FFE F6xxx",this.mapperName[15]="100-in-1 switch",this.mapperName[16]="Bandai chip",this.mapperName[17]="FFE F8xxx",this.mapperName[18]="Jaleco SS8806 chip",this.mapperName[19]="Namcot 106 chip",this.mapperName[20]="Famicom Disk System",this.mapperName[21]="Konami VRC4a",this.mapperName[22]="Konami VRC2a",this.mapperName[23]="Konami VRC2a",this.mapperName[24]="Konami VRC6",this.mapperName[25]="Konami VRC4b",this.mapperName[32]="Irem G-101 chip",this.mapperName[33]="Taito TC0190/TC0350",this.mapperName[34]="32kB ROM switch",this.mapperName[64]="Tengen RAMBO-1 chip",this.mapperName[65]="Irem H-3001 chip",this.mapperName[66]="GNROM switch",this.mapperName[67]="SunSoft3 chip",this.mapperName[68]="SunSoft4 chip",this.mapperName[69]="SunSoft5 FME-7 chip",this.mapperName[71]="Camerica chip",this.mapperName[78]="Irem 74HC161/32-based",this.mapperName[91]="Pirate HK-SF3 chip"};$o.prototype={VERTICAL_MIRRORING:0,HORIZONTAL_MIRRORING:1,FOURSCREEN_MIRRORING:2,SINGLESCREEN_MIRRORING:3,SINGLESCREEN_MIRRORING2:4,SINGLESCREEN_MIRRORING3:5,SINGLESCREEN_MIRRORING4:6,CHRROM_MIRRORING:7,header:null,rom:null,vrom:null,vromTile:null,romCount:null,vromCount:null,mirroring:null,batteryRam:null,trainer:null,fourScreen:null,mapperType:null,valid:!1,load:function(t){var e,s,i;if(t.indexOf("NES")===-1)throw new Error("Not a valid NES ROM.");for(this.header=new Array(16),e=0;e<16;e++)this.header[e]=t.charCodeAt(e)&255;this.romCount=this.header[4],this.vromCount=this.header[5]*2,this.mirroring=this.header[6]&1?1:0,this.batteryRam=(this.header[6]&2)!==0,this.trainer=(this.header[6]&4)!==0,this.fourScreen=(this.header[6]&8)!==0,this.mapperType=this.header[6]>>4|this.header[7]&240;var r=!1;for(e=8;e<16;e++)if(this.header[e]!==0){r=!0;break}r&&(this.mapperType&=15),this.rom=new Array(this.romCount);var n=16;for(e=0;e<this.romCount;e++){for(this.rom[e]=new Array(16384),s=0;s<16384&&!(n+s>=t.length);s++)this.rom[e][s]=t.charCodeAt(n+s)&255;n+=16384}for(this.vrom=new Array(this.vromCount),e=0;e<this.vromCount;e++){for(this.vrom[e]=new Array(4096),s=0;s<4096&&!(n+s>=t.length);s++)this.vrom[e][s]=t.charCodeAt(n+s)&255;n+=4096}for(this.vromTile=new Array(this.vromCount),e=0;e<this.vromCount;e++)for(this.vromTile[e]=new Array(256),s=0;s<256;s++)this.vromTile[e][s]=new ic;var o,h;for(i=0;i<this.vromCount;i++)for(e=0;e<4096;e++)o=e>>4,h=e%16,h<8?this.vromTile[i][o].setScanline(h,this.vrom[i][e],this.vrom[i][e+8]):this.vromTile[i][o].setScanline(h-8,this.vrom[i][e-8],this.vrom[i][e]);this.valid=!0},getMirroringType:function(){return this.fourScreen?this.FOURSCREEN_MIRRORING:this.mirroring===0?this.HORIZONTAL_MIRRORING:this.VERTICAL_MIRRORING},getMapperName:function(){return this.mapperType>=0&&this.mapperType<this.mapperName.length?this.mapperName[this.mapperType]:"Unknown Mapper, "+this.mapperType},mapperSupported:function(){return typeof nn[this.mapperType]<"u"},createMapper:function(){if(this.mapperSupported())return new nn[this.mapperType](this.nes);throw new Error("This ROM uses a mapper not supported by JSNES: "+this.getMapperName()+"("+this.mapperType+")")}};var rc=$o,nc=zu,on=Vo,oc=Qu,hc=ec,ac=rc,zo=function(t){if(this.opts={onFrame:function(){},onAudioSample:null,onStatusUpdate:function(){},onBatteryRamWrite:function(){},preferredFrameRate:60,emulateSound:!0,sampleRate:48e3},typeof t<"u"){var e;for(e in this.opts)typeof t[e]<"u"&&(this.opts[e]=t[e])}this.frameTime=1e3/this.opts.preferredFrameRate,this.ui={writeFrame:this.opts.onFrame,updateStatus:this.opts.onStatusUpdate},this.cpu=new nc(this),this.ppu=new oc(this),this.papu=new hc(this),this.mmap=null,this.controllers={1:new on,2:new on},this.ui.updateStatus("Ready to load a ROM."),this.frame=this.frame.bind(this),this.buttonDown=this.buttonDown.bind(this),this.buttonUp=this.buttonUp.bind(this),this.zapperMove=this.zapperMove.bind(this),this.zapperFireDown=this.zapperFireDown.bind(this),this.zapperFireUp=this.zapperFireUp.bind(this)};zo.prototype={fpsFrameCount:0,romData:null,reset:function(){this.mmap!==null&&this.mmap.reset(),this.cpu.reset(),this.ppu.reset(),this.papu.reset(),this.lastFpsTime=null,this.fpsFrameCount=0},frame:function(){this.ppu.startFrame();var t=0,e=this.opts.emulateSound,s=this.cpu,i=this.ppu,r=this.papu;t:for(;;)for(s.cyclesToHalt===0?(t=s.emulate(),e&&r.clockFrameCounter(t),t*=3):s.cyclesToHalt>8?(t=24,e&&r.clockFrameCounter(8),s.cyclesToHalt-=8):(t=s.cyclesToHalt*3,e&&r.clockFrameCounter(s.cyclesToHalt),s.cyclesToHalt=0);t>0;t--){if(i.curX===i.spr0HitX&&i.f_spVisibility===1&&i.scanline-21===i.spr0HitY&&i.setStatusFlag(i.STATUS_SPRITE0HIT,!0),i.requestEndFrame&&(i.nmiCounter--,i.nmiCounter===0)){i.requestEndFrame=!1,i.startVBlank();break t}i.curX++,i.curX===341&&(i.curX=0,i.endScanline())}this.fpsFrameCount++},buttonDown:function(t,e){this.controllers[t].buttonDown(e)},buttonUp:function(t,e){this.controllers[t].buttonUp(e)},zapperMove:function(t,e){!this.mmap||(this.mmap.zapperX=t,this.mmap.zapperY=e)},zapperFireDown:function(){!this.mmap||(this.mmap.zapperFired=!0)},zapperFireUp:function(){!this.mmap||(this.mmap.zapperFired=!1)},getFPS:function(){var t=+new Date,e=null;return this.lastFpsTime&&(e=this.fpsFrameCount/((t-this.lastFpsTime)/1e3)),this.fpsFrameCount=0,this.lastFpsTime=t,e},reloadROM:function(){this.romData!==null&&this.loadROM(this.romData)},loadROM:function(t){this.rom=new ac(this),this.rom.load(t),this.reset(),this.mmap=this.rom.createMapper(),this.mmap.loadROM(),this.ppu.setMirroring(this.rom.getMirroringType()),this.romData=t},setFramerate:function(t){this.opts.preferredFrameRate=t,this.frameTime=1e3/t,this.papu.setSampleRate(this.opts.sampleRate,!1)},toJSON:function(){return{romData:this.romData,cpu:this.cpu.toJSON(),mmap:this.mmap.toJSON(),ppu:this.ppu.toJSON()}},fromJSON:function(t){this.reset(),this.romData=t.romData,this.cpu.fromJSON(t.cpu),this.mmap.fromJSON(t.mmap),this.ppu.fromJSON(t.ppu)}};var lc=zo,uc={Controller:Vo,NES:lc};function _s(t){return Array(t).fill(!1)}function cc(t){return t.filter(Boolean)}function fc(){return Mt(32768,0).map((t,e)=>e)}function Fe(t){const e=[];let s=t[0],i=1;for(let r=1;r<t.length;r++)t[r]===s?i++:(i>1?(e.push(i),e.push(s)):e.push(-s-1),s=t[r],i=1);return e.push(i),e.push(s),e}function xe(t){const e=[];for(let s=0;s<t.length;)if(t[s]<0)e.push(-t[s]-1),s++;else{const i=t[s],r=t[s+1];for(let n=0;n<i;n++)e.push(r);s+=2}return e}function pc(t){const e=[],s=[];for(let i=0;i<t.length;i++){for(let r=0;r<t[i].opaque.length;r++)t[i].opaque[r]===!1?e.push(0):e.push(1);s.push(...t[i].pix)}return[Fe(e),Fe(s)]}function dc(t){const e=[];let s=Array(8),i=[];const r=xe(t[0]),n=xe(t[1]);for(let o=0;o<512;o+=1){for(let h=0;h<8;h+=1)r[o*8+h]===0&&(s[h]=!1);for(let h=0;h<64;h+=1)i[h]=n[o*64+h];e.push({opaque:s,pix:i}),s=Array(8),i=[]}return e}function mc(t){const e=[],s=[];return t.reduce((i,r)=>(e.push(...r.tile),s.push(...r.attrib),i),e),[Fe(e),Fe(s)]}function _c(t){const e=[];let s=[],i=[];const r=xe(t[0]),n=xe(t[1]);for(let o=0;o<1024*4;o+=1)s.push(r[o]),i.push(n[o]),(o+1)%1024===0&&(e.push({tile:s,attrib:i}),s=[],i=[]);return e}function Rs(t){return+`0x${t}`}const Oi=class{constructor(){mt(this,"enable"),mt(this,"fixed"),mt(this,"greater"),mt(this,"lesser"),this.enable=!1,this.fixed={},this.greater={},this.lesser={}}parse(t){const e=Oi.reg.exec(t);if(!e)return;const s=Rs(e[1]),i=Rs(e[2]),r=Rs(e[4]);this.on(s,i,r)}on(t,e,s){if(!(t>X.cpu.mem.length-1))switch(this.enable||(this.enable=!0),e){case 0:this.fixed[t]=s;break;case 1:X.cpu.mem[t]=s;break;case 2:this.lesser[t]=s;break;case 3:this.greater[t]=s;break}}remove(t){delete this.fixed[t],delete this.greater[t],delete this.lesser[t]}disable(t){const e=Oi.reg.exec(t);if(!e)return;const s=Rs(e[1]);this.remove(s)}init(){this.enable=!1,this.fixed={},this.greater={},this.lesser={}}onFrame(){this.enable&&(fi(this.fixed).forEach(([t,e])=>{X.cpu.mem[t]=e}),fi(this.greater).forEach(([t,e])=>{X.cpu.mem[t]<e&&(X.cpu.mem[t]=e)}),fi(this.lesser).forEach(([t,e])=>{X.cpu.mem[t]>e&&(X.cpu.mem[t]=e)}))}};let Jo=Oi;mt(Jo,"reg",/([\da-fA-F]{4})-([0-3])([0-4])-([\da-fA-F]{2,8})/);const ye=new Jo,Js=256,Qs=240;let Is,Qo,th,Ds;const Pi=new ImageData(Js,Qs);function Rc(t){X.frameCounter++;for(let e=0;e<256*240;e+=1)th[e]=4278190080|t[e];ye.onFrame()}function gc(){Pi.data.set(Qo),Ds.putImageData(Pi,0,0)}function Sc(t){Ds=t.getContext("2d"),Ds.fillStyle="black",Ds.fillRect(0,0,Js,Qs);const e=new ArrayBuffer(Pi.data.length);Qo=new Uint8ClampedArray(e),th=new Uint32Array(e),X.frameCounter=1,Is=requestAnimationFrame(s);function s(){cancelAnimationFrame(Is),Is=requestAnimationFrame(s),gc()}}function hn(t){const e=t.parentNode,s=e.clientWidth,i=e.clientHeight,r=s/i,n=Js/Qs;n<r?(t.style.height=`${i}px`,t.style.width=`${Math.round(i+n)}px`):(t.style.width=`${s}px`,t.style.height=`${Math.round(s/n)}px`)}function an(){cancelAnimationFrame(Is)}function bc(t){const e=new Image;return e.src=t.toDataURL("image/png"),e}let Le={};const ln="........",pi=/\|\d\|([LRUDTSAB.]{8})\|([LRUDTSAB.]{8})?\|\|/g;function Ac(){Le={}}function un(t,e){let s=pi.exec(t),i=0+e,r=!1;if(Ac(),!!s)for(;s;){const n=s[1]===ln,o=s[2]===ln;if(n&&o){r&&(Le[i]={p1:Mt(8,64),p2:Mt(8,64)},r=!1),i++,s=pi.exec(t);continue}r=!0;const h=s[1]?s[1].split("").map(c=>c==="."?64:65).reverse():Mt(8,64),a=s[2]?s[2].split("").map(c=>c==="."?64:65).reverse():Mt(8,64);s=pi.exec(t),Le[i]={p1:h,p2:a},i++}}const X=new uc.NES({onFrame:Rc,onAudioSample:yc,sampleRate:Nc()});X.videoMode=!1;X.frameCounter=1;X.playbackMode=!1;const Yt={buffer:null};function Cc(){if(X.videoMode&&X.frameCounter in Le){const t=Le[X.frameCounter];X.frameCounter>0&&(X.controllers[1].state=t.p1,X.controllers[2].state=t.p2)}X.frame()}function cn(t){const e=X.ppu.toJSON(),s=X.mmap.toJSON(),i=Fe(e.vramMem),r=mc(e.nameTable),n=pc(e.ptTile);delete e.attrib,delete e.bgbuffer,delete e.buffer,delete e.pixrendered,delete e.vramMirrorTable,delete e.vramMem,delete e.nameTable,delete e.ptTile;const o=X.cpu.toJSON(),h=Fe(o.mem);return delete o.mem,{path:t,data:{cpu:o,mmap:s,ppu:e,vramMemZip:i,nameTableZip:r,cpuMemZip:h,ptTileZip:n,frameCounter:X.frameCounter}}}function Ec(t,e,s){if(s&&t.path!==s)return e({code:2,message:`Load Error: The saved data is inconsistent with the current game, saved: ${t.path}, current: ${s}.`});if(!Yt.buffer)return e({code:3,message:"Load Error: NES ROM is not loaded."});try{const{ppu:i,cpu:r,mmap:n,frameCounter:o,vramMemZip:h,nameTableZip:a,cpuMemZip:c,ptTileZip:u}=t.data;i.attrib=Mt(32,0),i.bgbuffer=Mt(61440,0),i.buffer=Mt(61440,0),i.pixrendered=Mt(61440,0),i.vramMem=xe(h),i.nameTable=_c(a),i.vramMirrorTable=fc(),i.ptTile=dc(u),r.mem=xe(c),X.ppu.reset(),X.romData=Yt.buffer,X.cpu.fromJSON(r),X.mmap.fromJSON(n),X.ppu.fromJSON(i),X.frameCounter=o}catch(i){console.error(i),e({code:3,message:"Load Error: The saved data is invalid."})}}class Ic{constructor(){mt(this,"_events"),mt(this,"_auto"),this._events={},this._auto={1:{8:{timeout:0,beDown:!1,once:!0},9:{timeout:0,beDown:!1,once:!0}},2:{8:{timeout:0,beDown:!1,once:!0},9:{timeout:0,beDown:!1,once:!0}}}}on(e,s){this._events[e]||(this._events[e]=[]),this._events[e].push(s)}emit(e,s,i){var r;(r=this._events[e])==null||r.forEach(n=>{const o=X.controllers[n.p].state;if(n.index<=7)o[n.index]=s;else{const h=this._auto[n.p][n.index];s===65?h.once&&(o[n.index-8]=65,h.timeout=window.setInterval(()=>{o[n.index-8]=h.beDown?65:64,h.beDown=!h.beDown},i),h.once=!1):(clearInterval(h.timeout),o[n.index-8]=64,h.once=!0,h.beDown=!1)}})}getState(e){return this._events[e]}init(){this._events={}}}const ys=new Ic;let ue=new AudioContext,Oe,Mi=1;const fn=512,sr=4*1024,xs=sr-1,eh=new Float32Array(sr),sh=new Float32Array(sr);let Ue=0,Ns=0;function Dc(){return Ue-Ns&xs}function yc(t,e){eh[Ue]=t,sh[Ue]=e,Ue=Ue+1&xs}function Nc(){if(!window.AudioContext)return 44100;const t=new window.AudioContext,e=t.sampleRate;return t.close(),e}function vc(){ue=new AudioContext,Oe=ue.createScriptProcessor(fn,0,2),Oe.onaudioprocess=t=>{const e=t.outputBuffer,s=e.length;Dc()<fn&&Cc();const i=e.getChannelData(0),r=e.getChannelData(1);for(let n=0;n<s;n++){const o=Ns+n&xs;i[n]=eh[o]*Mi,r[n]=sh[o]*Mi}Ns=Ns+s&xs},Oe.connect(ue.destination)}function pn(){Oe.disconnect(ue.destination),Oe.onaudioprocess=null,Oe={},"close"in ue&&ue.close()}function Tc(){ue.suspend()}function Oc(){ue.resume()}function dn(t){Mi=tr(t,0,100)/100}const gs=.3,mn={A:0,B:1,SELECT:2,START:3,UP:4,DOWN:5,LEFT:6,RIGHT:7,C:8,D:9},ih={UP:"KeyW",DOWN:"KeyS",LEFT:"KeyA",RIGHT:"KeyD",A:"KeyK",B:"KeyJ",C:"KeyI",D:"KeyU",SELECT:"Digit2",START:"Digit1"},rh={UP:"ArrowUp",DOWN:"ArrowDown",LEFT:"ArrowLeft",RIGHT:"ArrowRight",A:"Numpad2",B:"Numpad1",C:"Numpad5",D:"Numpad4",SELECT:"NumpadDecimal",START:"NumpadEnter"};let nh=1e3/(2*16);function We(t,e){ys.emit(t,e,nh)}class Pc{constructor(e){mt(this,"animationFrame"),mt(this,"axesHolding"),mt(this,"btnHolding"),mt(this,"gamepad_btns"),window.addEventListener("gamepadconnected",this.connectHandler.bind(this,!0)),window.addEventListener("gamepaddisconnected",this.connectHandler.bind(this,!1)),this.animationFrame=requestAnimationFrame(this.frame.bind(this)),this.btnHolding={p1:_s(20),p2:_s(20)},this.axesHolding={p1:_s(4),p2:_s(4)},this.gamepad_btns=e}get gamepads(){return cc(navigator.getGamepads())}connectHandler(e,s){e?this.gamepads[s.gamepad.index]=s.gamepad:this.gamepads.length===0&&this.close()}axesHandler(e,s,i,r){var n;const o=(n=this.axesHolding[e])==null?void 0:n[i];s?o||(We(this.gamepad_btns.value[e][r],65),this.axesHolding[e][i]=!0):o&&(We(this.gamepad_btns.value[e][r],64),this.axesHolding[e][i]=!1)}btnHandler(e,s,i){var r;const n=(r=this.btnHolding[e])==null?void 0:r[i];if(s.pressed){if(n)return;We(this.gamepad_btns.value[e][i],65),this.btnHolding[e][i]=!0}else n&&(We(this.gamepad_btns.value[e][i],64),this.btnHolding[e][i]=!1)}frame(){for(let e=0;e<this.gamepads.length&&!(e>1);e++){const s=`p${e+1}`,i=this.gamepads[e];i.buttons.forEach(this.btnHandler.bind(this,s));const r=i.axes[0],n=i.axes[1];this.axesHandler(s,r>gs,0,15),this.axesHandler(s,r<-gs,1,14),this.axesHandler(s,n>gs,2,13),this.axesHandler(s,n<-gs,3,12)}}run(){this.frame(),cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(this.run.bind(this))}close(){this.btnHolding.p1.fill(!1),this.btnHolding.p2.fill(!1),this.axesHolding.p1.fill(!1),this.axesHolding.p2.fill(!1),cancelAnimationFrame(this.animationFrame)}}function Mc(t){const e=St(()=>Object.assign(ih,t.p1)),s=St(()=>Object.assign(rh,t.p2));function i(){nh=1e3/(2*tr(t.turbo,5,20))}function r(){ys.init(),Wu(mn).forEach(h=>{const a=mn[h];ys.on(e.value[h],{p:1,index:a}),ys.on(s.value[h],{p:h==="SELECT"||h==="START"?1:2,index:a})})}r(),i(),Kt(()=>t.p1,r,{deep:!0}),Kt(()=>t.p2,r,{deep:!0}),Kt(()=>t.turbo,i);const n=St(()=>({p1:[e.value.A,e.value.C,e.value.B,e.value.D,"","","","",e.value.SELECT,e.value.START,"","",e.value.UP,e.value.DOWN,e.value.LEFT,e.value.RIGHT],p2:[s.value.A,s.value.C,s.value.B,s.value.D,"","","","",e.value.SELECT,e.value.START,"","",s.value.UP,s.value.DOWN,s.value.LEFT,s.value.RIGHT]})),o=new Pc(n);return Zi(()=>{o.run()}),ji(()=>{o.close()}),We}const wc=()=>Hs(),Fc=["width","height"],xc={style:{position:"absolute",top:"0",left:"0%","background-color":"#000",width:"100%",height:"100%"}},Lc={name:"NesVue"},_n=Ws({...Lc,name:"NesVue",props:{url:{},autoStart:{type:Boolean,default:!1},width:{default:"256px"},height:{default:"240px"},label:{default:"Game Start"},gain:{default:100},noClip:{type:Boolean,default:!1},storage:{type:Boolean,default:!1},debugger:{type:Boolean,default:!1},turbo:{default:16},dbName:{default:"nes-vue"},p1:{default:()=>ih},p2:{default:()=>rh}},emits:["fps","success","error","saved","loaded","update:url","removed"],setup(t,{expose:e,emit:s}){const i=t,r=s;if(!i.url)throw"nes-vue missing props: url.";const n=Mc(i),o=wc(),h=Hs(!0),a=$u(i.dbName,"save_data");let c=!1,u;function p(P){return P.message=`[nes-vue] ${P.message}`,i.debugger&&console.error(P.message),r("error",P),!1}Ch(()=>{X.ppu.clipToTvSize=!i.noClip});function d(P){n(P.code,65)}function A(P){n(P.code,64)}function v(){document.addEventListener("keydown",d),document.addEventListener("keyup",A)}function w(){document.removeEventListener("keydown",d),document.removeEventListener("keyup",A)}function k(P=i.url){if(!zs(o.value)){if(h.value?h.value=!1:(pn(),an(),clearInterval(u)),P!==i.url){Yt.buffer=null,r("update:url",P);return}Sc(o.value),new Promise((_,I)=>{function y(O){try{X.loadROM(O),u=window.setInterval(()=>{const Q=X.getFPS();r("fps",Q||0)},1e3),_("success")}catch{I({code:0,message:`${P} loading Error: Probably the ROM is unsupported.`}),h.value=!0}}if(Xu(Yt.buffer))y(Yt.buffer);else{const O=new XMLHttpRequest;O.open("GET",P),O.overrideMimeType("text/plain; charset=x-user-defined"),O.onerror=()=>{I({code:404,message:`${P} loading Error: ${O.statusText}`})},O.onload=function(){this.status===200?(Yt.buffer=this.responseText,y(Yt.buffer)):I({code:404,message:`${P} loading Error: ${O.statusText}`})},O.send()}o.value&&hn(o.value),v()}).then(()=>{vc(),r("success")},_=>(p(_),_))}}function M(){X.videoMode&&rt(),h.value||F(),c&&(c=!1),ye.init(),i.url&&k()}function F(){h.value||(pn(),an(),clearInterval(u),X.reset(),ye.init(),h.value=!0)}function V(P){return P===void 0?p({code:4,message:"TypeError: id is undefined."}):!1}function Z(P){Ec(P,p,i.url)}function ot(P){if(!V(P))try{localStorage.setItem(P,JSON.stringify(cn(i.url))),r("saved",{id:P,message:"The state has been saved in localStorage",target:"localStorage"})}catch(_){if(_.name==="QuotaExceededError")return p({code:1,message:"Save Error: localStorage out of memory."})}}function G(P){if(V(P))return;const _=localStorage.getItem(P);if(!_)return p({code:2,message:"Load Error: nothing to load."});Z(JSON.parse(_)),r("loaded",{id:P,message:"Loaded state from localStorage",target:"localStorage"})}function ut(P){if(!V(P))try{a.set_item(P,cn(i.url))}catch{p({code:1,message:"Save Error: Unable to save data to indexedDB."})}}function Rt(P){V(P)||a.get_item(P).then(_=>{Z(_)})}function zt(P){if(!V(P)){if(!X.cpu.irqRequested||h.value)return p({code:1,message:"Save Error: Can only be saved while the game is running."});i.storage?ot(P):ut(P)}}function Nt(P){if(!V(P)){if(!X.cpu.irqRequested||h.value)return p({code:2,message:"Load Error: Can only be loaded when the game is running."});i.storage?G(P):Rt(P),c&&ct()}}function Ft(P){V(P)||(i.storage?localStorage.removeItem(P):a.remove_item(P))}function xt(){a.clear()}function Jt(P,_){if(!o.value||h.value)return;const I=bc(o.value);return P&&ju(o.value,_),I}function vt(){if(Uu(Le,!1)){p({code:3,message:"FM2 Error: No fm2 scripts found."});return}M(),X.videoMode=!0,w()}async function me(P,_=0){try{const I=await(await fetch(P)).text();un(I,_)}catch(I){return p({code:4,message:"FM2 Error: Unable to load fm2 file."}),Promise.reject(I)}return vt}function rt(){X.videoMode=!1,X.controllers[1].state=Mt(8,64),X.controllers[2].state=Mt(8,64),v()}function J(P,_=0){return un(P,_),Promise.resolve(vt)}function K(P){ye.parse(P)}function Ct(P){ye.disable(P)}function Ht(){ye.init()}function Et(){c=!0,Tc()}function ct(){c=!1,Oc()}const Qt=St(()=>{const P=/^\d*$/;let _=i.width,I=i.height;return Ui(()=>{o.value&&hn(o.value)}),P.test(String(_))&&(_+="px"),P.test(String(I))&&(I+="px"),`width: ${_};height: ${I};background-color: #000;margin: auto;position: relative;overflow: hidden;`});return Kt(()=>i.url,()=>{Yt.buffer=null,M()}),Kt(()=>i.gain,()=>{dn(i.gain)}),Zi(()=>{Yt.buffer=null,i.autoStart&&k(),dn(i.gain)}),ji(()=>{w(),F()}),e({start:k,reset:M,stop:F,pause:Et,play:ct,save:zt,load:Nt,remove:Ft,clear:xt,screenshot:Jt,fm2URL:me,fm2Text:J,fm2Play:vt,fm2Stop:rt,cheatCode:K,cancelCheatCode:Ct,cancelCheatCodeAll:Ht}),(P,_)=>(ns(),Ps("div",{style:Gs(Qt.value)},[le("canvas",{ref_key:"cvs",ref:o,width:Zt(Js),height:Zt(Qs),style:{display:"inline-block"}},null,8,Fc),da(le("div",xc,null,512),[[ol,h.value]]),h.value?(ns(),Ps("div",{key:0,style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",cursor:"pointer",color:"#f8f4ed","font-size":"20px"},onClick:_[0]||(_[0]=I=>k())},Dn(P.label),1)):Xa("",!0)],4))}}),kc={id:"app"},Vc={class:"nes-container"},Bc={__name:"Test-game",setup(t){return(e,s)=>(ns(),Ps("div",kc,[le("div",Vc,[ft(Zt(_n),{url:"https://taiyuuki.github.io/nes-vue/Super Mario Bros (JU).nes"}),ft(Zt(_n),{url:"1942 (简).nes"})])]))}},Gc=[{path:"/test-game",name:"TestGame",component:Bc}],qc=Lu({history:Jl("/"),routes:Gc}),ir=Il(wl);ir.use(Tl());ir.use(qc);ir.mount("#app");
