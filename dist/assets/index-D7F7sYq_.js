(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(n){if(n.ep)return;n.ep=!0;const r=s(n);fetch(n.href,r)}})();/**
* @vue/shared v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function Hi(t,e){const s=new Set(t.split(","));return i=>s.has(i)}const nt={},Oe=[],yt=()=>{},Sh=()=>!1,Gs=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),Xi=t=>t.startsWith("onUpdate:"),lt=Object.assign,Yi=(t,e)=>{const s=t.indexOf(e);s>-1&&t.splice(s,1)},bh=Object.prototype.hasOwnProperty,j=(t,e)=>bh.call(t,e),B=Array.isArray,Pe=t=>us(t)==="[object Map]",qs=t=>us(t)==="[object Set]",gn=t=>us(t)==="[object Date]",H=t=>typeof t=="function",ht=t=>typeof t=="string",Xt=t=>typeof t=="symbol",et=t=>t!==null&&typeof t=="object",vr=t=>(et(t)||H(t))&&H(t.then)&&H(t.catch),Tr=Object.prototype.toString,us=t=>Tr.call(t),Ah=t=>us(t).slice(8,-1),Or=t=>us(t)==="[object Object]",Ui=t=>ht(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,$e=Hi(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Hs=t=>{const e=Object.create(null);return s=>e[s]||(e[s]=t(s))},Ch=/-(\w)/g,Yt=Hs(t=>t.replace(Ch,(e,s)=>s?s.toUpperCase():"")),Eh=/\B([A-Z])/g,Ge=Hs(t=>t.replace(Eh,"-$1").toLowerCase()),Xs=Hs(t=>t.charAt(0).toUpperCase()+t.slice(1)),hi=Hs(t=>t?`on${Xs(t)}`:""),me=(t,e)=>!Object.is(t,e),Cs=(t,...e)=>{for(let s=0;s<t.length;s++)t[s](...e)},Pr=(t,e,s,i=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:i,value:s})},Mr=t=>{const e=parseFloat(t);return isNaN(e)?t:e};let Rn;const wr=()=>Rn||(Rn=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Ys(t){if(B(t)){const e={};for(let s=0;s<t.length;s++){const i=t[s],n=ht(i)?Nh(i):Ys(i);if(n)for(const r in n)e[r]=n[r]}return e}else if(ht(t)||et(t))return t}const Ih=/;(?![^(]*\))/g,yh=/:([^]+)/,Dh=/\/\*[^]*?\*\//g;function Nh(t){const e={};return t.replace(Dh,"").split(Ih).forEach(s=>{if(s){const i=s.split(yh);i.length>1&&(e[i[0].trim()]=i[1].trim())}}),e}function Wi(t){let e="";if(ht(t))e=t;else if(B(t))for(let s=0;s<t.length;s++){const i=Wi(t[s]);i&&(e+=i+" ")}else if(et(t))for(const s in t)t[s]&&(e+=s+" ");return e.trim()}const vh="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Th=Hi(vh);function Fr(t){return!!t||t===""}function Oh(t,e){if(t.length!==e.length)return!1;let s=!0;for(let i=0;s&&i<t.length;i++)s=Us(t[i],e[i]);return s}function Us(t,e){if(t===e)return!0;let s=gn(t),i=gn(e);if(s||i)return s&&i?t.getTime()===e.getTime():!1;if(s=Xt(t),i=Xt(e),s||i)return t===e;if(s=B(t),i=B(e),s||i)return s&&i?Oh(t,e):!1;if(s=et(t),i=et(e),s||i){if(!s||!i)return!1;const n=Object.keys(t).length,r=Object.keys(e).length;if(n!==r)return!1;for(const o in t){const h=t.hasOwnProperty(o),a=e.hasOwnProperty(o);if(h&&!a||!h&&a||!Us(t[o],e[o]))return!1}}return String(t)===String(e)}function Ph(t,e){return t.findIndex(s=>Us(s,e))}const xr=t=>!!(t&&t.__v_isRef===!0),Ws=t=>ht(t)?t:t==null?"":B(t)||et(t)&&(t.toString===Tr||!H(t.toString))?xr(t)?Ws(t.value):JSON.stringify(t,Lr,2):String(t),Lr=(t,e)=>xr(e)?Lr(t,e.value):Pe(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((s,[i,n],r)=>(s[ai(i,r)+" =>"]=n,s),{})}:qs(e)?{[`Set(${e.size})`]:[...e.values()].map(s=>ai(s))}:Xt(e)?ai(e):et(e)&&!B(e)&&!Or(e)?String(e):e,ai=(t,e="")=>{var s;return Xt(t)?`Symbol(${(s=t.description)!=null?s:e})`:t};/**
* @vue/reactivity v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Pt;class kr{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Pt,!e&&Pt&&(this.index=(Pt.scopes||(Pt.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const s=Pt;try{return Pt=this,e()}finally{Pt=s}}}on(){Pt=this}off(){Pt=this.parent}stop(e){if(this._active){let s,i;for(s=0,i=this.effects.length;s<i;s++)this.effects[s].stop();for(s=0,i=this.cleanups.length;s<i;s++)this.cleanups[s]();if(this.scopes)for(s=0,i=this.scopes.length;s<i;s++)this.scopes[s].stop(!0);if(!this.detached&&this.parent&&!e){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0,this._active=!1}}}function Mh(t){return new kr(t)}function wh(t,e=Pt){e&&e.active&&e.effects.push(t)}function Fh(){return Pt}let Ee;class is{constructor(e,s,i,n){this.fn=e,this.trigger=s,this.scheduler=i,this.active=!0,this.deps=[],this._dirtyLevel=4,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,wh(this,n)}get dirty(){if(this._dirtyLevel===2||this._dirtyLevel===3){this._dirtyLevel=1,_e();for(let e=0;e<this._depsLength;e++){const s=this.deps[e];if(s.computed&&(xh(s.computed),this._dirtyLevel>=4))break}this._dirtyLevel===1&&(this._dirtyLevel=0),ge()}return this._dirtyLevel>=4}set dirty(e){this._dirtyLevel=e?4:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=ce,s=Ee;try{return ce=!0,Ee=this,this._runnings++,Sn(this),this.fn()}finally{bn(this),this._runnings--,Ee=s,ce=e}}stop(){this.active&&(Sn(this),bn(this),this.onStop&&this.onStop(),this.active=!1)}}function xh(t){return t.value}function Sn(t){t._trackId++,t._depsLength=0}function bn(t){if(t.deps.length>t._depsLength){for(let e=t._depsLength;e<t.deps.length;e++)Vr(t.deps[e],t);t.deps.length=t._depsLength}}function Vr(t,e){const s=t.get(e);s!==void 0&&e._trackId!==s&&(t.delete(e),t.size===0&&t.cleanup())}function Lh(t,e){t.effect instanceof is&&(t=t.effect.fn);const s=new is(t,yt,()=>{s.dirty&&s.run()});s.run();const i=s.run.bind(s);return i.effect=s,i}let ce=!0,Ai=0;const Br=[];function _e(){Br.push(ce),ce=!1}function ge(){const t=Br.pop();ce=t===void 0?!0:t}function Zi(){Ai++}function ji(){for(Ai--;!Ai&&Ci.length;)Ci.shift()()}function Gr(t,e,s){if(e.get(t)!==t._trackId){e.set(t,t._trackId);const i=t.deps[t._depsLength];i!==e?(i&&Vr(i,t),t.deps[t._depsLength++]=e):t._depsLength++}}const Ci=[];function qr(t,e,s){Zi();for(const i of t.keys()){let n;i._dirtyLevel<e&&(n??(n=t.get(i)===i._trackId))&&(i._shouldSchedule||(i._shouldSchedule=i._dirtyLevel===0),i._dirtyLevel=e),i._shouldSchedule&&(n??(n=t.get(i)===i._trackId))&&(i.trigger(),(!i._runnings||i.allowRecurse)&&i._dirtyLevel!==2&&(i._shouldSchedule=!1,i.scheduler&&Ci.push(i.scheduler)))}ji()}const Hr=(t,e)=>{const s=new Map;return s.cleanup=t,s.computed=e,s},Ei=new WeakMap,Ie=Symbol(""),Ii=Symbol("");function bt(t,e,s){if(ce&&Ee){let i=Ei.get(t);i||Ei.set(t,i=new Map);let n=i.get(s);n||i.set(s,n=Hr(()=>i.delete(s))),Gr(Ee,n)}}function $t(t,e,s,i,n,r){const o=Ei.get(t);if(!o)return;let h=[];if(e==="clear")h=[...o.values()];else if(s==="length"&&B(t)){const a=Number(i);o.forEach((u,c)=>{(c==="length"||!Xt(c)&&c>=a)&&h.push(u)})}else switch(s!==void 0&&h.push(o.get(s)),e){case"add":B(t)?Ui(s)&&h.push(o.get("length")):(h.push(o.get(Ie)),Pe(t)&&h.push(o.get(Ii)));break;case"delete":B(t)||(h.push(o.get(Ie)),Pe(t)&&h.push(o.get(Ii)));break;case"set":Pe(t)&&h.push(o.get(Ie));break}Zi();for(const a of h)a&&qr(a,4);ji()}const kh=Hi("__proto__,__v_isRef,__isVue"),Xr=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(Xt)),An=Vh();function Vh(){const t={};return["includes","indexOf","lastIndexOf"].forEach(e=>{t[e]=function(...s){const i=z(this);for(let r=0,o=this.length;r<o;r++)bt(i,"get",r+"");const n=i[e](...s);return n===-1||n===!1?i[e](...s.map(z)):n}}),["push","pop","shift","unshift","splice"].forEach(e=>{t[e]=function(...s){_e(),Zi();const i=z(this)[e].apply(this,s);return ji(),ge(),i}}),t}function Bh(t){Xt(t)||(t=String(t));const e=z(this);return bt(e,"has",t),e.hasOwnProperty(t)}class Yr{constructor(e=!1,s=!1){this._isReadonly=e,this._isShallow=s}get(e,s,i){const n=this._isReadonly,r=this._isShallow;if(s==="__v_isReactive")return!n;if(s==="__v_isReadonly")return n;if(s==="__v_isShallow")return r;if(s==="__v_raw")return i===(n?r?Jh:jr:r?Zr:Wr).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(i)?e:void 0;const o=B(e);if(!n){if(o&&j(An,s))return Reflect.get(An,s,i);if(s==="hasOwnProperty")return Bh}const h=Reflect.get(e,s,i);return(Xt(s)?Xr.has(s):kh(s))||(n||bt(e,"get",s),r)?h:At(h)?o&&Ui(s)?h:h.value:et(h)?n?Kr(h):cs(h):h}}class Ur extends Yr{constructor(e=!1){super(!1,e)}set(e,s,i,n){let r=e[s];if(!this._isShallow){const a=ns(r);if(!Ms(i)&&!ns(i)&&(r=z(r),i=z(i)),!B(e)&&At(r)&&!At(i))return a?!1:(r.value=i,!0)}const o=B(e)&&Ui(s)?Number(s)<e.length:j(e,s),h=Reflect.set(e,s,i,n);return e===z(n)&&(o?me(i,r)&&$t(e,"set",s,i):$t(e,"add",s,i)),h}deleteProperty(e,s){const i=j(e,s);e[s];const n=Reflect.deleteProperty(e,s);return n&&i&&$t(e,"delete",s,void 0),n}has(e,s){const i=Reflect.has(e,s);return(!Xt(s)||!Xr.has(s))&&bt(e,"has",s),i}ownKeys(e){return bt(e,"iterate",B(e)?"length":Ie),Reflect.ownKeys(e)}}class Gh extends Yr{constructor(e=!1){super(!0,e)}set(e,s){return!0}deleteProperty(e,s){return!0}}const qh=new Ur,Hh=new Gh,Xh=new Ur(!0);const Ki=t=>t,Zs=t=>Reflect.getPrototypeOf(t);function ps(t,e,s=!1,i=!1){t=t.__v_raw;const n=z(t),r=z(e);s||(me(e,r)&&bt(n,"get",e),bt(n,"get",r));const{has:o}=Zs(n),h=i?Ki:s?Ji:rs;if(o.call(n,e))return h(t.get(e));if(o.call(n,r))return h(t.get(r));t!==n&&t.get(e)}function ds(t,e=!1){const s=this.__v_raw,i=z(s),n=z(t);return e||(me(t,n)&&bt(i,"has",t),bt(i,"has",n)),t===n?s.has(t):s.has(t)||s.has(n)}function ms(t,e=!1){return t=t.__v_raw,!e&&bt(z(t),"iterate",Ie),Reflect.get(t,"size",t)}function Cn(t){t=z(t);const e=z(this);return Zs(e).has.call(e,t)||(e.add(t),$t(e,"add",t,t)),this}function En(t,e){e=z(e);const s=z(this),{has:i,get:n}=Zs(s);let r=i.call(s,t);r||(t=z(t),r=i.call(s,t));const o=n.call(s,t);return s.set(t,e),r?me(e,o)&&$t(s,"set",t,e):$t(s,"add",t,e),this}function In(t){const e=z(this),{has:s,get:i}=Zs(e);let n=s.call(e,t);n||(t=z(t),n=s.call(e,t)),i&&i.call(e,t);const r=e.delete(t);return n&&$t(e,"delete",t,void 0),r}function yn(){const t=z(this),e=t.size!==0,s=t.clear();return e&&$t(t,"clear",void 0,void 0),s}function _s(t,e){return function(i,n){const r=this,o=r.__v_raw,h=z(o),a=e?Ki:t?Ji:rs;return!t&&bt(h,"iterate",Ie),o.forEach((u,c)=>i.call(n,a(u),a(c),r))}}function gs(t,e,s){return function(...i){const n=this.__v_raw,r=z(n),o=Pe(r),h=t==="entries"||t===Symbol.iterator&&o,a=t==="keys"&&o,u=n[t](...i),c=s?Ki:e?Ji:rs;return!e&&bt(r,"iterate",a?Ii:Ie),{next(){const{value:p,done:d}=u.next();return d?{value:p,done:d}:{value:h?[c(p[0]),c(p[1])]:c(p),done:d}},[Symbol.iterator](){return this}}}}function ne(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function Yh(){const t={get(r){return ps(this,r)},get size(){return ms(this)},has:ds,add:Cn,set:En,delete:In,clear:yn,forEach:_s(!1,!1)},e={get(r){return ps(this,r,!1,!0)},get size(){return ms(this)},has:ds,add:Cn,set:En,delete:In,clear:yn,forEach:_s(!1,!0)},s={get(r){return ps(this,r,!0)},get size(){return ms(this,!0)},has(r){return ds.call(this,r,!0)},add:ne("add"),set:ne("set"),delete:ne("delete"),clear:ne("clear"),forEach:_s(!0,!1)},i={get(r){return ps(this,r,!0,!0)},get size(){return ms(this,!0)},has(r){return ds.call(this,r,!0)},add:ne("add"),set:ne("set"),delete:ne("delete"),clear:ne("clear"),forEach:_s(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(r=>{t[r]=gs(r,!1,!1),s[r]=gs(r,!0,!1),e[r]=gs(r,!1,!0),i[r]=gs(r,!0,!0)}),[t,s,e,i]}const[Uh,Wh,Zh,jh]=Yh();function $i(t,e){const s=e?t?jh:Zh:t?Wh:Uh;return(i,n,r)=>n==="__v_isReactive"?!t:n==="__v_isReadonly"?t:n==="__v_raw"?i:Reflect.get(j(s,n)&&n in i?s:i,n,r)}const Kh={get:$i(!1,!1)},$h={get:$i(!1,!0)},zh={get:$i(!0,!1)};const Wr=new WeakMap,Zr=new WeakMap,jr=new WeakMap,Jh=new WeakMap;function Qh(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function ta(t){return t.__v_skip||!Object.isExtensible(t)?0:Qh(Ah(t))}function cs(t){return ns(t)?t:zi(t,!1,qh,Kh,Wr)}function ea(t){return zi(t,!1,Xh,$h,Zr)}function Kr(t){return zi(t,!0,Hh,zh,jr)}function zi(t,e,s,i,n){if(!et(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const r=n.get(t);if(r)return r;const o=ta(t);if(o===0)return t;const h=new Proxy(t,o===2?i:s);return n.set(t,h),h}function ze(t){return ns(t)?ze(t.__v_raw):!!(t&&t.__v_isReactive)}function ns(t){return!!(t&&t.__v_isReadonly)}function Ms(t){return!!(t&&t.__v_isShallow)}function $r(t){return t?!!t.__v_raw:!1}function z(t){const e=t&&t.__v_raw;return e?z(e):t}function zr(t){return Object.isExtensible(t)&&Pr(t,"__v_skip",!0),t}const rs=t=>et(t)?cs(t):t,Ji=t=>et(t)?Kr(t):t;class Jr{constructor(e,s,i,n){this.getter=e,this._setter=s,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new is(()=>e(this._value),()=>Es(this,this.effect._dirtyLevel===2?2:3)),this.effect.computed=this,this.effect.active=this._cacheable=!n,this.__v_isReadonly=i}get value(){const e=z(this);return(!e._cacheable||e.effect.dirty)&&me(e._value,e._value=e.effect.run())&&Es(e,4),Qr(e),e.effect._dirtyLevel>=2&&Es(e,2),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function sa(t,e,s=!1){let i,n;const r=H(t);return r?(i=t,n=yt):(i=t.get,n=t.set),new Jr(i,n,r||!n,s)}function Qr(t){var e;ce&&Ee&&(t=z(t),Gr(Ee,(e=t.dep)!=null?e:t.dep=Hr(()=>t.dep=void 0,t instanceof Jr?t:void 0)))}function Es(t,e=4,s,i){t=z(t);const n=t.dep;n&&qr(n,e)}function At(t){return!!(t&&t.__v_isRef===!0)}function fe(t){return to(t,!1)}function ia(t){return to(t,!0)}function to(t,e){return At(t)?t:new na(t,e)}class na{constructor(e,s){this.__v_isShallow=s,this.dep=void 0,this.__v_isRef=!0,this._rawValue=s?e:z(e),this._value=s?e:rs(e)}get value(){return Qr(this),this._value}set value(e){const s=this.__v_isShallow||Ms(e)||ns(e);e=s?e:z(e),me(e,this._rawValue)&&(this._rawValue,this._rawValue=e,this._value=s?e:rs(e),Es(this,4))}}function zt(t){return At(t)?t.value:t}const ra={get:(t,e,s)=>zt(Reflect.get(t,e,s)),set:(t,e,s,i)=>{const n=t[e];return At(n)&&!At(s)?(n.value=s,!0):Reflect.set(t,e,s,i)}};function eo(t){return ze(t)?t:new Proxy(t,ra)}/**
* @vue/runtime-core v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function pe(t,e,s,i){try{return i?t(...i):t()}catch(n){js(n,e,s)}}function Lt(t,e,s,i){if(H(t)){const n=pe(t,e,s,i);return n&&vr(n)&&n.catch(r=>{js(r,e,s)}),n}if(B(t)){const n=[];for(let r=0;r<t.length;r++)n.push(Lt(t[r],e,s,i));return n}}function js(t,e,s,i=!0){const n=e?e.vnode:null;if(e){let r=e.parent;const o=e.proxy,h=`https://vuejs.org/error-reference/#runtime-${s}`;for(;r;){const u=r.ec;if(u){for(let c=0;c<u.length;c++)if(u[c](t,o,h)===!1)return}r=r.parent}const a=e.appContext.config.errorHandler;if(a){_e(),pe(a,null,10,[t,o,h]),ge();return}}oa(t,s,n,i)}function oa(t,e,s,i=!0){console.error(t)}let os=!1,yi=!1;const pt=[];let Ht=0;const Me=[];let he=null,Ce=0;const so=Promise.resolve();let Qi=null;function Ks(t){const e=Qi||so;return t?e.then(this?t.bind(this):t):e}function ha(t){let e=Ht+1,s=pt.length;for(;e<s;){const i=e+s>>>1,n=pt[i],r=hs(n);r<t||r===t&&n.pre?e=i+1:s=i}return e}function tn(t){(!pt.length||!pt.includes(t,os&&t.allowRecurse?Ht+1:Ht))&&(t.id==null?pt.push(t):pt.splice(ha(t.id),0,t),io())}function io(){!os&&!yi&&(yi=!0,Qi=so.then(ro))}function aa(t){const e=pt.indexOf(t);e>Ht&&pt.splice(e,1)}function la(t){B(t)?Me.push(...t):(!he||!he.includes(t,t.allowRecurse?Ce+1:Ce))&&Me.push(t),io()}function Dn(t,e,s=os?Ht+1:0){for(;s<pt.length;s++){const i=pt[s];if(i&&i.pre){if(t&&i.id!==t.uid)continue;pt.splice(s,1),s--,i()}}}function no(t){if(Me.length){const e=[...new Set(Me)].sort((s,i)=>hs(s)-hs(i));if(Me.length=0,he){he.push(...e);return}for(he=e,Ce=0;Ce<he.length;Ce++){const s=he[Ce];s.active!==!1&&s()}he=null,Ce=0}}const hs=t=>t.id==null?1/0:t.id,ua=(t,e)=>{const s=hs(t)-hs(e);if(s===0){if(t.pre&&!e.pre)return-1;if(e.pre&&!t.pre)return 1}return s};function ro(t){yi=!1,os=!0,pt.sort(ua);try{for(Ht=0;Ht<pt.length;Ht++){const e=pt[Ht];e&&e.active!==!1&&pe(e,null,14)}}finally{Ht=0,pt.length=0,no(),os=!1,Qi=null,(pt.length||Me.length)&&ro()}}function ca(t,e,...s){if(t.isUnmounted)return;const i=t.vnode.props||nt;let n=s;const r=e.startsWith("update:"),o=r&&e.slice(7);if(o&&o in i){const c=`${o==="modelValue"?"model":o}Modifiers`,{number:p,trim:d}=i[c]||nt;d&&(n=s.map(A=>ht(A)?A.trim():A)),p&&(n=s.map(Mr))}let h,a=i[h=hi(e)]||i[h=hi(Yt(e))];!a&&r&&(a=i[h=hi(Ge(e))]),a&&Lt(a,t,6,n);const u=i[h+"Once"];if(u){if(!t.emitted)t.emitted={};else if(t.emitted[h])return;t.emitted[h]=!0,Lt(u,t,6,n)}}function oo(t,e,s=!1){const i=e.emitsCache,n=i.get(t);if(n!==void 0)return n;const r=t.emits;let o={},h=!1;if(!H(t)){const a=u=>{const c=oo(u,e,!0);c&&(h=!0,lt(o,c))};!s&&e.mixins.length&&e.mixins.forEach(a),t.extends&&a(t.extends),t.mixins&&t.mixins.forEach(a)}return!r&&!h?(et(t)&&i.set(t,null),null):(B(r)?r.forEach(a=>o[a]=null):lt(o,r),et(t)&&i.set(t,o),o)}function $s(t,e){return!t||!Gs(e)?!1:(e=e.slice(2).replace(/Once$/,""),j(t,e[0].toLowerCase()+e.slice(1))||j(t,Ge(e))||j(t,e))}let Dt=null,ho=null;function ws(t){const e=Dt;return Dt=t,ho=t&&t.type.__scopeId||null,e}function Di(t,e=Dt,s){if(!e||t._n)return t;const i=(...n)=>{i._d&&Bn(-1);const r=ws(e);let o;try{o=t(...n)}finally{ws(r),i._d&&Bn(1)}return o};return i._n=!0,i._c=!0,i._d=!0,i}function li(t){const{type:e,vnode:s,proxy:i,withProxy:n,propsOptions:[r],slots:o,attrs:h,emit:a,render:u,renderCache:c,props:p,data:d,setupState:A,ctx:v,inheritAttrs:w}=t,k=ws(t);let M,F;try{if(s.shapeFlag&4){const Z=n||i,ot=Z;M=qt(u.call(ot,Z,c,p,A,d,v)),F=h}else{const Z=e;M=qt(Z.length>1?Z(p,{attrs:h,slots:o,emit:a}):Z(p,null)),F=e.props?h:fa(h)}}catch(Z){ts.length=0,js(Z,t,1),M=ft(ye)}let V=M;if(F&&w!==!1){const Z=Object.keys(F),{shapeFlag:ot}=V;Z.length&&ot&7&&(r&&Z.some(Xi)&&(F=pa(F,r)),V=Fe(V,F,!1,!0))}return s.dirs&&(V=Fe(V,null,!1,!0),V.dirs=V.dirs?V.dirs.concat(s.dirs):s.dirs),s.transition&&(V.transition=s.transition),M=V,ws(k),M}const fa=t=>{let e;for(const s in t)(s==="class"||s==="style"||Gs(s))&&((e||(e={}))[s]=t[s]);return e},pa=(t,e)=>{const s={};for(const i in t)(!Xi(i)||!(i.slice(9)in e))&&(s[i]=t[i]);return s};function da(t,e,s){const{props:i,children:n,component:r}=t,{props:o,children:h,patchFlag:a}=e,u=r.emitsOptions;if(e.dirs||e.transition)return!0;if(s&&a>=0){if(a&1024)return!0;if(a&16)return i?Nn(i,o,u):!!o;if(a&8){const c=e.dynamicProps;for(let p=0;p<c.length;p++){const d=c[p];if(o[d]!==i[d]&&!$s(u,d))return!0}}}else return(n||h)&&(!h||!h.$stable)?!0:i===o?!1:i?o?Nn(i,o,u):!0:!!o;return!1}function Nn(t,e,s){const i=Object.keys(e);if(i.length!==Object.keys(t).length)return!0;for(let n=0;n<i.length;n++){const r=i[n];if(e[r]!==t[r]&&!$s(s,r))return!0}return!1}function ma({vnode:t,parent:e},s){for(;e;){const i=e.subTree;if(i.suspense&&i.suspense.activeBranch===t&&(i.el=t.el),i===t)(t=e.vnode).el=s,e=e.parent;else break}}const _a="components";function vn(t,e){return Ra(_a,t,!0,e)||t}const ga=Symbol.for("v-ndc");function Ra(t,e,s=!0,i=!1){const n=Dt||dt;if(n){const r=n.type;{const h=ll(r,!1);if(h&&(h===e||h===Yt(e)||h===Xs(Yt(e))))return r}const o=Tn(n[t]||r[t],e)||Tn(n.appContext[t],e);return!o&&i?r:o}}function Tn(t,e){return t&&(t[e]||t[Yt(e)]||t[Xs(Yt(e))])}const Sa=t=>t.__isSuspense;function ba(t,e){e&&e.pendingBranch?B(t)?e.effects.push(...t):e.effects.push(t):la(t)}function zs(t,e,s=dt,i=!1){if(s){const n=s[t]||(s[t]=[]),r=e.__weh||(e.__weh=(...o)=>{_e();const h=fs(s),a=Lt(e,s,t,o);return h(),ge(),a});return i?n.unshift(r):n.push(r),r}}const te=t=>(e,s=dt)=>{(!ei||t==="sp")&&zs(t,(...i)=>e(...i),s)},Aa=te("bm"),Js=te("m"),Ca=te("bu"),Ea=te("u"),en=te("bum"),ao=te("um"),Ia=te("sp"),ya=te("rtg"),Da=te("rtc");function Na(t,e=dt){zs("ec",t,e)}function sn(t,e){if(Dt===null)return t;const s=si(Dt),i=t.dirs||(t.dirs=[]);for(let n=0;n<e.length;n++){let[r,o,h,a=nt]=e[n];r&&(H(r)&&(r={mounted:r,updated:r}),r.deep&&ue(o),i.push({dir:r,instance:s,value:o,oldValue:void 0,arg:h,modifiers:a}))}return t}function Se(t,e,s,i){const n=t.dirs,r=e&&e.dirs;for(let o=0;o<n.length;o++){const h=n[o];r&&(h.oldValue=r[o].value);let a=h.dir[i];a&&(_e(),Lt(a,s,8,[t.el,h,t,e]),ge())}}function lo(t,e,s,i){let n;const r=s;if(B(t)||ht(t)){n=new Array(t.length);for(let o=0,h=t.length;o<h;o++)n[o]=e(t[o],o,void 0,r)}else if(typeof t=="number"){n=new Array(t);for(let o=0;o<t;o++)n[o]=e(o+1,o,void 0,r)}else if(et(t))if(t[Symbol.iterator])n=Array.from(t,(o,h)=>e(o,h,void 0,r));else{const o=Object.keys(t);n=new Array(o.length);for(let h=0,a=o.length;h<a;h++){const u=o[h];n[h]=e(t[u],u,h,r)}}else n=[];return n}/*! #__NO_SIDE_EFFECTS__ */function Qs(t,e){return H(t)?lt({name:t.name},e,{setup:t}):t}const Is=t=>!!t.type.__asyncLoader,Ni=t=>t?Po(t)?si(t):Ni(t.parent):null,Je=lt(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>Ni(t.parent),$root:t=>Ni(t.root),$emit:t=>t.emit,$options:t=>nn(t),$forceUpdate:t=>t.f||(t.f=()=>{t.effect.dirty=!0,tn(t.update)}),$nextTick:t=>t.n||(t.n=Ks.bind(t.proxy)),$watch:t=>Za.bind(t)}),ui=(t,e)=>t!==nt&&!t.__isScriptSetup&&j(t,e),va={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:s,setupState:i,data:n,props:r,accessCache:o,type:h,appContext:a}=t;let u;if(e[0]!=="$"){const A=o[e];if(A!==void 0)switch(A){case 1:return i[e];case 2:return n[e];case 4:return s[e];case 3:return r[e]}else{if(ui(i,e))return o[e]=1,i[e];if(n!==nt&&j(n,e))return o[e]=2,n[e];if((u=t.propsOptions[0])&&j(u,e))return o[e]=3,r[e];if(s!==nt&&j(s,e))return o[e]=4,s[e];vi&&(o[e]=0)}}const c=Je[e];let p,d;if(c)return e==="$attrs"&&bt(t.attrs,"get",""),c(t);if((p=h.__cssModules)&&(p=p[e]))return p;if(s!==nt&&j(s,e))return o[e]=4,s[e];if(d=a.config.globalProperties,j(d,e))return d[e]},set({_:t},e,s){const{data:i,setupState:n,ctx:r}=t;return ui(n,e)?(n[e]=s,!0):i!==nt&&j(i,e)?(i[e]=s,!0):j(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(r[e]=s,!0)},has({_:{data:t,setupState:e,accessCache:s,ctx:i,appContext:n,propsOptions:r}},o){let h;return!!s[o]||t!==nt&&j(t,o)||ui(e,o)||(h=r[0])&&j(h,o)||j(i,o)||j(Je,o)||j(n.config.globalProperties,o)},defineProperty(t,e,s){return s.get!=null?t._.accessCache[e]=0:j(s,"value")&&this.set(t,e,s.value,null),Reflect.defineProperty(t,e,s)}};function On(t){return B(t)?t.reduce((e,s)=>(e[s]=null,e),{}):t}let vi=!0;function Ta(t){const e=nn(t),s=t.proxy,i=t.ctx;vi=!1,e.beforeCreate&&Pn(e.beforeCreate,t,"bc");const{data:n,computed:r,methods:o,watch:h,provide:a,inject:u,created:c,beforeMount:p,mounted:d,beforeUpdate:A,updated:v,activated:w,deactivated:k,beforeDestroy:M,beforeUnmount:F,destroyed:V,unmounted:Z,render:ot,renderTracked:G,renderTriggered:ut,errorCaptured:gt,serverPrefetch:ee,expose:Nt,inheritAttrs:kt,components:Vt,directives:se,filters:Tt}=e;if(u&&Oa(u,i,null),o)for(const J in o){const K=o[J];H(K)&&(i[J]=K.bind(s))}if(n){const J=n.call(s,s);et(J)&&(t.data=cs(J))}if(vi=!0,r)for(const J in r){const K=r[J],Ct=H(K)?K.bind(s,s):H(K.get)?K.get.bind(s,s):yt,Wt=!H(K)&&H(K.set)?K.set.bind(s):yt,Et=St({get:Ct,set:Wt});Object.defineProperty(i,J,{enumerable:!0,configurable:!0,get:()=>Et.value,set:ct=>Et.value=ct})}if(h)for(const J in h)uo(h[J],i,s,J);if(a){const J=H(a)?a.call(s):a;Reflect.ownKeys(J).forEach(K=>{ys(K,J[K])})}c&&Pn(c,t,"c");function rt(J,K){B(K)?K.forEach(Ct=>J(Ct.bind(s))):K&&J(K.bind(s))}if(rt(Aa,p),rt(Js,d),rt(Ca,A),rt(Ea,v),rt(ja,w),rt(Ka,k),rt(Na,gt),rt(Da,G),rt(ya,ut),rt(en,F),rt(ao,Z),rt(Ia,ee),B(Nt))if(Nt.length){const J=t.exposed||(t.exposed={});Nt.forEach(K=>{Object.defineProperty(J,K,{get:()=>s[K],set:Ct=>s[K]=Ct})})}else t.exposed||(t.exposed={});ot&&t.render===yt&&(t.render=ot),kt!=null&&(t.inheritAttrs=kt),Vt&&(t.components=Vt),se&&(t.directives=se)}function Oa(t,e,s=yt){B(t)&&(t=Ti(t));for(const i in t){const n=t[i];let r;et(n)?"default"in n?r=Jt(n.from||i,n.default,!0):r=Jt(n.from||i):r=Jt(n),At(r)?Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:()=>r.value,set:o=>r.value=o}):e[i]=r}}function Pn(t,e,s){Lt(B(t)?t.map(i=>i.bind(e.proxy)):t.bind(e.proxy),e,s)}function uo(t,e,s,i){const n=i.includes(".")?Io(s,i):()=>s[i];if(ht(t)){const r=e[t];H(r)&&Qt(n,r)}else if(H(t))Qt(n,t.bind(s));else if(et(t))if(B(t))t.forEach(r=>uo(r,e,s,i));else{const r=H(t.handler)?t.handler.bind(s):e[t.handler];H(r)&&Qt(n,r,t)}}function nn(t){const e=t.type,{mixins:s,extends:i}=e,{mixins:n,optionsCache:r,config:{optionMergeStrategies:o}}=t.appContext,h=r.get(e);let a;return h?a=h:!n.length&&!s&&!i?a=e:(a={},n.length&&n.forEach(u=>Fs(a,u,o,!0)),Fs(a,e,o)),et(e)&&r.set(e,a),a}function Fs(t,e,s,i=!1){const{mixins:n,extends:r}=e;r&&Fs(t,r,s,!0),n&&n.forEach(o=>Fs(t,o,s,!0));for(const o in e)if(!(i&&o==="expose")){const h=Pa[o]||s&&s[o];t[o]=h?h(t[o],e[o]):e[o]}return t}const Pa={data:Mn,props:wn,emits:wn,methods:Ze,computed:Ze,beforeCreate:_t,created:_t,beforeMount:_t,mounted:_t,beforeUpdate:_t,updated:_t,beforeDestroy:_t,beforeUnmount:_t,destroyed:_t,unmounted:_t,activated:_t,deactivated:_t,errorCaptured:_t,serverPrefetch:_t,components:Ze,directives:Ze,watch:wa,provide:Mn,inject:Ma};function Mn(t,e){return e?t?function(){return lt(H(t)?t.call(this,this):t,H(e)?e.call(this,this):e)}:e:t}function Ma(t,e){return Ze(Ti(t),Ti(e))}function Ti(t){if(B(t)){const e={};for(let s=0;s<t.length;s++)e[t[s]]=t[s];return e}return t}function _t(t,e){return t?[...new Set([].concat(t,e))]:e}function Ze(t,e){return t?lt(Object.create(null),t,e):e}function wn(t,e){return t?B(t)&&B(e)?[...new Set([...t,...e])]:lt(Object.create(null),On(t),On(e??{})):e}function wa(t,e){if(!t)return e;if(!e)return t;const s=lt(Object.create(null),t);for(const i in e)s[i]=_t(t[i],e[i]);return s}function co(){return{app:null,config:{isNativeTag:Sh,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Fa=0;function xa(t,e){return function(i,n=null){H(i)||(i=lt({},i)),n!=null&&!et(n)&&(n=null);const r=co(),o=new WeakSet;let h=!1;const a=r.app={_uid:Fa++,_component:i,_props:n,_container:null,_context:r,_instance:null,version:cl,get config(){return r.config},set config(u){},use(u,...c){return o.has(u)||(u&&H(u.install)?(o.add(u),u.install(a,...c)):H(u)&&(o.add(u),u(a,...c))),a},mixin(u){return r.mixins.includes(u)||r.mixins.push(u),a},component(u,c){return c?(r.components[u]=c,a):r.components[u]},directive(u,c){return c?(r.directives[u]=c,a):r.directives[u]},mount(u,c,p){if(!h){const d=ft(i,n);return d.appContext=r,p===!0?p="svg":p===!1&&(p=void 0),c&&e?e(d,u):t(d,u,p),h=!0,a._container=u,u.__vue_app__=a,si(d.component)}},unmount(){h&&(t(null,a._container),delete a._container.__vue_app__)},provide(u,c){return r.provides[u]=c,a},runWithContext(u){const c=Qe;Qe=a;try{return u()}finally{Qe=c}}};return a}}let Qe=null;function ys(t,e){if(dt){let s=dt.provides;const i=dt.parent&&dt.parent.provides;i===s&&(s=dt.provides=Object.create(i)),s[t]=e}}function Jt(t,e,s=!1){const i=dt||Dt;if(i||Qe){const n=i?i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides:Qe._context.provides;if(n&&t in n)return n[t];if(arguments.length>1)return s&&H(e)?e.call(i&&i.proxy):e}}const fo={},po=()=>Object.create(fo),mo=t=>Object.getPrototypeOf(t)===fo;function La(t,e,s,i=!1){const n={},r=po();t.propsDefaults=Object.create(null),_o(t,e,n,r);for(const o in t.propsOptions[0])o in n||(n[o]=void 0);s?t.props=i?n:ea(n):t.type.props?t.props=n:t.props=r,t.attrs=r}function ka(t,e,s,i){const{props:n,attrs:r,vnode:{patchFlag:o}}=t,h=z(n),[a]=t.propsOptions;let u=!1;if((i||o>0)&&!(o&16)){if(o&8){const c=t.vnode.dynamicProps;for(let p=0;p<c.length;p++){let d=c[p];if($s(t.emitsOptions,d))continue;const A=e[d];if(a)if(j(r,d))A!==r[d]&&(r[d]=A,u=!0);else{const v=Yt(d);n[v]=Oi(a,h,v,A,t,!1)}else A!==r[d]&&(r[d]=A,u=!0)}}}else{_o(t,e,n,r)&&(u=!0);let c;for(const p in h)(!e||!j(e,p)&&((c=Ge(p))===p||!j(e,c)))&&(a?s&&(s[p]!==void 0||s[c]!==void 0)&&(n[p]=Oi(a,h,p,void 0,t,!0)):delete n[p]);if(r!==h)for(const p in r)(!e||!j(e,p))&&(delete r[p],u=!0)}u&&$t(t.attrs,"set","")}function _o(t,e,s,i){const[n,r]=t.propsOptions;let o=!1,h;if(e)for(let a in e){if($e(a))continue;const u=e[a];let c;n&&j(n,c=Yt(a))?!r||!r.includes(c)?s[c]=u:(h||(h={}))[c]=u:$s(t.emitsOptions,a)||(!(a in i)||u!==i[a])&&(i[a]=u,o=!0)}if(r){const a=z(s),u=h||nt;for(let c=0;c<r.length;c++){const p=r[c];s[p]=Oi(n,a,p,u[p],t,!j(u,p))}}return o}function Oi(t,e,s,i,n,r){const o=t[s];if(o!=null){const h=j(o,"default");if(h&&i===void 0){const a=o.default;if(o.type!==Function&&!o.skipFactory&&H(a)){const{propsDefaults:u}=n;if(s in u)i=u[s];else{const c=fs(n);i=u[s]=a.call(null,e),c()}}else i=a}o[0]&&(r&&!h?i=!1:o[1]&&(i===""||i===Ge(s))&&(i=!0))}return i}function go(t,e,s=!1){const i=e.propsCache,n=i.get(t);if(n)return n;const r=t.props,o={},h=[];let a=!1;if(!H(t)){const c=p=>{a=!0;const[d,A]=go(p,e,!0);lt(o,d),A&&h.push(...A)};!s&&e.mixins.length&&e.mixins.forEach(c),t.extends&&c(t.extends),t.mixins&&t.mixins.forEach(c)}if(!r&&!a)return et(t)&&i.set(t,Oe),Oe;if(B(r))for(let c=0;c<r.length;c++){const p=Yt(r[c]);Fn(p)&&(o[p]=nt)}else if(r)for(const c in r){const p=Yt(c);if(Fn(p)){const d=r[c],A=o[p]=B(d)||H(d)?{type:d}:lt({},d);if(A){const v=kn(Boolean,A.type),w=kn(String,A.type);A[0]=v>-1,A[1]=w<0||v<w,(v>-1||j(A,"default"))&&h.push(p)}}}const u=[o,h];return et(t)&&i.set(t,u),u}function Fn(t){return t[0]!=="$"&&!$e(t)}function xn(t){return t===null?"null":typeof t=="function"?t.name||"":typeof t=="object"&&t.constructor&&t.constructor.name||""}function Ln(t,e){return xn(t)===xn(e)}function kn(t,e){return B(e)?e.findIndex(s=>Ln(s,t)):H(e)&&Ln(e,t)?0:-1}const Ro=t=>t[0]==="_"||t==="$stable",rn=t=>B(t)?t.map(qt):[qt(t)],Va=(t,e,s)=>{if(e._n)return e;const i=Di((...n)=>rn(e(...n)),s);return i._c=!1,i},So=(t,e,s)=>{const i=t._ctx;for(const n in t){if(Ro(n))continue;const r=t[n];if(H(r))e[n]=Va(n,r,i);else if(r!=null){const o=rn(r);e[n]=()=>o}}},bo=(t,e)=>{const s=rn(e);t.slots.default=()=>s},Ba=(t,e)=>{const s=t.slots=po();if(t.vnode.shapeFlag&32){const i=e._;i?(lt(s,e),Pr(s,"_",i,!0)):So(e,s)}else e&&bo(t,e)},Ga=(t,e,s)=>{const{vnode:i,slots:n}=t;let r=!0,o=nt;if(i.shapeFlag&32){const h=e._;h?s&&h===1?r=!1:(lt(n,e),!s&&h===1&&delete n._):(r=!e.$stable,So(e,n)),o=e}else e&&(bo(t,e),o={default:1});if(r)for(const h in n)!Ro(h)&&o[h]==null&&delete n[h]};function Pi(t,e,s,i,n=!1){if(B(t)){t.forEach((d,A)=>Pi(d,e&&(B(e)?e[A]:e),s,i,n));return}if(Is(i)&&!n)return;const r=i.shapeFlag&4?si(i.component):i.el,o=n?null:r,{i:h,r:a}=t,u=e&&e.r,c=h.refs===nt?h.refs={}:h.refs,p=h.setupState;if(u!=null&&u!==a&&(ht(u)?(c[u]=null,j(p,u)&&(p[u]=null)):At(u)&&(u.value=null)),H(a))pe(a,h,12,[o,c]);else{const d=ht(a),A=At(a);if(d||A){const v=()=>{if(t.f){const w=d?j(p,a)?p[a]:c[a]:a.value;n?B(w)&&Yi(w,r):B(w)?w.includes(r)||w.push(r):d?(c[a]=[r],j(p,a)&&(p[a]=c[a])):(a.value=[r],t.k&&(c[t.k]=a.value))}else d?(c[a]=o,j(p,a)&&(p[a]=o)):A&&(a.value=o,t.k&&(c[t.k]=o))};o?(v.id=-1,Rt(v,s)):v()}}}const Rt=ba;function qa(t){return Ha(t)}function Ha(t,e){const s=wr();s.__VUE__=!0;const{insert:i,remove:n,patchProp:r,createElement:o,createText:h,createComment:a,setText:u,setElementText:c,parentNode:p,nextSibling:d,setScopeId:A=yt,insertStaticContent:v}=t,w=(l,f,m,g=null,R=null,E=null,N=void 0,C=null,y=!!f.dynamicChildren)=>{if(l===f)return;l&&!Xe(l,f)&&(g=D(l),ct(l,R,E,!0),l=null),f.patchFlag===-2&&(y=!1,f.dynamicChildren=null);const{type:S,ref:T,shapeFlag:L}=f;switch(S){case ti:k(l,f,m,g);break;case ye:M(l,f,m,g);break;case fi:l==null&&F(f,m,g,N);break;case Mt:Vt(l,f,m,g,R,E,N,C,y);break;default:L&1?ot(l,f,m,g,R,E,N,C,y):L&6?se(l,f,m,g,R,E,N,C,y):(L&64||L&128)&&S.process(l,f,m,g,R,E,N,C,y,st)}T!=null&&R&&Pi(T,l&&l.ref,E,f||l,!f)},k=(l,f,m,g)=>{if(l==null)i(f.el=h(f.children),m,g);else{const R=f.el=l.el;f.children!==l.children&&u(R,f.children)}},M=(l,f,m,g)=>{l==null?i(f.el=a(f.children||""),m,g):f.el=l.el},F=(l,f,m,g)=>{[l.el,l.anchor]=v(l.children,f,m,g,l.el,l.anchor)},V=({el:l,anchor:f},m,g)=>{let R;for(;l&&l!==f;)R=d(l),i(l,m,g),l=R;i(f,m,g)},Z=({el:l,anchor:f})=>{let m;for(;l&&l!==f;)m=d(l),n(l),l=m;n(f)},ot=(l,f,m,g,R,E,N,C,y)=>{f.type==="svg"?N="svg":f.type==="math"&&(N="mathml"),l==null?G(f,m,g,R,E,N,C,y):ee(l,f,R,E,N,C,y)},G=(l,f,m,g,R,E,N,C)=>{let y,S;const{props:T,shapeFlag:L,transition:x,dirs:q}=l;if(y=l.el=o(l.type,E,T&&T.is,T),L&8?c(y,l.children):L&16&&gt(l.children,y,null,g,R,ci(l,E),N,C),q&&Se(l,null,g,"created"),ut(y,l,l.scopeId,N,g),T){for(const it in T)it!=="value"&&!$e(it)&&r(y,it,null,T[it],E,l.children,g,R,I);"value"in T&&r(y,"value",null,T.value,E),(S=T.onVnodeBeforeMount)&&Gt(S,g,l)}q&&Se(l,null,g,"beforeMount");const U=Xa(R,x);U&&x.beforeEnter(y),i(y,f,m),((S=T&&T.onVnodeMounted)||U||q)&&Rt(()=>{S&&Gt(S,g,l),U&&x.enter(y),q&&Se(l,null,g,"mounted")},R)},ut=(l,f,m,g,R)=>{if(m&&A(l,m),g)for(let E=0;E<g.length;E++)A(l,g[E]);if(R){let E=R.subTree;if(f===E){const N=R.vnode;ut(l,N,N.scopeId,N.slotScopeIds,R.parent)}}},gt=(l,f,m,g,R,E,N,C,y=0)=>{for(let S=y;S<l.length;S++){const T=l[S]=C?ae(l[S]):qt(l[S]);w(null,T,f,m,g,R,E,N,C)}},ee=(l,f,m,g,R,E,N)=>{const C=f.el=l.el;let{patchFlag:y,dynamicChildren:S,dirs:T}=f;y|=l.patchFlag&16;const L=l.props||nt,x=f.props||nt;let q;if(m&&be(m,!1),(q=x.onVnodeBeforeUpdate)&&Gt(q,m,f,l),T&&Se(f,l,m,"beforeUpdate"),m&&be(m,!0),S?Nt(l.dynamicChildren,S,C,m,g,ci(f,R),E):N||K(l,f,C,null,m,g,ci(f,R),E,!1),y>0){if(y&16)kt(C,f,L,x,m,g,R);else if(y&2&&L.class!==x.class&&r(C,"class",null,x.class,R),y&4&&r(C,"style",L.style,x.style,R),y&8){const U=f.dynamicProps;for(let it=0;it<U.length;it++){const $=U[it],at=L[$],Ot=x[$];(Ot!==at||$==="value")&&r(C,$,at,Ot,R,l.children,m,g,I)}}y&1&&l.children!==f.children&&c(C,f.children)}else!N&&S==null&&kt(C,f,L,x,m,g,R);((q=x.onVnodeUpdated)||T)&&Rt(()=>{q&&Gt(q,m,f,l),T&&Se(f,l,m,"updated")},g)},Nt=(l,f,m,g,R,E,N)=>{for(let C=0;C<f.length;C++){const y=l[C],S=f[C],T=y.el&&(y.type===Mt||!Xe(y,S)||y.shapeFlag&70)?p(y.el):m;w(y,S,T,null,g,R,E,N,!0)}},kt=(l,f,m,g,R,E,N)=>{if(m!==g){if(m!==nt)for(const C in m)!$e(C)&&!(C in g)&&r(l,C,m[C],null,N,f.children,R,E,I);for(const C in g){if($e(C))continue;const y=g[C],S=m[C];y!==S&&C!=="value"&&r(l,C,S,y,N,f.children,R,E,I)}"value"in g&&r(l,"value",m.value,g.value,N)}},Vt=(l,f,m,g,R,E,N,C,y)=>{const S=f.el=l?l.el:h(""),T=f.anchor=l?l.anchor:h("");let{patchFlag:L,dynamicChildren:x,slotScopeIds:q}=f;q&&(C=C?C.concat(q):q),l==null?(i(S,m,g),i(T,m,g),gt(f.children||[],m,T,R,E,N,C,y)):L>0&&L&64&&x&&l.dynamicChildren?(Nt(l.dynamicChildren,x,m,R,E,N,C),(f.key!=null||R&&f===R.subTree)&&Ao(l,f,!0)):K(l,f,m,T,R,E,N,C,y)},se=(l,f,m,g,R,E,N,C,y)=>{f.slotScopeIds=C,l==null?f.shapeFlag&512?R.ctx.activate(f,m,g,N,y):Tt(f,m,g,R,E,N,y):Re(l,f,y)},Tt=(l,f,m,g,R,E,N)=>{const C=l.component=nl(l,g,R);if(yo(l)&&(C.ctx.renderer=st),rl(C),C.asyncDep){if(R&&R.registerDep(C,rt,N),!l.el){const y=C.subTree=ft(ye);M(null,y,f,m)}}else rt(C,l,f,m,R,E,N)},Re=(l,f,m)=>{const g=f.component=l.component;if(da(l,f,m))if(g.asyncDep&&!g.asyncResolved){J(g,f,m);return}else g.next=f,aa(g.update),g.effect.dirty=!0,g.update();else f.el=l.el,g.vnode=f},rt=(l,f,m,g,R,E,N)=>{const C=()=>{if(l.isMounted){let{next:T,bu:L,u:x,parent:q,vnode:U}=l;{const De=Co(l);if(De){T&&(T.el=U.el,J(l,T,N)),De.asyncDep.then(()=>{l.isUnmounted||C()});return}}let it=T,$;be(l,!1),T?(T.el=U.el,J(l,T,N)):T=U,L&&Cs(L),($=T.props&&T.props.onVnodeBeforeUpdate)&&Gt($,q,T,U),be(l,!0);const at=li(l),Ot=l.subTree;l.subTree=at,w(Ot,at,p(Ot.el),D(Ot),l,R,E),T.el=at.el,it===null&&ma(l,at.el),x&&Rt(x,R),($=T.props&&T.props.onVnodeUpdated)&&Rt(()=>Gt($,q,T,U),R)}else{let T;const{el:L,props:x}=f,{bm:q,m:U,parent:it}=l,$=Is(f);if(be(l,!1),q&&Cs(q),!$&&(T=x&&x.onVnodeBeforeMount)&&Gt(T,it,f),be(l,!0),L&&Y){const at=()=>{l.subTree=li(l),Y(L,l.subTree,l,R,null)};$?f.type.__asyncLoader().then(()=>!l.isUnmounted&&at()):at()}else{const at=l.subTree=li(l);w(null,at,m,g,l,R,E),f.el=at.el}if(U&&Rt(U,R),!$&&(T=x&&x.onVnodeMounted)){const at=f;Rt(()=>Gt(T,it,at),R)}(f.shapeFlag&256||it&&Is(it.vnode)&&it.vnode.shapeFlag&256)&&l.a&&Rt(l.a,R),l.isMounted=!0,f=m=g=null}},y=l.effect=new is(C,yt,()=>tn(S),l.scope),S=l.update=()=>{y.dirty&&y.run()};S.id=l.uid,be(l,!0),S()},J=(l,f,m)=>{f.component=l;const g=l.vnode.props;l.vnode=f,l.next=null,ka(l,f.props,g,m),Ga(l,f.children,m),_e(),Dn(l),ge()},K=(l,f,m,g,R,E,N,C,y=!1)=>{const S=l&&l.children,T=l?l.shapeFlag:0,L=f.children,{patchFlag:x,shapeFlag:q}=f;if(x>0){if(x&128){Wt(S,L,m,g,R,E,N,C,y);return}else if(x&256){Ct(S,L,m,g,R,E,N,C,y);return}}q&8?(T&16&&I(S,R,E),L!==S&&c(m,L)):T&16?q&16?Wt(S,L,m,g,R,E,N,C,y):I(S,R,E,!0):(T&8&&c(m,""),q&16&&gt(L,m,g,R,E,N,C,y))},Ct=(l,f,m,g,R,E,N,C,y)=>{l=l||Oe,f=f||Oe;const S=l.length,T=f.length,L=Math.min(S,T);let x;for(x=0;x<L;x++){const q=f[x]=y?ae(f[x]):qt(f[x]);w(l[x],q,m,null,R,E,N,C,y)}S>T?I(l,R,E,!0,!1,L):gt(f,m,g,R,E,N,C,y,L)},Wt=(l,f,m,g,R,E,N,C,y)=>{let S=0;const T=f.length;let L=l.length-1,x=T-1;for(;S<=L&&S<=x;){const q=l[S],U=f[S]=y?ae(f[S]):qt(f[S]);if(Xe(q,U))w(q,U,m,null,R,E,N,C,y);else break;S++}for(;S<=L&&S<=x;){const q=l[L],U=f[x]=y?ae(f[x]):qt(f[x]);if(Xe(q,U))w(q,U,m,null,R,E,N,C,y);else break;L--,x--}if(S>L){if(S<=x){const q=x+1,U=q<T?f[q].el:g;for(;S<=x;)w(null,f[S]=y?ae(f[S]):qt(f[S]),m,U,R,E,N,C,y),S++}}else if(S>x)for(;S<=L;)ct(l[S],R,E,!0),S++;else{const q=S,U=S,it=new Map;for(S=U;S<=x;S++){const It=f[S]=y?ae(f[S]):qt(f[S]);It.key!=null&&it.set(It.key,S)}let $,at=0;const Ot=x-U+1;let De=!1,dn=0;const He=new Array(Ot);for(S=0;S<Ot;S++)He[S]=0;for(S=q;S<=L;S++){const It=l[S];if(at>=Ot){ct(It,R,E,!0);continue}let Bt;if(It.key!=null)Bt=it.get(It.key);else for($=U;$<=x;$++)if(He[$-U]===0&&Xe(It,f[$])){Bt=$;break}Bt===void 0?ct(It,R,E,!0):(He[Bt-U]=S+1,Bt>=dn?dn=Bt:De=!0,w(It,f[Bt],m,null,R,E,N,C,y),at++)}const mn=De?Ya(He):Oe;for($=mn.length-1,S=Ot-1;S>=0;S--){const It=U+S,Bt=f[It],_n=It+1<T?f[It+1].el:g;He[S]===0?w(null,Bt,m,_n,R,E,N,C,y):De&&($<0||S!==mn[$]?Et(Bt,m,_n,2):$--)}}},Et=(l,f,m,g,R=null)=>{const{el:E,type:N,transition:C,children:y,shapeFlag:S}=l;if(S&6){Et(l.component.subTree,f,m,g);return}if(S&128){l.suspense.move(f,m,g);return}if(S&64){N.move(l,f,m,st);return}if(N===Mt){i(E,f,m);for(let L=0;L<y.length;L++)Et(y[L],f,m,g);i(l.anchor,f,m);return}if(N===fi){V(l,f,m);return}if(g!==2&&S&1&&C)if(g===0)C.beforeEnter(E),i(E,f,m),Rt(()=>C.enter(E),R);else{const{leave:L,delayLeave:x,afterLeave:q}=C,U=()=>i(E,f,m),it=()=>{L(E,()=>{U(),q&&q()})};x?x(E,U,it):it()}else i(E,f,m)},ct=(l,f,m,g=!1,R=!1)=>{const{type:E,props:N,ref:C,children:y,dynamicChildren:S,shapeFlag:T,patchFlag:L,dirs:x,memoIndex:q}=l;if(L===-2&&(R=!1),C!=null&&Pi(C,null,m,l,!0),q!=null&&(f.renderCache[q]=void 0),T&256){f.ctx.deactivate(l);return}const U=T&1&&x,it=!Is(l);let $;if(it&&($=N&&N.onVnodeBeforeUnmount)&&Gt($,f,l),T&6)_(l.component,m,g);else{if(T&128){l.suspense.unmount(m,g);return}U&&Se(l,null,f,"beforeUnmount"),T&64?l.type.remove(l,f,m,st,g):S&&(E!==Mt||L>0&&L&64)?I(S,f,m,!1,!0):(E===Mt&&L&384||!R&&T&16)&&I(y,f,m),g&&ie(l)}(it&&($=N&&N.onVnodeUnmounted)||U)&&Rt(()=>{$&&Gt($,f,l),U&&Se(l,null,f,"unmounted")},m)},ie=l=>{const{type:f,el:m,anchor:g,transition:R}=l;if(f===Mt){P(m,g);return}if(f===fi){Z(l);return}const E=()=>{n(m),R&&!R.persisted&&R.afterLeave&&R.afterLeave()};if(l.shapeFlag&1&&R&&!R.persisted){const{leave:N,delayLeave:C}=R,y=()=>N(m,E);C?C(l.el,E,y):y()}else E()},P=(l,f)=>{let m;for(;l!==f;)m=d(l),n(l),l=m;n(f)},_=(l,f,m)=>{const{bum:g,scope:R,update:E,subTree:N,um:C,m:y,a:S}=l;Vn(y),Vn(S),g&&Cs(g),R.stop(),E&&(E.active=!1,ct(N,l,f,m)),C&&Rt(C,f),Rt(()=>{l.isUnmounted=!0},f),f&&f.pendingBranch&&!f.isUnmounted&&l.asyncDep&&!l.asyncResolved&&l.suspenseId===f.pendingId&&(f.deps--,f.deps===0&&f.resolve())},I=(l,f,m,g=!1,R=!1,E=0)=>{for(let N=E;N<l.length;N++)ct(l[N],f,m,g,R)},D=l=>l.shapeFlag&6?D(l.component.subTree):l.shapeFlag&128?l.suspense.next():d(l.anchor||l.el);let O=!1;const Q=(l,f,m)=>{l==null?f._vnode&&ct(f._vnode,null,null,!0):w(f._vnode||null,l,f,null,null,null,m),O||(O=!0,Dn(),no(),O=!1),f._vnode=l},st={p:w,um:ct,m:Et,r:ie,mt:Tt,mc:gt,pc:K,pbc:Nt,n:D,o:t};let W,Y;return{render:Q,hydrate:W,createApp:xa(Q,W)}}function ci({type:t,props:e},s){return s==="svg"&&t==="foreignObject"||s==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:s}function be({effect:t,update:e},s){t.allowRecurse=e.allowRecurse=s}function Xa(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function Ao(t,e,s=!1){const i=t.children,n=e.children;if(B(i)&&B(n))for(let r=0;r<i.length;r++){const o=i[r];let h=n[r];h.shapeFlag&1&&!h.dynamicChildren&&((h.patchFlag<=0||h.patchFlag===32)&&(h=n[r]=ae(n[r]),h.el=o.el),!s&&h.patchFlag!==-2&&Ao(o,h)),h.type===ti&&(h.el=o.el)}}function Ya(t){const e=t.slice(),s=[0];let i,n,r,o,h;const a=t.length;for(i=0;i<a;i++){const u=t[i];if(u!==0){if(n=s[s.length-1],t[n]<u){e[i]=n,s.push(i);continue}for(r=0,o=s.length-1;r<o;)h=r+o>>1,t[s[h]]<u?r=h+1:o=h;u<t[s[r]]&&(r>0&&(e[i]=s[r-1]),s[r]=i)}}for(r=s.length,o=s[r-1];r-- >0;)s[r]=o,o=e[o];return s}function Co(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:Co(e)}function Vn(t){if(t)for(let e=0;e<t.length;e++)t[e].active=!1}const Ua=Symbol.for("v-scx"),Wa=()=>Jt(Ua),Rs={};function Qt(t,e,s){return Eo(t,e,s)}function Eo(t,e,{immediate:s,deep:i,flush:n,once:r,onTrack:o,onTrigger:h}=nt){if(e&&r){const G=e;e=(...ut)=>{G(...ut),ot()}}const a=dt,u=G=>i===!0?G:ue(G,i===!1?1:void 0);let c,p=!1,d=!1;if(At(t)?(c=()=>t.value,p=Ms(t)):ze(t)?(c=()=>u(t),p=!0):B(t)?(d=!0,p=t.some(G=>ze(G)||Ms(G)),c=()=>t.map(G=>{if(At(G))return G.value;if(ze(G))return u(G);if(H(G))return pe(G,a,2)})):H(t)?e?c=()=>pe(t,a,2):c=()=>(A&&A(),Lt(t,a,3,[v])):c=yt,e&&i){const G=c;c=()=>ue(G())}let A,v=G=>{A=V.onStop=()=>{pe(G,a,4),A=V.onStop=void 0}},w;if(ei)if(v=yt,e?s&&Lt(e,a,3,[c(),d?[]:void 0,v]):c(),n==="sync"){const G=Wa();w=G.__watcherHandles||(G.__watcherHandles=[])}else return yt;let k=d?new Array(t.length).fill(Rs):Rs;const M=()=>{if(!(!V.active||!V.dirty))if(e){const G=V.run();(i||p||(d?G.some((ut,gt)=>me(ut,k[gt])):me(G,k)))&&(A&&A(),Lt(e,a,3,[G,k===Rs?void 0:d&&k[0]===Rs?[]:k,v]),k=G)}else V.run()};M.allowRecurse=!!e;let F;n==="sync"?F=M:n==="post"?F=()=>Rt(M,a&&a.suspense):(M.pre=!0,a&&(M.id=a.uid),F=()=>tn(M));const V=new is(c,yt,F),Z=Fh(),ot=()=>{V.stop(),Z&&Yi(Z.effects,V)};return e?s?M():k=V.run():n==="post"?Rt(V.run.bind(V),a&&a.suspense):V.run(),w&&w.push(ot),ot}function Za(t,e,s){const i=this.proxy,n=ht(t)?t.includes(".")?Io(i,t):()=>i[t]:t.bind(i,i);let r;H(e)?r=e:(r=e.handler,s=e);const o=fs(this),h=Eo(n,r.bind(i),s);return o(),h}function Io(t,e){const s=e.split(".");return()=>{let i=t;for(let n=0;n<s.length&&i;n++)i=i[s[n]];return i}}function ue(t,e=1/0,s){if(e<=0||!et(t)||t.__v_skip||(s=s||new Set,s.has(t)))return t;if(s.add(t),e--,At(t))ue(t.value,e,s);else if(B(t))for(let i=0;i<t.length;i++)ue(t[i],e,s);else if(qs(t)||Pe(t))t.forEach(i=>{ue(i,e,s)});else if(Or(t)){for(const i in t)ue(t[i],e,s);for(const i of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,i)&&ue(t[i],e,s)}return t}const yo=t=>t.type.__isKeepAlive;function ja(t,e){Do(t,"a",e)}function Ka(t,e){Do(t,"da",e)}function Do(t,e,s=dt){const i=t.__wdc||(t.__wdc=()=>{let n=s;for(;n;){if(n.isDeactivated)return;n=n.parent}return t()});if(zs(e,i,s),s){let n=s.parent;for(;n&&n.parent;)yo(n.parent.vnode)&&$a(i,e,s,n),n=n.parent}}function $a(t,e,s,i){const n=zs(e,t,i,!0);ao(()=>{Yi(i[e],n)},s)}function No(t,e){t.shapeFlag&6&&t.component?No(t.component.subTree,e):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}const za=t=>t.__isTeleport,Mt=Symbol.for("v-fgt"),ti=Symbol.for("v-txt"),ye=Symbol.for("v-cmt"),fi=Symbol.for("v-stc"),ts=[];let wt=null;function Ft(t=!1){ts.push(wt=t?null:[])}function Ja(){ts.pop(),wt=ts[ts.length-1]||null}let as=1;function Bn(t){as+=t}function vo(t){return t.dynamicChildren=as>0?wt||Oe:null,Ja(),as>0&&wt&&wt.push(t),t}function Kt(t,e,s,i,n,r){return vo(vt(t,e,s,i,n,r,!0))}function To(t,e,s,i,n){return vo(ft(t,e,s,i,n,!0))}function Mi(t){return t?t.__v_isVNode===!0:!1}function Xe(t,e){return t.type===e.type&&t.key===e.key}const Oo=({key:t})=>t??null,Ds=({ref:t,ref_key:e,ref_for:s})=>(typeof t=="number"&&(t=""+t),t!=null?ht(t)||At(t)||H(t)?{i:Dt,r:t,k:e,f:!!s}:t:null);function vt(t,e=null,s=null,i=0,n=null,r=t===Mt?0:1,o=!1,h=!1){const a={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&Oo(e),ref:e&&Ds(e),scopeId:ho,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:i,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:Dt};return h?(hn(a,s),r&128&&t.normalize(a)):s&&(a.shapeFlag|=ht(s)?8:16),as>0&&!o&&wt&&(a.patchFlag>0||r&6)&&a.patchFlag!==32&&wt.push(a),a}const ft=Qa;function Qa(t,e=null,s=null,i=0,n=null,r=!1){if((!t||t===ga)&&(t=ye),Mi(t)){const h=Fe(t,e,!0);return s&&hn(h,s),as>0&&!r&&wt&&(h.shapeFlag&6?wt[wt.indexOf(t)]=h:wt.push(h)),h.patchFlag=-2,h}if(ul(t)&&(t=t.__vccOpts),e){e=tl(e);let{class:h,style:a}=e;h&&!ht(h)&&(e.class=Wi(h)),et(a)&&($r(a)&&!B(a)&&(a=lt({},a)),e.style=Ys(a))}const o=ht(t)?1:Sa(t)?128:za(t)?64:et(t)?4:H(t)?2:0;return vt(t,e,s,i,n,o,r,!0)}function tl(t){return t?$r(t)||mo(t)?lt({},t):t:null}function Fe(t,e,s=!1,i=!1){const{props:n,ref:r,patchFlag:o,children:h,transition:a}=t,u=e?el(n||{},e):n,c={__v_isVNode:!0,__v_skip:!0,type:t.type,props:u,key:u&&Oo(u),ref:e&&e.ref?s&&r?B(r)?r.concat(Ds(e)):[r,Ds(e)]:Ds(e):r,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:h,target:t.target,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Mt?o===-1?16:o|16:o,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:a,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Fe(t.ssContent),ssFallback:t.ssFallback&&Fe(t.ssFallback),el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return a&&i&&No(c,a.clone(c)),c}function wi(t=" ",e=0){return ft(ti,null,t,e)}function on(t="",e=!1){return e?(Ft(),To(ye,null,t)):ft(ye,null,t)}function qt(t){return t==null||typeof t=="boolean"?ft(ye):B(t)?ft(Mt,null,t.slice()):typeof t=="object"?ae(t):ft(ti,null,String(t))}function ae(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Fe(t)}function hn(t,e){let s=0;const{shapeFlag:i}=t;if(e==null)e=null;else if(B(e))s=16;else if(typeof e=="object")if(i&65){const n=e.default;n&&(n._c&&(n._d=!1),hn(t,n()),n._c&&(n._d=!0));return}else{s=32;const n=e._;!n&&!mo(e)?e._ctx=Dt:n===3&&Dt&&(Dt.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else H(e)?(e={default:e,_ctx:Dt},s=32):(e=String(e),i&64?(s=16,e=[wi(e)]):s=8);t.children=e,t.shapeFlag|=s}function el(...t){const e={};for(let s=0;s<t.length;s++){const i=t[s];for(const n in i)if(n==="class")e.class!==i.class&&(e.class=Wi([e.class,i.class]));else if(n==="style")e.style=Ys([e.style,i.style]);else if(Gs(n)){const r=e[n],o=i[n];o&&r!==o&&!(B(r)&&r.includes(o))&&(e[n]=r?[].concat(r,o):o)}else n!==""&&(e[n]=i[n])}return e}function Gt(t,e,s,i=null){Lt(t,e,7,[s,i])}const sl=co();let il=0;function nl(t,e,s){const i=t.type,n=(e?e.appContext:t.appContext)||sl,r={uid:il++,vnode:t,type:i,parent:e,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,scope:new kr(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(n.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:go(i,n),emitsOptions:oo(i,n),emit:null,emitted:null,propsDefaults:nt,inheritAttrs:i.inheritAttrs,ctx:nt,data:nt,props:nt,attrs:nt,slots:nt,refs:nt,setupState:nt,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=e?e.root:r,r.emit=ca.bind(null,r),t.ce&&t.ce(r),r}let dt=null,xs,Fi;{const t=wr(),e=(s,i)=>{let n;return(n=t[s])||(n=t[s]=[]),n.push(i),r=>{n.length>1?n.forEach(o=>o(r)):n[0](r)}};xs=e("__VUE_INSTANCE_SETTERS__",s=>dt=s),Fi=e("__VUE_SSR_SETTERS__",s=>ei=s)}const fs=t=>{const e=dt;return xs(t),t.scope.on(),()=>{t.scope.off(),xs(e)}},Gn=()=>{dt&&dt.scope.off(),xs(null)};function Po(t){return t.vnode.shapeFlag&4}let ei=!1;function rl(t,e=!1){e&&Fi(e);const{props:s,children:i}=t.vnode,n=Po(t);La(t,s,n,e),Ba(t,i);const r=n?ol(t,e):void 0;return e&&Fi(!1),r}function ol(t,e){const s=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,va);const{setup:i}=s;if(i){const n=t.setupContext=i.length>1?al(t):null,r=fs(t);_e();const o=pe(i,t,0,[t.props,n]);if(ge(),r(),vr(o)){if(o.then(Gn,Gn),e)return o.then(h=>{qn(t,h,e)}).catch(h=>{js(h,t,0)});t.asyncDep=o}else qn(t,o,e)}else Mo(t,e)}function qn(t,e,s){H(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:et(e)&&(t.setupState=eo(e)),Mo(t,s)}let Hn;function Mo(t,e,s){const i=t.type;if(!t.render){if(!e&&Hn&&!i.render){const n=i.template||nn(t).template;if(n){const{isCustomElement:r,compilerOptions:o}=t.appContext.config,{delimiters:h,compilerOptions:a}=i,u=lt(lt({isCustomElement:r,delimiters:h},o),a);i.render=Hn(n,u)}}t.render=i.render||yt}{const n=fs(t);_e();try{Ta(t)}finally{ge(),n()}}}const hl={get(t,e){return bt(t,"get",""),t[e]}};function al(t){const e=s=>{t.exposed=s||{}};return{attrs:new Proxy(t.attrs,hl),slots:t.slots,emit:t.emit,expose:e}}function si(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(eo(zr(t.exposed)),{get(e,s){if(s in e)return e[s];if(s in Je)return Je[s](t)},has(e,s){return s in e||s in Je}})):t.proxy}function ll(t,e=!0){return H(t)?t.displayName||t.name:t.name||e&&t.__name}function ul(t){return H(t)&&"__vccOpts"in t}const St=(t,e)=>sa(t,e,ei);function wo(t,e,s){const i=arguments.length;return i===2?et(e)&&!B(e)?Mi(e)?ft(t,null,[e]):ft(t,e):ft(t,null,e):(i>3?s=Array.prototype.slice.call(arguments,2):i===3&&Mi(s)&&(s=[s]),ft(t,e,s))}const cl="3.4.31";/**
* @vue/runtime-dom v3.4.31
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const fl="http://www.w3.org/2000/svg",pl="http://www.w3.org/1998/Math/MathML",Zt=typeof document<"u"?document:null,Xn=Zt&&Zt.createElement("template"),dl={insert:(t,e,s)=>{e.insertBefore(t,s||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,s,i)=>{const n=e==="svg"?Zt.createElementNS(fl,t):e==="mathml"?Zt.createElementNS(pl,t):s?Zt.createElement(t,{is:s}):Zt.createElement(t);return t==="select"&&i&&i.multiple!=null&&n.setAttribute("multiple",i.multiple),n},createText:t=>Zt.createTextNode(t),createComment:t=>Zt.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>Zt.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,s,i,n,r){const o=s?s.previousSibling:e.lastChild;if(n&&(n===r||n.nextSibling))for(;e.insertBefore(n.cloneNode(!0),s),!(n===r||!(n=n.nextSibling)););else{Xn.innerHTML=i==="svg"?`<svg>${t}</svg>`:i==="mathml"?`<math>${t}</math>`:t;const h=Xn.content;if(i==="svg"||i==="mathml"){const a=h.firstChild;for(;a.firstChild;)h.appendChild(a.firstChild);h.removeChild(a)}e.insertBefore(h,s)}return[o?o.nextSibling:e.firstChild,s?s.previousSibling:e.lastChild]}},ml=Symbol("_vtc");function _l(t,e,s){const i=t[ml];i&&(e=(e?[e,...i]:[...i]).join(" ")),e==null?t.removeAttribute("class"):s?t.setAttribute("class",e):t.className=e}const Ls=Symbol("_vod"),Fo=Symbol("_vsh"),gl={beforeMount(t,{value:e},{transition:s}){t[Ls]=t.style.display==="none"?"":t.style.display,s&&e?s.beforeEnter(t):Ye(t,e)},mounted(t,{value:e},{transition:s}){s&&e&&s.enter(t)},updated(t,{value:e,oldValue:s},{transition:i}){!e!=!s&&(i?e?(i.beforeEnter(t),Ye(t,!0),i.enter(t)):i.leave(t,()=>{Ye(t,!1)}):Ye(t,e))},beforeUnmount(t,{value:e}){Ye(t,e)}};function Ye(t,e){t.style.display=e?t[Ls]:"none",t[Fo]=!e}const Rl=Symbol(""),Sl=/(^|;)\s*display\s*:/;function bl(t,e,s){const i=t.style,n=ht(s);let r=!1;if(s&&!n){if(e)if(ht(e))for(const o of e.split(";")){const h=o.slice(0,o.indexOf(":")).trim();s[h]==null&&Ns(i,h,"")}else for(const o in e)s[o]==null&&Ns(i,o,"");for(const o in s)o==="display"&&(r=!0),Ns(i,o,s[o])}else if(n){if(e!==s){const o=i[Rl];o&&(s+=";"+o),i.cssText=s,r=Sl.test(s)}}else e&&t.removeAttribute("style");Ls in t&&(t[Ls]=r?i.display:"",t[Fo]&&(i.display="none"))}const Yn=/\s*!important$/;function Ns(t,e,s){if(B(s))s.forEach(i=>Ns(t,e,i));else if(s==null&&(s=""),e.startsWith("--"))t.setProperty(e,s);else{const i=Al(t,e);Yn.test(s)?t.setProperty(Ge(i),s.replace(Yn,""),"important"):t[i]=s}}const Un=["Webkit","Moz","ms"],pi={};function Al(t,e){const s=pi[e];if(s)return s;let i=Yt(e);if(i!=="filter"&&i in t)return pi[e]=i;i=Xs(i);for(let n=0;n<Un.length;n++){const r=Un[n]+i;if(r in t)return pi[e]=r}return e}const Wn="http://www.w3.org/1999/xlink";function Zn(t,e,s,i,n,r=Th(e)){i&&e.startsWith("xlink:")?s==null?t.removeAttributeNS(Wn,e.slice(6,e.length)):t.setAttributeNS(Wn,e,s):s==null||r&&!Fr(s)?t.removeAttribute(e):t.setAttribute(e,r?"":Xt(s)?String(s):s)}function Cl(t,e,s,i,n,r,o){if(e==="innerHTML"||e==="textContent"){i&&o(i,n,r),t[e]=s??"";return}const h=t.tagName;if(e==="value"&&h!=="PROGRESS"&&!h.includes("-")){const u=h==="OPTION"?t.getAttribute("value")||"":t.value,c=s==null?"":String(s);(u!==c||!("_value"in t))&&(t.value=c),s==null&&t.removeAttribute(e),t._value=s;return}let a=!1;if(s===""||s==null){const u=typeof t[e];u==="boolean"?s=Fr(s):s==null&&u==="string"?(s="",a=!0):u==="number"&&(s=0,a=!0)}try{t[e]=s}catch{}a&&t.removeAttribute(e)}function xo(t,e,s,i){t.addEventListener(e,s,i)}function El(t,e,s,i){t.removeEventListener(e,s,i)}const jn=Symbol("_vei");function Il(t,e,s,i,n=null){const r=t[jn]||(t[jn]={}),o=r[e];if(i&&o)o.value=i;else{const[h,a]=yl(e);if(i){const u=r[e]=vl(i,n);xo(t,h,u,a)}else o&&(El(t,h,o,a),r[e]=void 0)}}const Kn=/(?:Once|Passive|Capture)$/;function yl(t){let e;if(Kn.test(t)){e={};let i;for(;i=t.match(Kn);)t=t.slice(0,t.length-i[0].length),e[i[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):Ge(t.slice(2)),e]}let di=0;const Dl=Promise.resolve(),Nl=()=>di||(Dl.then(()=>di=0),di=Date.now());function vl(t,e){const s=i=>{if(!i._vts)i._vts=Date.now();else if(i._vts<=s.attached)return;Lt(Tl(i,s.value),e,5,[i])};return s.value=t,s.attached=Nl(),s}function Tl(t,e){if(B(e)){const s=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{s.call(t),t._stopped=!0},e.map(i=>n=>!n._stopped&&i&&i(n))}else return e}const $n=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,Ol=(t,e,s,i,n,r,o,h,a)=>{const u=n==="svg";e==="class"?_l(t,i,u):e==="style"?bl(t,s,i):Gs(e)?Xi(e)||Il(t,e,s,i,o):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Pl(t,e,i,u))?(Cl(t,e,i,r,o,h,a),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&Zn(t,e,i,u,o,e!=="value")):(e==="true-value"?t._trueValue=i:e==="false-value"&&(t._falseValue=i),Zn(t,e,i,u))};function Pl(t,e,s,i){if(i)return!!(e==="innerHTML"||e==="textContent"||e in t&&$n(e)&&H(s));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const n=t.tagName;if(n==="IMG"||n==="VIDEO"||n==="CANVAS"||n==="SOURCE")return!1}return $n(e)&&ht(s)?!1:e in t}const zn=t=>{const e=t.props["onUpdate:modelValue"]||!1;return B(e)?s=>Cs(e,s):e},mi=Symbol("_assign"),Lo={deep:!0,created(t,{value:e,modifiers:{number:s}},i){const n=qs(e);xo(t,"change",()=>{const r=Array.prototype.filter.call(t.options,o=>o.selected).map(o=>s?Mr(ks(o)):ks(o));t[mi](t.multiple?n?new Set(r):r:r[0]),t._assigning=!0,Ks(()=>{t._assigning=!1})}),t[mi]=zn(i)},mounted(t,{value:e,modifiers:{number:s}}){Jn(t,e)},beforeUpdate(t,e,s){t[mi]=zn(s)},updated(t,{value:e,modifiers:{number:s}}){t._assigning||Jn(t,e)}};function Jn(t,e,s){const i=t.multiple,n=B(e);if(!(i&&!n&&!qs(e))){for(let r=0,o=t.options.length;r<o;r++){const h=t.options[r],a=ks(h);if(i)if(n){const u=typeof a;u==="string"||u==="number"?h.selected=e.some(c=>String(c)===String(a)):h.selected=Ph(e,a)>-1}else h.selected=e.has(a);else if(Us(ks(h),e)){t.selectedIndex!==r&&(t.selectedIndex=r);return}}!i&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function ks(t){return"_value"in t?t._value:t.value}const Ml=lt({patchProp:Ol},dl);let Qn;function wl(){return Qn||(Qn=qa(Ml))}const Fl=(...t)=>{const e=wl().createApp(...t),{mount:s}=e;return e.mount=i=>{const n=Ll(i);if(!n)return;const r=e._component;!H(r)&&!r.render&&!r.template&&(r.template=n.innerHTML),n.innerHTML="";const o=s(n,!1,xl(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),o},e};function xl(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function Ll(t){return ht(t)?document.querySelector(t):t}var kl=!1;/*!
 * pinia v2.1.7
 * (c) 2023 Eduardo San Martin Morote
 * @license MIT
 */const Vl=Symbol();var tr;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(tr||(tr={}));function Bl(){const t=Mh(!0),e=t.run(()=>fe({}));let s=[],i=[];const n=zr({install(r){n._a=r,r.provide(Vl,n),r.config.globalProperties.$pinia=n,i.forEach(o=>s.push(o)),i=[]},use(r){return!this._a&&!kl?i.push(r):s.push(r),this},_p:s,_a:null,_e:t,_s:new Map,state:e});return n}const Gl={id:"app"},ql=Qs({__name:"App",setup(t){return(e,s)=>{const i=vn("RouterLink"),n=vn("RouterView");return Ft(),Kt("div",Gl,[vt("header",null,[vt("nav",null,[ft(i,{to:"/test-game"},{default:Di(()=>[wi("")]),_:1}),ft(i,{to:"/test-game2"},{default:Di(()=>[wi("2")]),_:1})])]),vt("main",null,[ft(n)])])}}}),Hl=(t,e)=>{const s=t.__vccOpts||t;for(const[i,n]of e)s[i]=n;return s},Xl=Hl(ql,[["__scopeId","data-v-7b735f52"]]);/*!
  * vue-router v4.0.13
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const ko=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",qe=t=>ko?Symbol(t):"_vr_"+t,Yl=qe("rvlm"),er=qe("rvd"),an=qe("r"),Vo=qe("rl"),xi=qe("rvl"),ve=typeof window<"u";function Ul(t){return t.__esModule||ko&&t[Symbol.toStringTag]==="Module"}const tt=Object.assign;function _i(t,e){const s={};for(const i in e){const n=e[i];s[i]=Array.isArray(n)?n.map(t):t(n)}return s}const es=()=>{},Wl=/\/$/,Zl=t=>t.replace(Wl,"");function gi(t,e,s="/"){let i,n={},r="",o="";const h=e.indexOf("?"),a=e.indexOf("#",h>-1?h:0);return h>-1&&(i=e.slice(0,h),r=e.slice(h+1,a>-1?a:e.length),n=t(r)),a>-1&&(i=i||e.slice(0,a),o=e.slice(a,e.length)),i=zl(i??e,s),{fullPath:i+(r&&"?")+r+o,path:i,query:n,hash:o}}function jl(t,e){const s=e.query?t(e.query):"";return e.path+(s&&"?")+s+(e.hash||"")}function sr(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function Kl(t,e,s){const i=e.matched.length-1,n=s.matched.length-1;return i>-1&&i===n&&xe(e.matched[i],s.matched[n])&&Bo(e.params,s.params)&&t(e.query)===t(s.query)&&e.hash===s.hash}function xe(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function Bo(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const s in t)if(!$l(t[s],e[s]))return!1;return!0}function $l(t,e){return Array.isArray(t)?ir(t,e):Array.isArray(e)?ir(e,t):t===e}function ir(t,e){return Array.isArray(e)?t.length===e.length&&t.every((s,i)=>s===e[i]):t.length===1&&t[0]===e}function zl(t,e){if(t.startsWith("/"))return t;if(!t)return e;const s=e.split("/"),i=t.split("/");let n=s.length-1,r,o;for(r=0;r<i.length;r++)if(o=i[r],!(n===1||o==="."))if(o==="..")n--;else break;return s.slice(0,n).join("/")+"/"+i.slice(r-(r===i.length?1:0)).join("/")}var ls;(function(t){t.pop="pop",t.push="push"})(ls||(ls={}));var ss;(function(t){t.back="back",t.forward="forward",t.unknown=""})(ss||(ss={}));function Jl(t){if(!t)if(ve){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),Zl(t)}const Ql=/^[^#]+#/;function tu(t,e){return t.replace(Ql,"#")+e}function eu(t,e){const s=document.documentElement.getBoundingClientRect(),i=t.getBoundingClientRect();return{behavior:e.behavior,left:i.left-s.left-(e.left||0),top:i.top-s.top-(e.top||0)}}const ii=()=>({left:window.pageXOffset,top:window.pageYOffset});function su(t){let e;if("el"in t){const s=t.el,i=typeof s=="string"&&s.startsWith("#"),n=typeof s=="string"?i?document.getElementById(s.slice(1)):document.querySelector(s):s;if(!n)return;e=eu(n,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.pageXOffset,e.top!=null?e.top:window.pageYOffset)}function nr(t,e){return(history.state?history.state.position-e:-1)+t}const Li=new Map;function iu(t,e){Li.set(t,e)}function nu(t){const e=Li.get(t);return Li.delete(t),e}let ru=()=>location.protocol+"//"+location.host;function Go(t,e){const{pathname:s,search:i,hash:n}=e,r=t.indexOf("#");if(r>-1){let h=n.includes(t.slice(r))?t.slice(r).length:1,a=n.slice(h);return a[0]!=="/"&&(a="/"+a),sr(a,"")}return sr(s,t)+i+n}function ou(t,e,s,i){let n=[],r=[],o=null;const h=({state:d})=>{const A=Go(t,location),v=s.value,w=e.value;let k=0;if(d){if(s.value=A,e.value=d,o&&o===v){o=null;return}k=w?d.position-w.position:0}else i(A);n.forEach(M=>{M(s.value,v,{delta:k,type:ls.pop,direction:k?k>0?ss.forward:ss.back:ss.unknown})})};function a(){o=s.value}function u(d){n.push(d);const A=()=>{const v=n.indexOf(d);v>-1&&n.splice(v,1)};return r.push(A),A}function c(){const{history:d}=window;d.state&&d.replaceState(tt({},d.state,{scroll:ii()}),"")}function p(){for(const d of r)d();r=[],window.removeEventListener("popstate",h),window.removeEventListener("beforeunload",c)}return window.addEventListener("popstate",h),window.addEventListener("beforeunload",c),{pauseListeners:a,listen:u,destroy:p}}function rr(t,e,s,i=!1,n=!1){return{back:t,current:e,forward:s,replaced:i,position:window.history.length,scroll:n?ii():null}}function hu(t){const{history:e,location:s}=window,i={value:Go(t,s)},n={value:e.state};n.value||r(i.value,{back:null,current:i.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function r(a,u,c){const p=t.indexOf("#"),d=p>-1?(s.host&&document.querySelector("base")?t:t.slice(p))+a:ru()+t+a;try{e[c?"replaceState":"pushState"](u,"",d),n.value=u}catch(A){console.error(A),s[c?"replace":"assign"](d)}}function o(a,u){const c=tt({},e.state,rr(n.value.back,a,n.value.forward,!0),u,{position:n.value.position});r(a,c,!0),i.value=a}function h(a,u){const c=tt({},n.value,e.state,{forward:a,scroll:ii()});r(c.current,c,!0);const p=tt({},rr(i.value,a,null),{position:c.position+1},u);r(a,p,!1),i.value=a}return{location:i,state:n,push:h,replace:o}}function au(t){t=Jl(t);const e=hu(t),s=ou(t,e.state,e.location,e.replace);function i(r,o=!0){o||s.pauseListeners(),history.go(r)}const n=tt({location:"",base:t,go:i,createHref:tu.bind(null,t)},e,s);return Object.defineProperty(n,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(n,"state",{enumerable:!0,get:()=>e.state.value}),n}function lu(t){return typeof t=="string"||t&&typeof t=="object"}function qo(t){return typeof t=="string"||typeof t=="symbol"}const re={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Ho=qe("nf");var or;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(or||(or={}));function Le(t,e){return tt(new Error,{type:t,[Ho]:!0},e)}function oe(t,e){return t instanceof Error&&Ho in t&&(e==null||!!(t.type&e))}const hr="[^/]+?",uu={sensitive:!1,strict:!1,start:!0,end:!0},cu=/[.+*?^${}()[\]/\\]/g;function fu(t,e){const s=tt({},uu,e),i=[];let n=s.start?"^":"";const r=[];for(const u of t){const c=u.length?[]:[90];s.strict&&!u.length&&(n+="/");for(let p=0;p<u.length;p++){const d=u[p];let A=40+(s.sensitive?.25:0);if(d.type===0)p||(n+="/"),n+=d.value.replace(cu,"\\$&"),A+=40;else if(d.type===1){const{value:v,repeatable:w,optional:k,regexp:M}=d;r.push({name:v,repeatable:w,optional:k});const F=M||hr;if(F!==hr){A+=10;try{new RegExp(`(${F})`)}catch(Z){throw new Error(`Invalid custom RegExp for param "${v}" (${F}): `+Z.message)}}let V=w?`((?:${F})(?:/(?:${F}))*)`:`(${F})`;p||(V=k&&u.length<2?`(?:/${V})`:"/"+V),k&&(V+="?"),n+=V,A+=20,k&&(A+=-8),w&&(A+=-20),F===".*"&&(A+=-50)}c.push(A)}i.push(c)}if(s.strict&&s.end){const u=i.length-1;i[u][i[u].length-1]+=.7000000000000001}s.strict||(n+="/?"),s.end?n+="$":s.strict&&(n+="(?:/|$)");const o=new RegExp(n,s.sensitive?"":"i");function h(u){const c=u.match(o),p={};if(!c)return null;for(let d=1;d<c.length;d++){const A=c[d]||"",v=r[d-1];p[v.name]=A&&v.repeatable?A.split("/"):A}return p}function a(u){let c="",p=!1;for(const d of t){(!p||!c.endsWith("/"))&&(c+="/"),p=!1;for(const A of d)if(A.type===0)c+=A.value;else if(A.type===1){const{value:v,repeatable:w,optional:k}=A,M=v in u?u[v]:"";if(Array.isArray(M)&&!w)throw new Error(`Provided param "${v}" is an array but it is not repeatable (* or + modifiers)`);const F=Array.isArray(M)?M.join("/"):M;if(!F)if(k)d.length<2&&(c.endsWith("/")?c=c.slice(0,-1):p=!0);else throw new Error(`Missing required param "${v}"`);c+=F}}return c}return{re:o,score:i,keys:r,parse:h,stringify:a}}function pu(t,e){let s=0;for(;s<t.length&&s<e.length;){const i=e[s]-t[s];if(i)return i;s++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function du(t,e){let s=0;const i=t.score,n=e.score;for(;s<i.length&&s<n.length;){const r=pu(i[s],n[s]);if(r)return r;s++}return n.length-i.length}const mu={type:0,value:""},_u=/[a-zA-Z0-9_]/;function gu(t){if(!t)return[[]];if(t==="/")return[[mu]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(A){throw new Error(`ERR (${s})/"${u}": ${A}`)}let s=0,i=s;const n=[];let r;function o(){r&&n.push(r),r=[]}let h=0,a,u="",c="";function p(){u&&(s===0?r.push({type:0,value:u}):s===1||s===2||s===3?(r.length>1&&(a==="*"||a==="+")&&e(`A repeatable param (${u}) must be alone in its segment. eg: '/:ids+.`),r.push({type:1,value:u,regexp:c,repeatable:a==="*"||a==="+",optional:a==="*"||a==="?"})):e("Invalid state to consume buffer"),u="")}function d(){u+=a}for(;h<t.length;){if(a=t[h++],a==="\\"&&s!==2){i=s,s=4;continue}switch(s){case 0:a==="/"?(u&&p(),o()):a===":"?(p(),s=1):d();break;case 4:d(),s=i;break;case 1:a==="("?s=2:_u.test(a)?d():(p(),s=0,a!=="*"&&a!=="?"&&a!=="+"&&h--);break;case 2:a===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+a:s=3:c+=a;break;case 3:p(),s=0,a!=="*"&&a!=="?"&&a!=="+"&&h--,c="";break;default:e("Unknown state");break}}return s===2&&e(`Unfinished custom RegExp for param "${u}"`),p(),o(),n}function Ru(t,e,s){const i=fu(gu(t.path),s),n=tt(i,{record:t,parent:e,children:[],alias:[]});return e&&!n.record.aliasOf==!e.record.aliasOf&&e.children.push(n),n}function Su(t,e){const s=[],i=new Map;e=lr({strict:!1,end:!0,sensitive:!1},e);function n(c){return i.get(c)}function r(c,p,d){const A=!d,v=Au(c);v.aliasOf=d&&d.record;const w=lr(e,c),k=[v];if("alias"in c){const V=typeof c.alias=="string"?[c.alias]:c.alias;for(const Z of V)k.push(tt({},v,{components:d?d.record.components:v.components,path:Z,aliasOf:d?d.record:v}))}let M,F;for(const V of k){const{path:Z}=V;if(p&&Z[0]!=="/"){const ot=p.record.path,G=ot[ot.length-1]==="/"?"":"/";V.path=p.record.path+(Z&&G+Z)}if(M=Ru(V,p,w),d?d.alias.push(M):(F=F||M,F!==M&&F.alias.push(M),A&&c.name&&!ar(M)&&o(c.name)),"children"in v){const ot=v.children;for(let G=0;G<ot.length;G++)r(ot[G],M,d&&d.children[G])}d=d||M,a(M)}return F?()=>{o(F)}:es}function o(c){if(qo(c)){const p=i.get(c);p&&(i.delete(c),s.splice(s.indexOf(p),1),p.children.forEach(o),p.alias.forEach(o))}else{const p=s.indexOf(c);p>-1&&(s.splice(p,1),c.record.name&&i.delete(c.record.name),c.children.forEach(o),c.alias.forEach(o))}}function h(){return s}function a(c){let p=0;for(;p<s.length&&du(c,s[p])>=0&&(c.record.path!==s[p].record.path||!Xo(c,s[p]));)p++;s.splice(p,0,c),c.record.name&&!ar(c)&&i.set(c.record.name,c)}function u(c,p){let d,A={},v,w;if("name"in c&&c.name){if(d=i.get(c.name),!d)throw Le(1,{location:c});w=d.record.name,A=tt(bu(p.params,d.keys.filter(F=>!F.optional).map(F=>F.name)),c.params),v=d.stringify(A)}else if("path"in c)v=c.path,d=s.find(F=>F.re.test(v)),d&&(A=d.parse(v),w=d.record.name);else{if(d=p.name?i.get(p.name):s.find(F=>F.re.test(p.path)),!d)throw Le(1,{location:c,currentLocation:p});w=d.record.name,A=tt({},p.params,c.params),v=d.stringify(A)}const k=[];let M=d;for(;M;)k.unshift(M.record),M=M.parent;return{name:w,path:v,params:A,matched:k,meta:Eu(k)}}return t.forEach(c=>r(c)),{addRoute:r,resolve:u,removeRoute:o,getRoutes:h,getRecordMatcher:n}}function bu(t,e){const s={};for(const i of e)i in t&&(s[i]=t[i]);return s}function Au(t){return{path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:void 0,beforeEnter:t.beforeEnter,props:Cu(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||{}:{default:t.component}}}function Cu(t){const e={},s=t.props||!1;if("component"in t)e.default=s;else for(const i in t.components)e[i]=typeof s=="boolean"?s:s[i];return e}function ar(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function Eu(t){return t.reduce((e,s)=>tt(e,s.meta),{})}function lr(t,e){const s={};for(const i in t)s[i]=i in e?e[i]:t[i];return s}function Xo(t,e){return e.children.some(s=>s===t||Xo(t,s))}const Yo=/#/g,Iu=/&/g,yu=/\//g,Du=/=/g,Nu=/\?/g,Uo=/\+/g,vu=/%5B/g,Tu=/%5D/g,Wo=/%5E/g,Ou=/%60/g,Zo=/%7B/g,Pu=/%7C/g,jo=/%7D/g,Mu=/%20/g;function ln(t){return encodeURI(""+t).replace(Pu,"|").replace(vu,"[").replace(Tu,"]")}function wu(t){return ln(t).replace(Zo,"{").replace(jo,"}").replace(Wo,"^")}function ki(t){return ln(t).replace(Uo,"%2B").replace(Mu,"+").replace(Yo,"%23").replace(Iu,"%26").replace(Ou,"`").replace(Zo,"{").replace(jo,"}").replace(Wo,"^")}function Fu(t){return ki(t).replace(Du,"%3D")}function xu(t){return ln(t).replace(Yo,"%23").replace(Nu,"%3F")}function Lu(t){return t==null?"":xu(t).replace(yu,"%2F")}function Vs(t){try{return decodeURIComponent(""+t)}catch{}return""+t}function ku(t){const e={};if(t===""||t==="?")return e;const i=(t[0]==="?"?t.slice(1):t).split("&");for(let n=0;n<i.length;++n){const r=i[n].replace(Uo," "),o=r.indexOf("="),h=Vs(o<0?r:r.slice(0,o)),a=o<0?null:Vs(r.slice(o+1));if(h in e){let u=e[h];Array.isArray(u)||(u=e[h]=[u]),u.push(a)}else e[h]=a}return e}function ur(t){let e="";for(let s in t){const i=t[s];if(s=Fu(s),i==null){i!==void 0&&(e+=(e.length?"&":"")+s);continue}(Array.isArray(i)?i.map(r=>r&&ki(r)):[i&&ki(i)]).forEach(r=>{r!==void 0&&(e+=(e.length?"&":"")+s,r!=null&&(e+="="+r))})}return e}function Vu(t){const e={};for(const s in t){const i=t[s];i!==void 0&&(e[s]=Array.isArray(i)?i.map(n=>n==null?null:""+n):i==null?i:""+i)}return e}function Ue(){let t=[];function e(i){return t.push(i),()=>{const n=t.indexOf(i);n>-1&&t.splice(n,1)}}function s(){t=[]}return{add:e,list:()=>t,reset:s}}function le(t,e,s,i,n){const r=i&&(i.enterCallbacks[n]=i.enterCallbacks[n]||[]);return()=>new Promise((o,h)=>{const a=p=>{p===!1?h(Le(4,{from:s,to:e})):p instanceof Error?h(p):lu(p)?h(Le(2,{from:e,to:p})):(r&&i.enterCallbacks[n]===r&&typeof p=="function"&&r.push(p),o())},u=t.call(i&&i.instances[n],e,s,a);let c=Promise.resolve(u);t.length<3&&(c=c.then(a)),c.catch(p=>h(p))})}function Ri(t,e,s,i){const n=[];for(const r of t)for(const o in r.components){let h=r.components[o];if(!(e!=="beforeRouteEnter"&&!r.instances[o]))if(Bu(h)){const u=(h.__vccOpts||h)[e];u&&n.push(le(u,s,i,r,o))}else{let a=h();n.push(()=>a.then(u=>{if(!u)return Promise.reject(new Error(`Couldn't resolve component "${o}" at "${r.path}"`));const c=Ul(u)?u.default:u;r.components[o]=c;const d=(c.__vccOpts||c)[e];return d&&le(d,s,i,r,o)()}))}}return n}function Bu(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function cr(t){const e=Jt(an),s=Jt(Vo),i=St(()=>e.resolve(zt(t.to))),n=St(()=>{const{matched:a}=i.value,{length:u}=a,c=a[u-1],p=s.matched;if(!c||!p.length)return-1;const d=p.findIndex(xe.bind(null,c));if(d>-1)return d;const A=fr(a[u-2]);return u>1&&fr(c)===A&&p[p.length-1].path!==A?p.findIndex(xe.bind(null,a[u-2])):d}),r=St(()=>n.value>-1&&Xu(s.params,i.value.params)),o=St(()=>n.value>-1&&n.value===s.matched.length-1&&Bo(s.params,i.value.params));function h(a={}){return Hu(a)?e[zt(t.replace)?"replace":"push"](zt(t.to)).catch(es):Promise.resolve()}return{route:i,href:St(()=>i.value.href),isActive:r,isExactActive:o,navigate:h}}const Gu=Qs({name:"RouterLink",props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:cr,setup(t,{slots:e}){const s=cs(cr(t)),{options:i}=Jt(an),n=St(()=>({[pr(t.activeClass,i.linkActiveClass,"router-link-active")]:s.isActive,[pr(t.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:s.isExactActive}));return()=>{const r=e.default&&e.default(s);return t.custom?r:wo("a",{"aria-current":s.isExactActive?t.ariaCurrentValue:null,href:s.href,onClick:s.navigate,class:n.value},r)}}}),qu=Gu;function Hu(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function Xu(t,e){for(const s in e){const i=e[s],n=t[s];if(typeof i=="string"){if(i!==n)return!1}else if(!Array.isArray(n)||n.length!==i.length||i.some((r,o)=>r!==n[o]))return!1}return!0}function fr(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const pr=(t,e,s)=>t??e??s,Yu=Qs({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},setup(t,{attrs:e,slots:s}){const i=Jt(xi),n=St(()=>t.route||i.value),r=Jt(er,0),o=St(()=>n.value.matched[r]);ys(er,r+1),ys(Yl,o),ys(xi,n);const h=fe();return Qt(()=>[h.value,o.value,t.name],([a,u,c],[p,d,A])=>{u&&(u.instances[c]=a,d&&d!==u&&a&&a===p&&(u.leaveGuards.size||(u.leaveGuards=d.leaveGuards),u.updateGuards.size||(u.updateGuards=d.updateGuards))),a&&u&&(!d||!xe(u,d)||!p)&&(u.enterCallbacks[c]||[]).forEach(v=>v(a))},{flush:"post"}),()=>{const a=n.value,u=o.value,c=u&&u.components[t.name],p=t.name;if(!c)return dr(s.default,{Component:c,route:a});const d=u.props[t.name],A=d?d===!0?a.params:typeof d=="function"?d(a):d:null,w=wo(c,tt({},A,e,{onVnodeUnmounted:k=>{k.component.isUnmounted&&(u.instances[p]=null)},ref:h}));return dr(s.default,{Component:w,route:a})||w}}});function dr(t,e){if(!t)return null;const s=t(e);return s.length===1?s[0]:s}const Uu=Yu;function Wu(t){const e=Su(t.routes,t),s=t.parseQuery||ku,i=t.stringifyQuery||ur,n=t.history,r=Ue(),o=Ue(),h=Ue(),a=ia(re);let u=re;ve&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=_i.bind(null,_=>""+_),p=_i.bind(null,Lu),d=_i.bind(null,Vs);function A(_,I){let D,O;return qo(_)?(D=e.getRecordMatcher(_),O=I):O=_,e.addRoute(O,D)}function v(_){const I=e.getRecordMatcher(_);I&&e.removeRoute(I)}function w(){return e.getRoutes().map(_=>_.record)}function k(_){return!!e.getRecordMatcher(_)}function M(_,I){if(I=tt({},I||a.value),typeof _=="string"){const Y=gi(s,_,I.path),l=e.resolve({path:Y.path},I),f=n.createHref(Y.fullPath);return tt(Y,l,{params:d(l.params),hash:Vs(Y.hash),redirectedFrom:void 0,href:f})}let D;if("path"in _)D=tt({},_,{path:gi(s,_.path,I.path).path});else{const Y=tt({},_.params);for(const l in Y)Y[l]==null&&delete Y[l];D=tt({},_,{params:p(_.params)}),I.params=p(I.params)}const O=e.resolve(D,I),Q=_.hash||"";O.params=c(d(O.params));const st=jl(i,tt({},_,{hash:wu(Q),path:O.path})),W=n.createHref(st);return tt({fullPath:st,hash:Q,query:i===ur?Vu(_.query):_.query||{}},O,{redirectedFrom:void 0,href:W})}function F(_){return typeof _=="string"?gi(s,_,a.value.path):tt({},_)}function V(_,I){if(u!==_)return Le(8,{from:I,to:_})}function Z(_){return ut(_)}function ot(_){return Z(tt(F(_),{replace:!0}))}function G(_){const I=_.matched[_.matched.length-1];if(I&&I.redirect){const{redirect:D}=I;let O=typeof D=="function"?D(_):D;return typeof O=="string"&&(O=O.includes("?")||O.includes("#")?O=F(O):{path:O},O.params={}),tt({query:_.query,hash:_.hash,params:_.params},O)}}function ut(_,I){const D=u=M(_),O=a.value,Q=_.state,st=_.force,W=_.replace===!0,Y=G(D);if(Y)return ut(tt(F(Y),{state:Q,force:st,replace:W}),I||D);const l=D;l.redirectedFrom=I;let f;return!st&&Kl(i,O,D)&&(f=Le(16,{to:l,from:O}),Wt(O,O,!0,!1)),(f?Promise.resolve(f):ee(l,O)).catch(m=>oe(m)?oe(m,2)?m:Ct(m):J(m,l,O)).then(m=>{if(m){if(oe(m,2))return ut(tt(F(m.to),{state:Q,force:st,replace:W}),I||l)}else m=kt(l,O,!0,W,Q);return Nt(l,O,m),m})}function gt(_,I){const D=V(_,I);return D?Promise.reject(D):Promise.resolve()}function ee(_,I){let D;const[O,Q,st]=Zu(_,I);D=Ri(O.reverse(),"beforeRouteLeave",_,I);for(const Y of O)Y.leaveGuards.forEach(l=>{D.push(le(l,_,I))});const W=gt.bind(null,_,I);return D.push(W),Ne(D).then(()=>{D=[];for(const Y of r.list())D.push(le(Y,_,I));return D.push(W),Ne(D)}).then(()=>{D=Ri(Q,"beforeRouteUpdate",_,I);for(const Y of Q)Y.updateGuards.forEach(l=>{D.push(le(l,_,I))});return D.push(W),Ne(D)}).then(()=>{D=[];for(const Y of _.matched)if(Y.beforeEnter&&!I.matched.includes(Y))if(Array.isArray(Y.beforeEnter))for(const l of Y.beforeEnter)D.push(le(l,_,I));else D.push(le(Y.beforeEnter,_,I));return D.push(W),Ne(D)}).then(()=>(_.matched.forEach(Y=>Y.enterCallbacks={}),D=Ri(st,"beforeRouteEnter",_,I),D.push(W),Ne(D))).then(()=>{D=[];for(const Y of o.list())D.push(le(Y,_,I));return D.push(W),Ne(D)}).catch(Y=>oe(Y,8)?Y:Promise.reject(Y))}function Nt(_,I,D){for(const O of h.list())O(_,I,D)}function kt(_,I,D,O,Q){const st=V(_,I);if(st)return st;const W=I===re,Y=ve?history.state:{};D&&(O||W?n.replace(_.fullPath,tt({scroll:W&&Y&&Y.scroll},Q)):n.push(_.fullPath,Q)),a.value=_,Wt(_,I,D,W),Ct()}let Vt;function se(){Vt=n.listen((_,I,D)=>{const O=M(_),Q=G(O);if(Q){ut(tt(Q,{replace:!0}),O).catch(es);return}u=O;const st=a.value;ve&&iu(nr(st.fullPath,D.delta),ii()),ee(O,st).catch(W=>oe(W,12)?W:oe(W,2)?(ut(W.to,O).then(Y=>{oe(Y,20)&&!D.delta&&D.type===ls.pop&&n.go(-1,!1)}).catch(es),Promise.reject()):(D.delta&&n.go(-D.delta,!1),J(W,O,st))).then(W=>{W=W||kt(O,st,!1),W&&(D.delta?n.go(-D.delta,!1):D.type===ls.pop&&oe(W,20)&&n.go(-1,!1)),Nt(O,st,W)}).catch(es)})}let Tt=Ue(),Re=Ue(),rt;function J(_,I,D){Ct(_);const O=Re.list();return O.length?O.forEach(Q=>Q(_,I,D)):console.error(_),Promise.reject(_)}function K(){return rt&&a.value!==re?Promise.resolve():new Promise((_,I)=>{Tt.add([_,I])})}function Ct(_){return rt||(rt=!_,se(),Tt.list().forEach(([I,D])=>_?D(_):I()),Tt.reset()),_}function Wt(_,I,D,O){const{scrollBehavior:Q}=t;if(!ve||!Q)return Promise.resolve();const st=!D&&nu(nr(_.fullPath,0))||(O||!D)&&history.state&&history.state.scroll||null;return Ks().then(()=>Q(_,I,st)).then(W=>W&&su(W)).catch(W=>J(W,_,I))}const Et=_=>n.go(_);let ct;const ie=new Set;return{currentRoute:a,addRoute:A,removeRoute:v,hasRoute:k,getRoutes:w,resolve:M,options:t,push:Z,replace:ot,go:Et,back:()=>Et(-1),forward:()=>Et(1),beforeEach:r.add,beforeResolve:o.add,afterEach:h.add,onError:Re.add,isReady:K,install(_){const I=this;_.component("RouterLink",qu),_.component("RouterView",Uu),_.config.globalProperties.$router=I,Object.defineProperty(_.config.globalProperties,"$route",{enumerable:!0,get:()=>zt(a)}),ve&&!ct&&a.value===re&&(ct=!0,Z(n.location).catch(Q=>{}));const D={};for(const Q in re)D[Q]=St(()=>a.value[Q]);_.provide(an,I),_.provide(Vo,cs(D)),_.provide(xi,a);const O=_.unmount;ie.add(_),_.unmount=function(){ie.delete(_),ie.size<1&&(u=re,Vt&&Vt(),a.value=re,ct=!1,rt=!1),O()}}}}function Ne(t){return t.reduce((e,s)=>e.then(()=>s()),Promise.resolve())}function Zu(t,e){const s=[],i=[],n=[],r=Math.max(e.matched.length,t.matched.length);for(let o=0;o<r;o++){const h=e.matched[o];h&&(t.matched.find(u=>xe(u,h))?i.push(h):s.push(h));const a=t.matched[o];a&&(e.matched.find(u=>xe(u,a))||n.push(a))}return[s,i,n]}var ju=Object.defineProperty,Ku=(t,e,s)=>e in t?ju(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,mt=(t,e,s)=>(Ku(t,typeof e!="symbol"?e+"":e,s),s);function un(t,e,s){return e>s&&([e,s]=[s,e]),Math.min(s,Math.max(e,t))}function xt(t,e){return Array.from({length:t}).fill(e)}function $u(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function zu(t){return t===void 0}function Ju(t){return t===null}function ni(t){return typeof t=="number"?isNaN(t):Ju(t)||zu(t)}function Qu(t){return!ni(t)}function tc(t,e=!0){const s=e?!1:ni(t);return Array.isArray(t)?t.length===0:s}function ec(t,e=!0){const s=e?!1:ni(t);return $u(t)?tc(Object.keys(t)):s}function sc(t){return Object.keys(t)}function Si(t){return Object.entries(t)}function We(t,e=16){e=un(e,2,36);let s="";for(let i=1;i<=t;i++)s+=Math.floor(Math.random()*e).toString(e);return s}function Ko(){let t="";if(typeof crypto<"u"&&"randomUUID"in crypto)t=crypto.randomUUID();else if(typeof Blob>"u")t=`${We(8)}-${We(4)}-${We(4)}-${We(4)}-${We(12)}`;else{const e=URL.createObjectURL(new Blob);t=e.toString().substring(e.lastIndexOf("/")+1),URL.revokeObjectURL(e)}return t}function ic(t,e=Ko()){const s=document.createElement("a");s.href=t,s.download=e,s.click()}function nc(t,e=Ko()){ic(t.toDataURL("image/png"),e)}class rc{constructor(e,s,i){mt(this,"_dataFactory",window.indexedDB),mt(this,"_dbName"),mt(this,"_storeName"),mt(this,"_database"),mt(this,"_res"),this._dataFactory=window.indexedDB,this._dbName=e,this._storeName=s,this._res=this._dataFactory.open(this._dbName,i),this._res.addEventListener("success",()=>{this._database=this._res.result,this._database.objectStoreNames.contains(this._storeName)||this._database.createObjectStore(this._storeName,{keyPath:"id"})}),this._res.addEventListener("error",()=>{console.error("indexedDB load error")}),this._res.addEventListener("upgradeneeded",()=>{this._database=this._res.result,this._database.objectStoreNames.contains(this._storeName)||this._database.createObjectStore(this._storeName,{keyPath:"id"})})}get _store(){return this._database.transaction([this._storeName],"readwrite").objectStore(this._storeName)}set_item(e,s){this._store.put({id:e,data:s})}get_item(e){const s=this._store.get(e);return new Promise((i,n)=>{s.addEventListener("success",()=>{i(s.result.data)}),s.addEventListener("error",n)})}remove_item(e){this._store.delete(e)}clear(){this._store.clear()}}function oc(t,e){return new rc(t,e)}var Ut=function(){this.state=new Array(8);for(var t=0;t<this.state.length;t++)this.state[t]=64};Ut.BUTTON_A=0;Ut.BUTTON_B=1;Ut.BUTTON_SELECT=2;Ut.BUTTON_START=3;Ut.BUTTON_UP=4;Ut.BUTTON_DOWN=5;Ut.BUTTON_LEFT=6;Ut.BUTTON_RIGHT=7;Ut.prototype={buttonDown:function(t){this.state[t]=65},buttonUp:function(t){this.state[t]=64}};var $o=Ut,cn={copyArrayElements:function(t,e,s,i,n){for(var r=0;r<n;++r)s[i+r]=t[e+r]},copyArray:function(t){return t.slice(0)},fromJSON:function(t,e){for(var s=0;s<t.JSON_PROPERTIES.length;s++)t[t.JSON_PROPERTIES[s]]=e[t.JSON_PROPERTIES[s]]},toJSON:function(t){for(var e={},s=0;s<t.JSON_PROPERTIES.length;s++)e[t.JSON_PROPERTIES[s]]=t[t.JSON_PROPERTIES[s]];return e}},mr=cn,zo=function(t){this.nes=t,this.mem=null,this.REG_ACC=null,this.REG_X=null,this.REG_Y=null,this.REG_SP=null,this.REG_PC=null,this.REG_PC_NEW=null,this.REG_STATUS=null,this.F_CARRY=null,this.F_DECIMAL=null,this.F_INTERRUPT=null,this.F_INTERRUPT_NEW=null,this.F_OVERFLOW=null,this.F_SIGN=null,this.F_ZERO=null,this.F_NOTUSED=null,this.F_NOTUSED_NEW=null,this.F_BRK=null,this.F_BRK_NEW=null,this.opdata=null,this.cyclesToHalt=null,this.crash=null,this.irqRequested=null,this.irqType=null,this.reset()};zo.prototype={IRQ_NORMAL:0,IRQ_NMI:1,IRQ_RESET:2,reset:function(){this.mem=new Array(65536);for(var t=0;t<8192;t++)this.mem[t]=255;for(var e=0;e<4;e++){var s=e*2048;this.mem[s+8]=247,this.mem[s+9]=239,this.mem[s+10]=223,this.mem[s+15]=191}for(var i=8193;i<this.mem.length;i++)this.mem[i]=0;this.REG_ACC=0,this.REG_X=0,this.REG_Y=0,this.REG_SP=511,this.REG_PC=32767,this.REG_PC_NEW=32767,this.REG_STATUS=40,this.setStatus(40),this.F_CARRY=0,this.F_DECIMAL=0,this.F_INTERRUPT=1,this.F_INTERRUPT_NEW=1,this.F_OVERFLOW=0,this.F_SIGN=0,this.F_ZERO=1,this.F_NOTUSED=1,this.F_NOTUSED_NEW=1,this.F_BRK=1,this.F_BRK_NEW=1,this.opdata=new Jo().opdata,this.cyclesToHalt=0,this.crash=!1,this.irqRequested=!1,this.irqType=null},emulate:function(){var t,e;if(this.irqRequested){switch(t=this.F_CARRY|(this.F_ZERO===0?1:0)<<1|this.F_INTERRUPT<<2|this.F_DECIMAL<<3|this.F_BRK<<4|this.F_NOTUSED<<5|this.F_OVERFLOW<<6|this.F_SIGN<<7,this.REG_PC_NEW=this.REG_PC,this.F_INTERRUPT_NEW=this.F_INTERRUPT,this.irqType){case 0:{if(this.F_INTERRUPT!==0)break;this.doIrq(t);break}case 1:{this.doNonMaskableInterrupt(t);break}case 2:{this.doResetInterrupt();break}}this.REG_PC=this.REG_PC_NEW,this.F_INTERRUPT=this.F_INTERRUPT_NEW,this.F_BRK=this.F_BRK_NEW,this.irqRequested=!1}var s=this.opdata[this.nes.mmap.load(this.REG_PC+1)],i=s>>24,n=0,r=s>>8&255,o=this.REG_PC;this.REG_PC+=s>>16&255;var h=0;switch(r){case 0:{h=this.load(o+2);break}case 1:{h=this.load(o+2),h<128?h+=this.REG_PC:h+=this.REG_PC-256;break}case 2:break;case 3:{h=this.load16bit(o+2);break}case 4:{h=this.REG_ACC;break}case 5:{h=this.REG_PC;break}case 6:{h=this.load(o+2)+this.REG_X&255;break}case 7:{h=this.load(o+2)+this.REG_Y&255;break}case 8:{h=this.load16bit(o+2),(h&65280)!==(h+this.REG_X&65280)&&(n=1),h+=this.REG_X;break}case 9:{h=this.load16bit(o+2),(h&65280)!==(h+this.REG_Y&65280)&&(n=1),h+=this.REG_Y;break}case 10:{h=this.load(o+2),(h&65280)!==(h+this.REG_X&65280)&&(n=1),h+=this.REG_X,h&=255,h=this.load16bit(h);break}case 11:{h=this.load16bit(this.load(o+2)),(h&65280)!==(h+this.REG_Y&65280)&&(n=1),h+=this.REG_Y;break}case 12:{h=this.load16bit(o+2),h<8191?h=this.mem[h]+(this.mem[h&65280|(h&255)+1&255]<<8):h=this.nes.mmap.load(h)+(this.nes.mmap.load(h&65280|(h&255)+1&255)<<8);break}}switch(h&=65535,s&255){case 0:{t=this.REG_ACC+this.load(h)+this.F_CARRY,!((this.REG_ACC^this.load(h))&128)&&(this.REG_ACC^t)&128?this.F_OVERFLOW=1:this.F_OVERFLOW=0,this.F_CARRY=t>255?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255,this.REG_ACC=t&255,i+=n;break}case 1:{this.REG_ACC=this.REG_ACC&this.load(h),this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,r!==11&&(i+=n);break}case 2:{r===4?(this.F_CARRY=this.REG_ACC>>7&1,this.REG_ACC=this.REG_ACC<<1&255,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC):(t=this.load(h),this.F_CARRY=t>>7&1,t=t<<1&255,this.F_SIGN=t>>7&1,this.F_ZERO=t,this.write(h,t));break}case 3:{this.F_CARRY===0&&(i+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 4:{this.F_CARRY===1&&(i+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 5:{this.F_ZERO===0&&(i+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 6:{t=this.load(h),this.F_SIGN=t>>7&1,this.F_OVERFLOW=t>>6&1,t&=this.REG_ACC,this.F_ZERO=t;break}case 7:{this.F_SIGN===1&&(i++,this.REG_PC=h);break}case 8:{this.F_ZERO!==0&&(i+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 9:{this.F_SIGN===0&&(i+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 10:{this.REG_PC+=2,this.push(this.REG_PC>>8&255),this.push(this.REG_PC&255),this.F_BRK=1,this.push(this.F_CARRY|(this.F_ZERO===0?1:0)<<1|this.F_INTERRUPT<<2|this.F_DECIMAL<<3|this.F_BRK<<4|this.F_NOTUSED<<5|this.F_OVERFLOW<<6|this.F_SIGN<<7),this.F_INTERRUPT=1,this.REG_PC=this.load16bit(65534),this.REG_PC--;break}case 11:{this.F_OVERFLOW===0&&(i+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 12:{this.F_OVERFLOW===1&&(i+=(o&65280)!==(h&65280)?2:1,this.REG_PC=h);break}case 13:{this.F_CARRY=0;break}case 14:{this.F_DECIMAL=0;break}case 15:{this.F_INTERRUPT=0;break}case 16:{this.F_OVERFLOW=0;break}case 17:{t=this.REG_ACC-this.load(h),this.F_CARRY=t>=0?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255,i+=n;break}case 18:{t=this.REG_X-this.load(h),this.F_CARRY=t>=0?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255;break}case 19:{t=this.REG_Y-this.load(h),this.F_CARRY=t>=0?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255;break}case 20:{t=this.load(h)-1&255,this.F_SIGN=t>>7&1,this.F_ZERO=t,this.write(h,t);break}case 21:{this.REG_X=this.REG_X-1&255,this.F_SIGN=this.REG_X>>7&1,this.F_ZERO=this.REG_X;break}case 22:{this.REG_Y=this.REG_Y-1&255,this.F_SIGN=this.REG_Y>>7&1,this.F_ZERO=this.REG_Y;break}case 23:{this.REG_ACC=(this.load(h)^this.REG_ACC)&255,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,i+=n;break}case 24:{t=this.load(h)+1&255,this.F_SIGN=t>>7&1,this.F_ZERO=t,this.write(h,t&255);break}case 25:{this.REG_X=this.REG_X+1&255,this.F_SIGN=this.REG_X>>7&1,this.F_ZERO=this.REG_X;break}case 26:{this.REG_Y++,this.REG_Y&=255,this.F_SIGN=this.REG_Y>>7&1,this.F_ZERO=this.REG_Y;break}case 27:{this.REG_PC=h-1;break}case 28:{this.push(this.REG_PC>>8&255),this.push(this.REG_PC&255),this.REG_PC=h-1;break}case 29:{this.REG_ACC=this.load(h),this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,i+=n;break}case 30:{this.REG_X=this.load(h),this.F_SIGN=this.REG_X>>7&1,this.F_ZERO=this.REG_X,i+=n;break}case 31:{this.REG_Y=this.load(h),this.F_SIGN=this.REG_Y>>7&1,this.F_ZERO=this.REG_Y,i+=n;break}case 32:{r===4?(t=this.REG_ACC&255,this.F_CARRY=t&1,t>>=1,this.REG_ACC=t):(t=this.load(h)&255,this.F_CARRY=t&1,t>>=1,this.write(h,t)),this.F_SIGN=0,this.F_ZERO=t;break}case 33:break;case 34:{t=(this.load(h)|this.REG_ACC)&255,this.F_SIGN=t>>7&1,this.F_ZERO=t,this.REG_ACC=t,r!==11&&(i+=n);break}case 35:{this.push(this.REG_ACC);break}case 36:{this.F_BRK=1,this.push(this.F_CARRY|(this.F_ZERO===0?1:0)<<1|this.F_INTERRUPT<<2|this.F_DECIMAL<<3|this.F_BRK<<4|this.F_NOTUSED<<5|this.F_OVERFLOW<<6|this.F_SIGN<<7);break}case 37:{this.REG_ACC=this.pull(),this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC;break}case 38:{t=this.pull(),this.F_CARRY=t&1,this.F_ZERO=(t>>1&1)===1?0:1,this.F_INTERRUPT=t>>2&1,this.F_DECIMAL=t>>3&1,this.F_BRK=t>>4&1,this.F_NOTUSED=t>>5&1,this.F_OVERFLOW=t>>6&1,this.F_SIGN=t>>7&1,this.F_NOTUSED=1;break}case 39:{r===4?(t=this.REG_ACC,e=this.F_CARRY,this.F_CARRY=t>>7&1,t=(t<<1&255)+e,this.REG_ACC=t):(t=this.load(h),e=this.F_CARRY,this.F_CARRY=t>>7&1,t=(t<<1&255)+e,this.write(h,t)),this.F_SIGN=t>>7&1,this.F_ZERO=t;break}case 40:{r===4?(e=this.F_CARRY<<7,this.F_CARRY=this.REG_ACC&1,t=(this.REG_ACC>>1)+e,this.REG_ACC=t):(t=this.load(h),e=this.F_CARRY<<7,this.F_CARRY=t&1,t=(t>>1)+e,this.write(h,t)),this.F_SIGN=t>>7&1,this.F_ZERO=t;break}case 41:{if(t=this.pull(),this.F_CARRY=t&1,this.F_ZERO=t>>1&1?0:1,this.F_INTERRUPT=t>>2&1,this.F_DECIMAL=t>>3&1,this.F_BRK=t>>4&1,this.F_NOTUSED=t>>5&1,this.F_OVERFLOW=t>>6&1,this.F_SIGN=t>>7&1,this.REG_PC=this.pull(),this.REG_PC+=this.pull()<<8,this.REG_PC===65535)return;this.REG_PC--,this.F_NOTUSED=1;break}case 42:{if(this.REG_PC=this.pull(),this.REG_PC+=this.pull()<<8,this.REG_PC===65535)return;break}case 43:{t=this.REG_ACC-this.load(h)-(1-this.F_CARRY),this.F_SIGN=t>>7&1,this.F_ZERO=t&255,(this.REG_ACC^t)&128&&(this.REG_ACC^this.load(h))&128?this.F_OVERFLOW=1:this.F_OVERFLOW=0,this.F_CARRY=t<0?0:1,this.REG_ACC=t&255,r!==11&&(i+=n);break}case 44:{this.F_CARRY=1;break}case 45:{this.F_DECIMAL=1;break}case 46:{this.F_INTERRUPT=1;break}case 47:{this.write(h,this.REG_ACC);break}case 48:{this.write(h,this.REG_X);break}case 49:{this.write(h,this.REG_Y);break}case 50:{this.REG_X=this.REG_ACC,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC;break}case 51:{this.REG_Y=this.REG_ACC,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC;break}case 52:{this.REG_X=this.REG_SP-256,this.F_SIGN=this.REG_SP>>7&1,this.F_ZERO=this.REG_X;break}case 53:{this.REG_ACC=this.REG_X,this.F_SIGN=this.REG_X>>7&1,this.F_ZERO=this.REG_X;break}case 54:{this.REG_SP=this.REG_X+256,this.stackWrap();break}case 55:{this.REG_ACC=this.REG_Y,this.F_SIGN=this.REG_Y>>7&1,this.F_ZERO=this.REG_Y;break}case 56:{t=this.REG_ACC&this.load(h),this.F_CARRY=t&1,this.REG_ACC=this.F_ZERO=t>>1,this.F_SIGN=0;break}case 57:{this.REG_ACC=this.F_ZERO=this.REG_ACC&this.load(h),this.F_CARRY=this.F_SIGN=this.REG_ACC>>7&1;break}case 58:{t=this.REG_ACC&this.load(h),this.REG_ACC=this.F_ZERO=(t>>1)+(this.F_CARRY<<7),this.F_SIGN=this.F_CARRY,this.F_CARRY=t>>7&1,this.F_OVERFLOW=(t>>7^t>>6)&1;break}case 59:{t=(this.REG_X&this.REG_ACC)-this.load(h),this.F_SIGN=t>>7&1,this.F_ZERO=t&255,(this.REG_X^t)&128&&(this.REG_X^this.load(h))&128?this.F_OVERFLOW=1:this.F_OVERFLOW=0,this.F_CARRY=t<0?0:1,this.REG_X=t&255;break}case 60:{this.REG_ACC=this.REG_X=this.F_ZERO=this.load(h),this.F_SIGN=this.REG_ACC>>7&1,i+=n;break}case 61:{this.write(h,this.REG_ACC&this.REG_X);break}case 62:{t=this.load(h)-1&255,this.write(h,t),t=this.REG_ACC-t,this.F_CARRY=t>=0?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255,r!==11&&(i+=n);break}case 63:{t=this.load(h)+1&255,this.write(h,t),t=this.REG_ACC-t-(1-this.F_CARRY),this.F_SIGN=t>>7&1,this.F_ZERO=t&255,(this.REG_ACC^t)&128&&(this.REG_ACC^this.load(h))&128?this.F_OVERFLOW=1:this.F_OVERFLOW=0,this.F_CARRY=t<0?0:1,this.REG_ACC=t&255,r!==11&&(i+=n);break}case 64:{t=this.load(h),e=this.F_CARRY,this.F_CARRY=t>>7&1,t=(t<<1&255)+e,this.write(h,t),this.REG_ACC=this.REG_ACC&t,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,r!==11&&(i+=n);break}case 65:{t=this.load(h),e=this.F_CARRY<<7,this.F_CARRY=t&1,t=(t>>1)+e,this.write(h,t),t=this.REG_ACC+this.load(h)+this.F_CARRY,!((this.REG_ACC^this.load(h))&128)&&(this.REG_ACC^t)&128?this.F_OVERFLOW=1:this.F_OVERFLOW=0,this.F_CARRY=t>255?1:0,this.F_SIGN=t>>7&1,this.F_ZERO=t&255,this.REG_ACC=t&255,r!==11&&(i+=n);break}case 66:{t=this.load(h),this.F_CARRY=t>>7&1,t=t<<1&255,this.write(h,t),this.REG_ACC=this.REG_ACC|t,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,r!==11&&(i+=n);break}case 67:{t=this.load(h)&255,this.F_CARRY=t&1,t>>=1,this.write(h,t),this.REG_ACC=this.REG_ACC^t,this.F_SIGN=this.REG_ACC>>7&1,this.F_ZERO=this.REG_ACC,r!==11&&(i+=n);break}case 68:break;case 69:{this.load(h),r!==11&&(i+=n);break}default:{this.nes.stop(),this.nes.crashMessage="Game crashed, invalid opcode at address $"+o.toString(16);break}}return i},load:function(t){return t<8192?this.mem[t&2047]:this.nes.mmap.load(t)},load16bit:function(t){return t<8191?this.mem[t&2047]|this.mem[t+1&2047]<<8:this.nes.mmap.load(t)|this.nes.mmap.load(t+1)<<8},write:function(t,e){t<8192?this.mem[t&2047]=e:this.nes.mmap.write(t,e)},requestIrq:function(t){this.irqRequested&&t===this.IRQ_NORMAL||(this.irqRequested=!0,this.irqType=t)},push:function(t){this.nes.mmap.write(this.REG_SP,t),this.REG_SP--,this.REG_SP=256|this.REG_SP&255},stackWrap:function(){this.REG_SP=256|this.REG_SP&255},pull:function(){return this.REG_SP++,this.REG_SP=256|this.REG_SP&255,this.nes.mmap.load(this.REG_SP)},pageCrossed:function(t,e){return(t&65280)!==(e&65280)},haltCycles:function(t){this.cyclesToHalt+=t},doNonMaskableInterrupt:function(t){this.nes.mmap.load(8192)&128&&(this.REG_PC_NEW++,this.push(this.REG_PC_NEW>>8&255),this.push(this.REG_PC_NEW&255),this.push(t),this.REG_PC_NEW=this.nes.mmap.load(65530)|this.nes.mmap.load(65531)<<8,this.REG_PC_NEW--)},doResetInterrupt:function(){this.REG_PC_NEW=this.nes.mmap.load(65532)|this.nes.mmap.load(65533)<<8,this.REG_PC_NEW--},doIrq:function(t){this.REG_PC_NEW++,this.push(this.REG_PC_NEW>>8&255),this.push(this.REG_PC_NEW&255),this.push(t),this.F_INTERRUPT_NEW=1,this.F_BRK_NEW=0,this.REG_PC_NEW=this.nes.mmap.load(65534)|this.nes.mmap.load(65535)<<8,this.REG_PC_NEW--},getStatus:function(){return this.F_CARRY|this.F_ZERO<<1|this.F_INTERRUPT<<2|this.F_DECIMAL<<3|this.F_BRK<<4|this.F_NOTUSED<<5|this.F_OVERFLOW<<6|this.F_SIGN<<7},setStatus:function(t){this.F_CARRY=t&1,this.F_ZERO=t>>1&1,this.F_INTERRUPT=t>>2&1,this.F_DECIMAL=t>>3&1,this.F_BRK=t>>4&1,this.F_NOTUSED=t>>5&1,this.F_OVERFLOW=t>>6&1,this.F_SIGN=t>>7&1},JSON_PROPERTIES:["mem","cyclesToHalt","irqRequested","irqType","REG_ACC","REG_X","REG_Y","REG_SP","REG_PC","REG_PC_NEW","REG_STATUS","F_CARRY","F_DECIMAL","F_INTERRUPT","F_INTERRUPT_NEW","F_OVERFLOW","F_SIGN","F_ZERO","F_NOTUSED","F_NOTUSED_NEW","F_BRK","F_BRK_NEW"],toJSON:function(){return mr.toJSON(this)},fromJSON:function(t){mr.fromJSON(this,t)}};var Jo=function(){this.opdata=new Array(256);for(var t=0;t<256;t++)this.opdata[t]=255;this.setOp(this.INS_ADC,105,this.ADDR_IMM,2,2),this.setOp(this.INS_ADC,101,this.ADDR_ZP,2,3),this.setOp(this.INS_ADC,117,this.ADDR_ZPX,2,4),this.setOp(this.INS_ADC,109,this.ADDR_ABS,3,4),this.setOp(this.INS_ADC,125,this.ADDR_ABSX,3,4),this.setOp(this.INS_ADC,121,this.ADDR_ABSY,3,4),this.setOp(this.INS_ADC,97,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_ADC,113,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_AND,41,this.ADDR_IMM,2,2),this.setOp(this.INS_AND,37,this.ADDR_ZP,2,3),this.setOp(this.INS_AND,53,this.ADDR_ZPX,2,4),this.setOp(this.INS_AND,45,this.ADDR_ABS,3,4),this.setOp(this.INS_AND,61,this.ADDR_ABSX,3,4),this.setOp(this.INS_AND,57,this.ADDR_ABSY,3,4),this.setOp(this.INS_AND,33,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_AND,49,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_ASL,10,this.ADDR_ACC,1,2),this.setOp(this.INS_ASL,6,this.ADDR_ZP,2,5),this.setOp(this.INS_ASL,22,this.ADDR_ZPX,2,6),this.setOp(this.INS_ASL,14,this.ADDR_ABS,3,6),this.setOp(this.INS_ASL,30,this.ADDR_ABSX,3,7),this.setOp(this.INS_BCC,144,this.ADDR_REL,2,2),this.setOp(this.INS_BCS,176,this.ADDR_REL,2,2),this.setOp(this.INS_BEQ,240,this.ADDR_REL,2,2),this.setOp(this.INS_BIT,36,this.ADDR_ZP,2,3),this.setOp(this.INS_BIT,44,this.ADDR_ABS,3,4),this.setOp(this.INS_BMI,48,this.ADDR_REL,2,2),this.setOp(this.INS_BNE,208,this.ADDR_REL,2,2),this.setOp(this.INS_BPL,16,this.ADDR_REL,2,2),this.setOp(this.INS_BRK,0,this.ADDR_IMP,1,7),this.setOp(this.INS_BVC,80,this.ADDR_REL,2,2),this.setOp(this.INS_BVS,112,this.ADDR_REL,2,2),this.setOp(this.INS_CLC,24,this.ADDR_IMP,1,2),this.setOp(this.INS_CLD,216,this.ADDR_IMP,1,2),this.setOp(this.INS_CLI,88,this.ADDR_IMP,1,2),this.setOp(this.INS_CLV,184,this.ADDR_IMP,1,2),this.setOp(this.INS_CMP,201,this.ADDR_IMM,2,2),this.setOp(this.INS_CMP,197,this.ADDR_ZP,2,3),this.setOp(this.INS_CMP,213,this.ADDR_ZPX,2,4),this.setOp(this.INS_CMP,205,this.ADDR_ABS,3,4),this.setOp(this.INS_CMP,221,this.ADDR_ABSX,3,4),this.setOp(this.INS_CMP,217,this.ADDR_ABSY,3,4),this.setOp(this.INS_CMP,193,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_CMP,209,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_CPX,224,this.ADDR_IMM,2,2),this.setOp(this.INS_CPX,228,this.ADDR_ZP,2,3),this.setOp(this.INS_CPX,236,this.ADDR_ABS,3,4),this.setOp(this.INS_CPY,192,this.ADDR_IMM,2,2),this.setOp(this.INS_CPY,196,this.ADDR_ZP,2,3),this.setOp(this.INS_CPY,204,this.ADDR_ABS,3,4),this.setOp(this.INS_DEC,198,this.ADDR_ZP,2,5),this.setOp(this.INS_DEC,214,this.ADDR_ZPX,2,6),this.setOp(this.INS_DEC,206,this.ADDR_ABS,3,6),this.setOp(this.INS_DEC,222,this.ADDR_ABSX,3,7),this.setOp(this.INS_DEX,202,this.ADDR_IMP,1,2),this.setOp(this.INS_DEY,136,this.ADDR_IMP,1,2),this.setOp(this.INS_EOR,73,this.ADDR_IMM,2,2),this.setOp(this.INS_EOR,69,this.ADDR_ZP,2,3),this.setOp(this.INS_EOR,85,this.ADDR_ZPX,2,4),this.setOp(this.INS_EOR,77,this.ADDR_ABS,3,4),this.setOp(this.INS_EOR,93,this.ADDR_ABSX,3,4),this.setOp(this.INS_EOR,89,this.ADDR_ABSY,3,4),this.setOp(this.INS_EOR,65,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_EOR,81,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_INC,230,this.ADDR_ZP,2,5),this.setOp(this.INS_INC,246,this.ADDR_ZPX,2,6),this.setOp(this.INS_INC,238,this.ADDR_ABS,3,6),this.setOp(this.INS_INC,254,this.ADDR_ABSX,3,7),this.setOp(this.INS_INX,232,this.ADDR_IMP,1,2),this.setOp(this.INS_INY,200,this.ADDR_IMP,1,2),this.setOp(this.INS_JMP,76,this.ADDR_ABS,3,3),this.setOp(this.INS_JMP,108,this.ADDR_INDABS,3,5),this.setOp(this.INS_JSR,32,this.ADDR_ABS,3,6),this.setOp(this.INS_LDA,169,this.ADDR_IMM,2,2),this.setOp(this.INS_LDA,165,this.ADDR_ZP,2,3),this.setOp(this.INS_LDA,181,this.ADDR_ZPX,2,4),this.setOp(this.INS_LDA,173,this.ADDR_ABS,3,4),this.setOp(this.INS_LDA,189,this.ADDR_ABSX,3,4),this.setOp(this.INS_LDA,185,this.ADDR_ABSY,3,4),this.setOp(this.INS_LDA,161,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_LDA,177,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_LDX,162,this.ADDR_IMM,2,2),this.setOp(this.INS_LDX,166,this.ADDR_ZP,2,3),this.setOp(this.INS_LDX,182,this.ADDR_ZPY,2,4),this.setOp(this.INS_LDX,174,this.ADDR_ABS,3,4),this.setOp(this.INS_LDX,190,this.ADDR_ABSY,3,4),this.setOp(this.INS_LDY,160,this.ADDR_IMM,2,2),this.setOp(this.INS_LDY,164,this.ADDR_ZP,2,3),this.setOp(this.INS_LDY,180,this.ADDR_ZPX,2,4),this.setOp(this.INS_LDY,172,this.ADDR_ABS,3,4),this.setOp(this.INS_LDY,188,this.ADDR_ABSX,3,4),this.setOp(this.INS_LSR,74,this.ADDR_ACC,1,2),this.setOp(this.INS_LSR,70,this.ADDR_ZP,2,5),this.setOp(this.INS_LSR,86,this.ADDR_ZPX,2,6),this.setOp(this.INS_LSR,78,this.ADDR_ABS,3,6),this.setOp(this.INS_LSR,94,this.ADDR_ABSX,3,7),this.setOp(this.INS_NOP,26,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,58,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,90,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,122,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,218,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,234,this.ADDR_IMP,1,2),this.setOp(this.INS_NOP,250,this.ADDR_IMP,1,2),this.setOp(this.INS_ORA,9,this.ADDR_IMM,2,2),this.setOp(this.INS_ORA,5,this.ADDR_ZP,2,3),this.setOp(this.INS_ORA,21,this.ADDR_ZPX,2,4),this.setOp(this.INS_ORA,13,this.ADDR_ABS,3,4),this.setOp(this.INS_ORA,29,this.ADDR_ABSX,3,4),this.setOp(this.INS_ORA,25,this.ADDR_ABSY,3,4),this.setOp(this.INS_ORA,1,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_ORA,17,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_PHA,72,this.ADDR_IMP,1,3),this.setOp(this.INS_PHP,8,this.ADDR_IMP,1,3),this.setOp(this.INS_PLA,104,this.ADDR_IMP,1,4),this.setOp(this.INS_PLP,40,this.ADDR_IMP,1,4),this.setOp(this.INS_ROL,42,this.ADDR_ACC,1,2),this.setOp(this.INS_ROL,38,this.ADDR_ZP,2,5),this.setOp(this.INS_ROL,54,this.ADDR_ZPX,2,6),this.setOp(this.INS_ROL,46,this.ADDR_ABS,3,6),this.setOp(this.INS_ROL,62,this.ADDR_ABSX,3,7),this.setOp(this.INS_ROR,106,this.ADDR_ACC,1,2),this.setOp(this.INS_ROR,102,this.ADDR_ZP,2,5),this.setOp(this.INS_ROR,118,this.ADDR_ZPX,2,6),this.setOp(this.INS_ROR,110,this.ADDR_ABS,3,6),this.setOp(this.INS_ROR,126,this.ADDR_ABSX,3,7),this.setOp(this.INS_RTI,64,this.ADDR_IMP,1,6),this.setOp(this.INS_RTS,96,this.ADDR_IMP,1,6),this.setOp(this.INS_SBC,233,this.ADDR_IMM,2,2),this.setOp(this.INS_SBC,229,this.ADDR_ZP,2,3),this.setOp(this.INS_SBC,245,this.ADDR_ZPX,2,4),this.setOp(this.INS_SBC,237,this.ADDR_ABS,3,4),this.setOp(this.INS_SBC,253,this.ADDR_ABSX,3,4),this.setOp(this.INS_SBC,249,this.ADDR_ABSY,3,4),this.setOp(this.INS_SBC,225,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_SBC,241,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_SEC,56,this.ADDR_IMP,1,2),this.setOp(this.INS_SED,248,this.ADDR_IMP,1,2),this.setOp(this.INS_SEI,120,this.ADDR_IMP,1,2),this.setOp(this.INS_STA,133,this.ADDR_ZP,2,3),this.setOp(this.INS_STA,149,this.ADDR_ZPX,2,4),this.setOp(this.INS_STA,141,this.ADDR_ABS,3,4),this.setOp(this.INS_STA,157,this.ADDR_ABSX,3,5),this.setOp(this.INS_STA,153,this.ADDR_ABSY,3,5),this.setOp(this.INS_STA,129,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_STA,145,this.ADDR_POSTIDXIND,2,6),this.setOp(this.INS_STX,134,this.ADDR_ZP,2,3),this.setOp(this.INS_STX,150,this.ADDR_ZPY,2,4),this.setOp(this.INS_STX,142,this.ADDR_ABS,3,4),this.setOp(this.INS_STY,132,this.ADDR_ZP,2,3),this.setOp(this.INS_STY,148,this.ADDR_ZPX,2,4),this.setOp(this.INS_STY,140,this.ADDR_ABS,3,4),this.setOp(this.INS_TAX,170,this.ADDR_IMP,1,2),this.setOp(this.INS_TAY,168,this.ADDR_IMP,1,2),this.setOp(this.INS_TSX,186,this.ADDR_IMP,1,2),this.setOp(this.INS_TXA,138,this.ADDR_IMP,1,2),this.setOp(this.INS_TXS,154,this.ADDR_IMP,1,2),this.setOp(this.INS_TYA,152,this.ADDR_IMP,1,2),this.setOp(this.INS_ALR,75,this.ADDR_IMM,2,2),this.setOp(this.INS_ANC,11,this.ADDR_IMM,2,2),this.setOp(this.INS_ANC,43,this.ADDR_IMM,2,2),this.setOp(this.INS_ARR,107,this.ADDR_IMM,2,2),this.setOp(this.INS_AXS,203,this.ADDR_IMM,2,2),this.setOp(this.INS_LAX,163,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_LAX,167,this.ADDR_ZP,2,3),this.setOp(this.INS_LAX,175,this.ADDR_ABS,3,4),this.setOp(this.INS_LAX,179,this.ADDR_POSTIDXIND,2,5),this.setOp(this.INS_LAX,183,this.ADDR_ZPY,2,4),this.setOp(this.INS_LAX,191,this.ADDR_ABSY,3,4),this.setOp(this.INS_SAX,131,this.ADDR_PREIDXIND,2,6),this.setOp(this.INS_SAX,135,this.ADDR_ZP,2,3),this.setOp(this.INS_SAX,143,this.ADDR_ABS,3,4),this.setOp(this.INS_SAX,151,this.ADDR_ZPY,2,4),this.setOp(this.INS_DCP,195,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_DCP,199,this.ADDR_ZP,2,5),this.setOp(this.INS_DCP,207,this.ADDR_ABS,3,6),this.setOp(this.INS_DCP,211,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_DCP,215,this.ADDR_ZPX,2,6),this.setOp(this.INS_DCP,219,this.ADDR_ABSY,3,7),this.setOp(this.INS_DCP,223,this.ADDR_ABSX,3,7),this.setOp(this.INS_ISC,227,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_ISC,231,this.ADDR_ZP,2,5),this.setOp(this.INS_ISC,239,this.ADDR_ABS,3,6),this.setOp(this.INS_ISC,243,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_ISC,247,this.ADDR_ZPX,2,6),this.setOp(this.INS_ISC,251,this.ADDR_ABSY,3,7),this.setOp(this.INS_ISC,255,this.ADDR_ABSX,3,7),this.setOp(this.INS_RLA,35,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_RLA,39,this.ADDR_ZP,2,5),this.setOp(this.INS_RLA,47,this.ADDR_ABS,3,6),this.setOp(this.INS_RLA,51,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_RLA,55,this.ADDR_ZPX,2,6),this.setOp(this.INS_RLA,59,this.ADDR_ABSY,3,7),this.setOp(this.INS_RLA,63,this.ADDR_ABSX,3,7),this.setOp(this.INS_RRA,99,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_RRA,103,this.ADDR_ZP,2,5),this.setOp(this.INS_RRA,111,this.ADDR_ABS,3,6),this.setOp(this.INS_RRA,115,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_RRA,119,this.ADDR_ZPX,2,6),this.setOp(this.INS_RRA,123,this.ADDR_ABSY,3,7),this.setOp(this.INS_RRA,127,this.ADDR_ABSX,3,7),this.setOp(this.INS_SLO,3,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_SLO,7,this.ADDR_ZP,2,5),this.setOp(this.INS_SLO,15,this.ADDR_ABS,3,6),this.setOp(this.INS_SLO,19,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_SLO,23,this.ADDR_ZPX,2,6),this.setOp(this.INS_SLO,27,this.ADDR_ABSY,3,7),this.setOp(this.INS_SLO,31,this.ADDR_ABSX,3,7),this.setOp(this.INS_SRE,67,this.ADDR_PREIDXIND,2,8),this.setOp(this.INS_SRE,71,this.ADDR_ZP,2,5),this.setOp(this.INS_SRE,79,this.ADDR_ABS,3,6),this.setOp(this.INS_SRE,83,this.ADDR_POSTIDXIND,2,8),this.setOp(this.INS_SRE,87,this.ADDR_ZPX,2,6),this.setOp(this.INS_SRE,91,this.ADDR_ABSY,3,7),this.setOp(this.INS_SRE,95,this.ADDR_ABSX,3,7),this.setOp(this.INS_SKB,128,this.ADDR_IMM,2,2),this.setOp(this.INS_SKB,130,this.ADDR_IMM,2,2),this.setOp(this.INS_SKB,137,this.ADDR_IMM,2,2),this.setOp(this.INS_SKB,194,this.ADDR_IMM,2,2),this.setOp(this.INS_SKB,226,this.ADDR_IMM,2,2),this.setOp(this.INS_IGN,12,this.ADDR_ABS,3,4),this.setOp(this.INS_IGN,28,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,60,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,92,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,124,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,220,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,252,this.ADDR_ABSX,3,4),this.setOp(this.INS_IGN,4,this.ADDR_ZP,2,3),this.setOp(this.INS_IGN,68,this.ADDR_ZP,2,3),this.setOp(this.INS_IGN,100,this.ADDR_ZP,2,3),this.setOp(this.INS_IGN,20,this.ADDR_ZPX,2,4),this.setOp(this.INS_IGN,52,this.ADDR_ZPX,2,4),this.setOp(this.INS_IGN,84,this.ADDR_ZPX,2,4),this.setOp(this.INS_IGN,116,this.ADDR_ZPX,2,4),this.setOp(this.INS_IGN,212,this.ADDR_ZPX,2,4),this.setOp(this.INS_IGN,244,this.ADDR_ZPX,2,4),this.cycTable=new Array(7,6,2,8,3,3,5,5,3,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,6,6,2,8,3,3,5,5,4,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,6,6,2,8,3,3,5,5,3,2,2,2,3,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,6,6,2,8,3,3,5,5,4,2,2,2,5,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,2,6,2,6,3,3,3,3,2,2,2,2,4,4,4,4,2,6,2,6,4,4,4,4,2,5,2,5,5,5,5,5,2,6,2,6,3,3,3,3,2,2,2,2,4,4,4,4,2,5,2,5,4,4,4,4,2,4,2,4,4,4,4,4,2,6,2,8,3,3,5,5,2,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7,2,6,3,8,3,3,5,5,2,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,7,7),this.instname=new Array(70),this.instname[0]="ADC",this.instname[1]="AND",this.instname[2]="ASL",this.instname[3]="BCC",this.instname[4]="BCS",this.instname[5]="BEQ",this.instname[6]="BIT",this.instname[7]="BMI",this.instname[8]="BNE",this.instname[9]="BPL",this.instname[10]="BRK",this.instname[11]="BVC",this.instname[12]="BVS",this.instname[13]="CLC",this.instname[14]="CLD",this.instname[15]="CLI",this.instname[16]="CLV",this.instname[17]="CMP",this.instname[18]="CPX",this.instname[19]="CPY",this.instname[20]="DEC",this.instname[21]="DEX",this.instname[22]="DEY",this.instname[23]="EOR",this.instname[24]="INC",this.instname[25]="INX",this.instname[26]="INY",this.instname[27]="JMP",this.instname[28]="JSR",this.instname[29]="LDA",this.instname[30]="LDX",this.instname[31]="LDY",this.instname[32]="LSR",this.instname[33]="NOP",this.instname[34]="ORA",this.instname[35]="PHA",this.instname[36]="PHP",this.instname[37]="PLA",this.instname[38]="PLP",this.instname[39]="ROL",this.instname[40]="ROR",this.instname[41]="RTI",this.instname[42]="RTS",this.instname[43]="SBC",this.instname[44]="SEC",this.instname[45]="SED",this.instname[46]="SEI",this.instname[47]="STA",this.instname[48]="STX",this.instname[49]="STY",this.instname[50]="TAX",this.instname[51]="TAY",this.instname[52]="TSX",this.instname[53]="TXA",this.instname[54]="TXS",this.instname[55]="TYA",this.instname[56]="ALR",this.instname[57]="ANC",this.instname[58]="ARR",this.instname[59]="AXS",this.instname[60]="LAX",this.instname[61]="SAX",this.instname[62]="DCP",this.instname[63]="ISC",this.instname[64]="RLA",this.instname[65]="RRA",this.instname[66]="SLO",this.instname[67]="SRE",this.instname[68]="SKB",this.instname[69]="IGN",this.addrDesc=new Array("Zero Page           ","Relative            ","Implied             ","Absolute            ","Accumulator         ","Immediate           ","Zero Page,X         ","Zero Page,Y         ","Absolute,X          ","Absolute,Y          ","Preindexed Indirect ","Postindexed Indirect","Indirect Absolute   ")};Jo.prototype={INS_ADC:0,INS_AND:1,INS_ASL:2,INS_BCC:3,INS_BCS:4,INS_BEQ:5,INS_BIT:6,INS_BMI:7,INS_BNE:8,INS_BPL:9,INS_BRK:10,INS_BVC:11,INS_BVS:12,INS_CLC:13,INS_CLD:14,INS_CLI:15,INS_CLV:16,INS_CMP:17,INS_CPX:18,INS_CPY:19,INS_DEC:20,INS_DEX:21,INS_DEY:22,INS_EOR:23,INS_INC:24,INS_INX:25,INS_INY:26,INS_JMP:27,INS_JSR:28,INS_LDA:29,INS_LDX:30,INS_LDY:31,INS_LSR:32,INS_NOP:33,INS_ORA:34,INS_PHA:35,INS_PHP:36,INS_PLA:37,INS_PLP:38,INS_ROL:39,INS_ROR:40,INS_RTI:41,INS_RTS:42,INS_SBC:43,INS_SEC:44,INS_SED:45,INS_SEI:46,INS_STA:47,INS_STX:48,INS_STY:49,INS_TAX:50,INS_TAY:51,INS_TSX:52,INS_TXA:53,INS_TXS:54,INS_TYA:55,INS_ALR:56,INS_ANC:57,INS_ARR:58,INS_AXS:59,INS_LAX:60,INS_SAX:61,INS_DCP:62,INS_ISC:63,INS_RLA:64,INS_RRA:65,INS_SLO:66,INS_SRE:67,INS_SKB:68,INS_IGN:69,INS_DUMMY:70,ADDR_ZP:0,ADDR_REL:1,ADDR_IMP:2,ADDR_ABS:3,ADDR_ACC:4,ADDR_IMM:5,ADDR_ZPX:6,ADDR_ZPY:7,ADDR_ABSX:8,ADDR_ABSY:9,ADDR_PREIDXIND:10,ADDR_POSTIDXIND:11,ADDR_INDABS:12,setOp:function(t,e,s,i,n){this.opdata[e]=t&255|(s&255)<<8|(i&255)<<16|(n&255)<<24}};var hc=zo,Qo=function(){this.pix=new Array(64),this.fbIndex=null,this.tIndex=null,this.x=null,this.y=null,this.w=null,this.h=null,this.incX=null,this.incY=null,this.palIndex=null,this.tpri=null,this.c=null,this.initialized=!1,this.opaque=new Array(8)};Qo.prototype={setBuffer:function(t){for(this.y=0;this.y<8;this.y++)this.setScanline(this.y,t[this.y],t[this.y+8])},setScanline:function(t,e,s){for(this.initialized=!0,this.tIndex=t<<3,this.x=0;this.x<8;this.x++)this.pix[this.tIndex+this.x]=(e>>7-this.x&1)+((s>>7-this.x&1)<<1),this.pix[this.tIndex+this.x]===0&&(this.opaque[t]=!1)},render:function(t,e,s,i,n,r,o,h,a,u,c,p,d){if(!(r<-7||r>=256||o<-7||o>=240))if(this.w=i-e,this.h=n-s,r<0&&(e-=r),r+i>=256&&(i=256-r),o<0&&(s-=o),o+n>=240&&(n=240-o),!u&&!c)for(this.fbIndex=(o<<8)+r,this.tIndex=0,this.y=0;this.y<8;this.y++){for(this.x=0;this.x<8;this.x++)this.x>=e&&this.x<i&&this.y>=s&&this.y<n&&(this.palIndex=this.pix[this.tIndex],this.tpri=d[this.fbIndex],this.palIndex!==0&&p<=(this.tpri&255)&&(t[this.fbIndex]=a[this.palIndex+h],this.tpri=this.tpri&3840|p,d[this.fbIndex]=this.tpri)),this.fbIndex++,this.tIndex++;this.fbIndex-=8,this.fbIndex+=256}else if(u&&!c)for(this.fbIndex=(o<<8)+r,this.tIndex=7,this.y=0;this.y<8;this.y++){for(this.x=0;this.x<8;this.x++)this.x>=e&&this.x<i&&this.y>=s&&this.y<n&&(this.palIndex=this.pix[this.tIndex],this.tpri=d[this.fbIndex],this.palIndex!==0&&p<=(this.tpri&255)&&(t[this.fbIndex]=a[this.palIndex+h],this.tpri=this.tpri&3840|p,d[this.fbIndex]=this.tpri)),this.fbIndex++,this.tIndex--;this.fbIndex-=8,this.fbIndex+=256,this.tIndex+=16}else if(c&&!u)for(this.fbIndex=(o<<8)+r,this.tIndex=56,this.y=0;this.y<8;this.y++){for(this.x=0;this.x<8;this.x++)this.x>=e&&this.x<i&&this.y>=s&&this.y<n&&(this.palIndex=this.pix[this.tIndex],this.tpri=d[this.fbIndex],this.palIndex!==0&&p<=(this.tpri&255)&&(t[this.fbIndex]=a[this.palIndex+h],this.tpri=this.tpri&3840|p,d[this.fbIndex]=this.tpri)),this.fbIndex++,this.tIndex++;this.fbIndex-=8,this.fbIndex+=256,this.tIndex-=16}else for(this.fbIndex=(o<<8)+r,this.tIndex=63,this.y=0;this.y<8;this.y++){for(this.x=0;this.x<8;this.x++)this.x>=e&&this.x<i&&this.y>=s&&this.y<n&&(this.palIndex=this.pix[this.tIndex],this.tpri=d[this.fbIndex],this.palIndex!==0&&p<=(this.tpri&255)&&(t[this.fbIndex]=a[this.palIndex+h],this.tpri=this.tpri&3840|p,d[this.fbIndex]=this.tpri)),this.fbIndex++,this.tIndex--;this.fbIndex-=8,this.fbIndex+=256}},isTransparent:function(t,e){return this.pix[(e<<3)+t]===0},toJSON:function(){return{opaque:this.opaque,pix:this.pix}},fromJSON:function(t){this.opaque=t.opaque,this.pix=t.pix}};var th=Qo,ac=th,_r=cn,eh=function(t){this.nes=t,this.vramMem=null,this.spriteMem=null,this.vramAddress=null,this.vramTmpAddress=null,this.vramBufferedReadValue=null,this.firstWrite=null,this.sramAddress=null,this.currentMirroring=null,this.requestEndFrame=null,this.nmiOk=null,this.dummyCycleToggle=null,this.validTileData=null,this.nmiCounter=null,this.scanlineAlreadyRendered=null,this.f_nmiOnVblank=null,this.f_spriteSize=null,this.f_bgPatternTable=null,this.f_spPatternTable=null,this.f_addrInc=null,this.f_nTblAddress=null,this.f_color=null,this.f_spVisibility=null,this.f_bgVisibility=null,this.f_spClipping=null,this.f_bgClipping=null,this.f_dispType=null,this.cntFV=null,this.cntV=null,this.cntH=null,this.cntVT=null,this.cntHT=null,this.regFV=null,this.regV=null,this.regH=null,this.regVT=null,this.regHT=null,this.regFH=null,this.regS=null,this.curNt=null,this.attrib=null,this.buffer=null,this.bgbuffer=null,this.pixrendered=null,this.validTileData=null,this.scantile=null,this.scanline=null,this.lastRenderedScanline=null,this.curX=null,this.sprX=null,this.sprY=null,this.sprTile=null,this.sprCol=null,this.vertFlip=null,this.horiFlip=null,this.bgPriority=null,this.spr0HitX=null,this.spr0HitY=null,this.hitSpr0=null,this.sprPalette=null,this.imgPalette=null,this.ptTile=null,this.ntable1=null,this.currentMirroring=null,this.nameTable=null,this.vramMirrorTable=null,this.palTable=null,this.showSpr0Hit=!1,this.clipToTvSize=!0,this.reset()};eh.prototype={STATUS_VRAMWRITE:4,STATUS_SLSPRITECOUNT:5,STATUS_SPRITE0HIT:6,STATUS_VBLANK:7,reset:function(){var t;for(this.vramMem=new Array(32768),this.spriteMem=new Array(256),t=0;t<this.vramMem.length;t++)this.vramMem[t]=0;for(t=0;t<this.spriteMem.length;t++)this.spriteMem[t]=0;for(this.vramAddress=null,this.vramTmpAddress=null,this.vramBufferedReadValue=0,this.firstWrite=!0,this.sramAddress=0,this.currentMirroring=-1,this.requestEndFrame=!1,this.nmiOk=!1,this.dummyCycleToggle=!1,this.validTileData=!1,this.nmiCounter=0,this.scanlineAlreadyRendered=null,this.f_nmiOnVblank=0,this.f_spriteSize=0,this.f_bgPatternTable=0,this.f_spPatternTable=0,this.f_addrInc=0,this.f_nTblAddress=0,this.f_color=0,this.f_spVisibility=0,this.f_bgVisibility=0,this.f_spClipping=0,this.f_bgClipping=0,this.f_dispType=0,this.cntFV=0,this.cntV=0,this.cntH=0,this.cntVT=0,this.cntHT=0,this.regFV=0,this.regV=0,this.regH=0,this.regVT=0,this.regHT=0,this.regFH=0,this.regS=0,this.curNt=null,this.attrib=new Array(32),this.buffer=new Array(256*240),this.bgbuffer=new Array(256*240),this.pixrendered=new Array(256*240),this.validTileData=null,this.scantile=new Array(32),this.scanline=0,this.lastRenderedScanline=-1,this.curX=0,this.sprX=new Array(64),this.sprY=new Array(64),this.sprTile=new Array(64),this.sprCol=new Array(64),this.vertFlip=new Array(64),this.horiFlip=new Array(64),this.bgPriority=new Array(64),this.spr0HitX=0,this.spr0HitY=0,this.hitSpr0=!1,this.sprPalette=new Array(16),this.imgPalette=new Array(16),this.ptTile=new Array(512),t=0;t<512;t++)this.ptTile[t]=new ac;for(this.ntable1=new Array(4),this.currentMirroring=-1,this.nameTable=new Array(4),t=0;t<4;t++)this.nameTable[t]=new sh(32,32,"Nt"+t);for(this.vramMirrorTable=new Array(32768),t=0;t<32768;t++)this.vramMirrorTable[t]=t;this.palTable=new ih,this.palTable.loadNTSCPalette(),this.updateControlReg1(0),this.updateControlReg2(0)},setMirroring:function(t){if(t!==this.currentMirroring){this.currentMirroring=t,this.triggerRendering(),this.vramMirrorTable===null&&(this.vramMirrorTable=new Array(32768));for(var e=0;e<32768;e++)this.vramMirrorTable[e]=e;this.defineMirrorRegion(16160,16128,32),this.defineMirrorRegion(16192,16128,32),this.defineMirrorRegion(16256,16128,32),this.defineMirrorRegion(16320,16128,32),this.defineMirrorRegion(12288,8192,3840),this.defineMirrorRegion(16384,0,16384),t===this.nes.rom.HORIZONTAL_MIRRORING?(this.ntable1[0]=0,this.ntable1[1]=0,this.ntable1[2]=1,this.ntable1[3]=1,this.defineMirrorRegion(9216,8192,1024),this.defineMirrorRegion(11264,10240,1024)):t===this.nes.rom.VERTICAL_MIRRORING?(this.ntable1[0]=0,this.ntable1[1]=1,this.ntable1[2]=0,this.ntable1[3]=1,this.defineMirrorRegion(10240,8192,1024),this.defineMirrorRegion(11264,9216,1024)):t===this.nes.rom.SINGLESCREEN_MIRRORING?(this.ntable1[0]=0,this.ntable1[1]=0,this.ntable1[2]=0,this.ntable1[3]=0,this.defineMirrorRegion(9216,8192,1024),this.defineMirrorRegion(10240,8192,1024),this.defineMirrorRegion(11264,8192,1024)):t===this.nes.rom.SINGLESCREEN_MIRRORING2?(this.ntable1[0]=1,this.ntable1[1]=1,this.ntable1[2]=1,this.ntable1[3]=1,this.defineMirrorRegion(9216,9216,1024),this.defineMirrorRegion(10240,9216,1024),this.defineMirrorRegion(11264,9216,1024)):(this.ntable1[0]=0,this.ntable1[1]=1,this.ntable1[2]=2,this.ntable1[3]=3)}},defineMirrorRegion:function(t,e,s){for(var i=0;i<s;i++)this.vramMirrorTable[t+i]=e+i},startVBlank:function(){this.nes.cpu.requestIrq(this.nes.cpu.IRQ_NMI),this.lastRenderedScanline<239&&this.renderFramePartially(this.lastRenderedScanline+1,240-this.lastRenderedScanline),this.endFrame(),this.lastRenderedScanline=-1},endScanline:function(){switch(this.scanline){case 19:this.dummyCycleToggle&&(this.curX=1,this.dummyCycleToggle=!this.dummyCycleToggle);break;case 20:this.setStatusFlag(this.STATUS_VBLANK,!1),this.setStatusFlag(this.STATUS_SPRITE0HIT,!1),this.hitSpr0=!1,this.spr0HitX=-1,this.spr0HitY=-1,(this.f_bgVisibility===1||this.f_spVisibility===1)&&(this.cntFV=this.regFV,this.cntV=this.regV,this.cntH=this.regH,this.cntVT=this.regVT,this.cntHT=this.regHT,this.f_bgVisibility===1&&this.renderBgScanline(!1,0)),this.f_bgVisibility===1&&this.f_spVisibility===1&&this.checkSprite0(0),(this.f_bgVisibility===1||this.f_spVisibility===1)&&this.nes.mmap.clockIrqCounter();break;case 261:this.setStatusFlag(this.STATUS_VBLANK,!0),this.requestEndFrame=!0,this.nmiCounter=9,this.scanline=-1;break;default:this.scanline>=21&&this.scanline<=260&&(this.f_bgVisibility===1&&(this.scanlineAlreadyRendered||(this.cntHT=this.regHT,this.cntH=this.regH,this.renderBgScanline(!0,this.scanline+1-21)),this.scanlineAlreadyRendered=!1,!this.hitSpr0&&this.f_spVisibility===1&&this.sprX[0]>=-7&&this.sprX[0]<256&&this.sprY[0]+1<=this.scanline-20&&this.sprY[0]+1+(this.f_spriteSize===0?8:16)>=this.scanline-20&&this.checkSprite0(this.scanline-20)&&(this.hitSpr0=!0)),(this.f_bgVisibility===1||this.f_spVisibility===1)&&this.nes.mmap.clockIrqCounter())}this.scanline++,this.regsToAddress(),this.cntsToAddress()},startFrame:function(){var t=0;if(this.f_dispType===0)t=this.imgPalette[0];else switch(this.f_color){case 0:t=0;break;case 1:t=65280;break;case 2:t=16711680;break;case 3:t=0;break;case 4:t=255;break;default:t=0}var e=this.buffer,s;for(s=0;s<256*240;s++)e[s]=t;var i=this.pixrendered;for(s=0;s<i.length;s++)i[s]=65},endFrame:function(){var t,e,s,i=this.buffer;if(this.showSpr0Hit){if(this.sprX[0]>=0&&this.sprX[0]<256&&this.sprY[0]>=0&&this.sprY[0]<240){for(t=0;t<256;t++)i[(this.sprY[0]<<8)+t]=16733525;for(t=0;t<240;t++)i[(t<<8)+this.sprX[0]]=16733525}if(this.spr0HitX>=0&&this.spr0HitX<256&&this.spr0HitY>=0&&this.spr0HitY<240){for(t=0;t<256;t++)i[(this.spr0HitY<<8)+t]=5635925;for(t=0;t<240;t++)i[(t<<8)+this.spr0HitX]=5635925}}if(this.clipToTvSize||this.f_bgClipping===0||this.f_spClipping===0)for(s=0;s<240;s++)for(e=0;e<8;e++)i[(s<<8)+e]=0;if(this.clipToTvSize)for(s=0;s<240;s++)for(e=0;e<8;e++)i[(s<<8)+255-e]=0;if(this.clipToTvSize)for(s=0;s<8;s++)for(e=0;e<256;e++)i[(s<<8)+e]=0,i[(239-s<<8)+e]=0;this.nes.ui.writeFrame(i)},updateControlReg1:function(t){this.triggerRendering(),this.f_nmiOnVblank=t>>7&1,this.f_spriteSize=t>>5&1,this.f_bgPatternTable=t>>4&1,this.f_spPatternTable=t>>3&1,this.f_addrInc=t>>2&1,this.f_nTblAddress=t&3,this.regV=t>>1&1,this.regH=t&1,this.regS=t>>4&1},updateControlReg2:function(t){this.triggerRendering(),this.f_color=t>>5&7,this.f_spVisibility=t>>4&1,this.f_bgVisibility=t>>3&1,this.f_spClipping=t>>2&1,this.f_bgClipping=t>>1&1,this.f_dispType=t&1,this.f_dispType===0&&this.palTable.setEmphasis(this.f_color),this.updatePalettes()},setStatusFlag:function(t,e){var s=1<<t;this.nes.cpu.mem[8194]=this.nes.cpu.mem[8194]&255-s|(e?s:0)},readStatusRegister:function(){var t=this.nes.cpu.mem[8194];return this.firstWrite=!0,this.setStatusFlag(this.STATUS_VBLANK,!1),t},writeSRAMAddress:function(t){this.sramAddress=t},sramLoad:function(){return this.spriteMem[this.sramAddress]},sramWrite:function(t){this.spriteMem[this.sramAddress]=t,this.spriteRamWriteUpdate(this.sramAddress,t),this.sramAddress++,this.sramAddress%=256},scrollWrite:function(t){this.triggerRendering(),this.firstWrite?(this.regHT=t>>3&31,this.regFH=t&7):(this.regFV=t&7,this.regVT=t>>3&31),this.firstWrite=!this.firstWrite},writeVRAMAddress:function(t){this.firstWrite?(this.regFV=t>>4&3,this.regV=t>>3&1,this.regH=t>>2&1,this.regVT=this.regVT&7|(t&3)<<3):(this.triggerRendering(),this.regVT=this.regVT&24|t>>5&7,this.regHT=t&31,this.cntFV=this.regFV,this.cntV=this.regV,this.cntH=this.regH,this.cntVT=this.regVT,this.cntHT=this.regHT,this.checkSprite0(this.scanline-20)),this.firstWrite=!this.firstWrite,this.cntsToAddress(),this.vramAddress<8192&&this.nes.mmap.latchAccess(this.vramAddress)},vramLoad:function(){var t;return this.cntsToAddress(),this.regsToAddress(),this.vramAddress<=16127?(t=this.vramBufferedReadValue,this.vramAddress<8192?this.vramBufferedReadValue=this.vramMem[this.vramAddress]:this.vramBufferedReadValue=this.mirroredLoad(this.vramAddress),this.vramAddress<8192&&this.nes.mmap.latchAccess(this.vramAddress),this.vramAddress+=this.f_addrInc===1?32:1,this.cntsFromAddress(),this.regsFromAddress(),t):(t=this.mirroredLoad(this.vramAddress),this.vramAddress+=this.f_addrInc===1?32:1,this.cntsFromAddress(),this.regsFromAddress(),t)},vramWrite:function(t){this.triggerRendering(),this.cntsToAddress(),this.regsToAddress(),this.vramAddress>=8192?this.mirroredWrite(this.vramAddress,t):(this.writeMem(this.vramAddress,t),this.nes.mmap.latchAccess(this.vramAddress)),this.vramAddress+=this.f_addrInc===1?32:1,this.regsFromAddress(),this.cntsFromAddress()},sramDMA:function(t){for(var e=t*256,s,i=this.sramAddress;i<256;i++)s=this.nes.cpu.mem[e+i],this.spriteMem[i]=s,this.spriteRamWriteUpdate(i,s);this.nes.cpu.haltCycles(513)},regsFromAddress:function(){var t=this.vramTmpAddress>>8&255;this.regFV=t>>4&7,this.regV=t>>3&1,this.regH=t>>2&1,this.regVT=this.regVT&7|(t&3)<<3,t=this.vramTmpAddress&255,this.regVT=this.regVT&24|t>>5&7,this.regHT=t&31},cntsFromAddress:function(){var t=this.vramAddress>>8&255;this.cntFV=t>>4&3,this.cntV=t>>3&1,this.cntH=t>>2&1,this.cntVT=this.cntVT&7|(t&3)<<3,t=this.vramAddress&255,this.cntVT=this.cntVT&24|t>>5&7,this.cntHT=t&31},regsToAddress:function(){var t=(this.regFV&7)<<4;t|=(this.regV&1)<<3,t|=(this.regH&1)<<2,t|=this.regVT>>3&3;var e=(this.regVT&7)<<5;e|=this.regHT&31,this.vramTmpAddress=(t<<8|e)&32767},cntsToAddress:function(){var t=(this.cntFV&7)<<4;t|=(this.cntV&1)<<3,t|=(this.cntH&1)<<2,t|=this.cntVT>>3&3;var e=(this.cntVT&7)<<5;e|=this.cntHT&31,this.vramAddress=(t<<8|e)&32767},incTileCounter:function(t){for(var e=t;e!==0;e--)this.cntHT++,this.cntHT===32&&(this.cntHT=0,this.cntVT++,this.cntVT>=30&&(this.cntH++,this.cntH===2&&(this.cntH=0,this.cntV++,this.cntV===2&&(this.cntV=0,this.cntFV++,this.cntFV&=7))))},mirroredLoad:function(t){return this.vramMem[this.vramMirrorTable[t]]},mirroredWrite:function(t,e){if(t>=16128&&t<16160)t===16128||t===16144?(this.writeMem(16128,e),this.writeMem(16144,e)):t===16132||t===16148?(this.writeMem(16132,e),this.writeMem(16148,e)):t===16136||t===16152?(this.writeMem(16136,e),this.writeMem(16152,e)):t===16140||t===16156?(this.writeMem(16140,e),this.writeMem(16156,e)):this.writeMem(t,e);else if(t<this.vramMirrorTable.length)this.writeMem(this.vramMirrorTable[t],e);else throw new Error("Invalid VRAM address: "+t.toString(16))},triggerRendering:function(){this.scanline>=21&&this.scanline<=260&&(this.renderFramePartially(this.lastRenderedScanline+1,this.scanline-21-this.lastRenderedScanline),this.lastRenderedScanline=this.scanline-21)},renderFramePartially:function(t,e){if(this.f_spVisibility===1&&this.renderSpritesPartially(t,e,!0),this.f_bgVisibility===1){var s=t<<8,i=t+e<<8;i>61440&&(i=61440);for(var n=this.buffer,r=this.bgbuffer,o=this.pixrendered,h=s;h<i;h++)o[h]>255&&(n[h]=r[h])}this.f_spVisibility===1&&this.renderSpritesPartially(t,e,!1),this.validTileData=!1},renderBgScanline:function(t,e){var s=this.regS===0?0:256,i=(e<<8)-this.regFH;if(this.curNt=this.ntable1[this.cntV+this.cntV+this.cntH],this.cntHT=this.regHT,this.cntH=this.regH,this.curNt=this.ntable1[this.cntV+this.cntV+this.cntH],e<240&&e-this.cntFV>=0){for(var n=this.cntFV<<3,r=this.scantile,o=this.attrib,h=this.ptTile,a=this.nameTable,u=this.imgPalette,c=this.pixrendered,p=t?this.bgbuffer:this.buffer,d,A,v,w,k=0;k<32;k++){if(e>=0){if(this.validTileData){if(d=r[k],typeof d>"u")continue;A=d.pix,v=o[k]}else{if(d=h[s+a[this.curNt].getTileIndex(this.cntHT,this.cntVT)],typeof d>"u")continue;A=d.pix,v=a[this.curNt].getAttrib(this.cntHT,this.cntVT),r[k]=d,o[k]=v}var M=0,F=(k<<3)-this.regFH;if(F>-8)if(F<0&&(i-=F,M=-F),d.opaque[this.cntFV])for(;M<8;M++)p[i]=u[A[n+M]+v],c[i]|=256,i++;else for(;M<8;M++)w=A[n+M],w!==0&&(p[i]=u[w+v],c[i]|=256),i++}++this.cntHT===32&&(this.cntHT=0,this.cntH++,this.cntH%=2,this.curNt=this.ntable1[(this.cntV<<1)+this.cntH])}this.validTileData=!0}this.cntFV++,this.cntFV===8&&(this.cntFV=0,this.cntVT++,this.cntVT===30?(this.cntVT=0,this.cntV++,this.cntV%=2,this.curNt=this.ntable1[(this.cntV<<1)+this.cntH]):this.cntVT===32&&(this.cntVT=0),this.validTileData=!1)},renderSpritesPartially:function(t,e,s){if(this.f_spVisibility===1){for(var i=0;i<64;i++)if(this.bgPriority[i]===s&&this.sprX[i]>=0&&this.sprX[i]<256&&this.sprY[i]+8>=t&&this.sprY[i]<t+e)if(this.f_spriteSize===0)this.srcy1=0,this.srcy2=8,this.sprY[i]<t&&(this.srcy1=t-this.sprY[i]-1),this.sprY[i]+8>t+e&&(this.srcy2=t+e-this.sprY[i]+1),this.f_spPatternTable===0?this.ptTile[this.sprTile[i]].render(this.buffer,0,this.srcy1,8,this.srcy2,this.sprX[i],this.sprY[i]+1,this.sprCol[i],this.sprPalette,this.horiFlip[i],this.vertFlip[i],i,this.pixrendered):this.ptTile[this.sprTile[i]+256].render(this.buffer,0,this.srcy1,8,this.srcy2,this.sprX[i],this.sprY[i]+1,this.sprCol[i],this.sprPalette,this.horiFlip[i],this.vertFlip[i],i,this.pixrendered);else{var n=this.sprTile[i];n&1&&(n=this.sprTile[i]-1+256);var r=0,o=8;this.sprY[i]<t&&(r=t-this.sprY[i]-1),this.sprY[i]+8>t+e&&(o=t+e-this.sprY[i]),this.ptTile[n+(this.vertFlip[i]?1:0)].render(this.buffer,0,r,8,o,this.sprX[i],this.sprY[i]+1,this.sprCol[i],this.sprPalette,this.horiFlip[i],this.vertFlip[i],i,this.pixrendered),r=0,o=8,this.sprY[i]+8<t&&(r=t-(this.sprY[i]+8+1)),this.sprY[i]+16>t+e&&(o=t+e-(this.sprY[i]+8)),this.ptTile[n+(this.vertFlip[i]?0:1)].render(this.buffer,0,r,8,o,this.sprX[i],this.sprY[i]+1+8,this.sprCol[i],this.sprPalette,this.horiFlip[i],this.vertFlip[i],i,this.pixrendered)}}},checkSprite0:function(t){this.spr0HitX=-1,this.spr0HitY=-1;var e,s=this.f_spPatternTable===0?0:256,i,n,r,o,h;if(i=this.sprX[0],n=this.sprY[0]+1,this.f_spriteSize===0){if(n<=t&&n+8>t&&i>=-7&&i<256)if(r=this.ptTile[this.sprTile[0]+s],this.vertFlip[0]?e=7-(t-n):e=t-n,e*=8,h=t*256+i,this.horiFlip[0])for(o=7;o>=0;o--){if(i>=0&&i<256&&h>=0&&h<61440&&this.pixrendered[h]!==0&&r.pix[e+o]!==0)return this.spr0HitX=h%256,this.spr0HitY=t,!0;i++,h++}else for(o=0;o<8;o++){if(i>=0&&i<256&&h>=0&&h<61440&&this.pixrendered[h]!==0&&r.pix[e+o]!==0)return this.spr0HitX=h%256,this.spr0HitY=t,!0;i++,h++}}else if(n<=t&&n+16>t&&i>=-7&&i<256)if(this.vertFlip[0]?e=15-(t-n):e=t-n,e<8?r=this.ptTile[this.sprTile[0]+(this.vertFlip[0]?1:0)+(this.sprTile[0]&1?255:0)]:(r=this.ptTile[this.sprTile[0]+(this.vertFlip[0]?0:1)+(this.sprTile[0]&1?255:0)],this.vertFlip[0]?e=15-e:e-=8),e*=8,h=t*256+i,this.horiFlip[0])for(o=7;o>=0;o--){if(i>=0&&i<256&&h>=0&&h<61440&&this.pixrendered[h]!==0&&r.pix[e+o]!==0)return this.spr0HitX=h%256,this.spr0HitY=t,!0;i++,h++}else for(o=0;o<8;o++){if(i>=0&&i<256&&h>=0&&h<61440&&this.pixrendered[h]!==0&&r.pix[e+o]!==0)return this.spr0HitX=h%256,this.spr0HitY=t,!0;i++,h++}return!1},writeMem:function(t,e){this.vramMem[t]=e,t<8192?(this.vramMem[t]=e,this.patternWrite(t,e)):t>=8192&&t<9152?this.nameTableWrite(this.ntable1[0],t-8192,e):t>=9152&&t<9216?this.attribTableWrite(this.ntable1[0],t-9152,e):t>=9216&&t<10176?this.nameTableWrite(this.ntable1[1],t-9216,e):t>=10176&&t<10240?this.attribTableWrite(this.ntable1[1],t-10176,e):t>=10240&&t<11200?this.nameTableWrite(this.ntable1[2],t-10240,e):t>=11200&&t<11264?this.attribTableWrite(this.ntable1[2],t-11200,e):t>=11264&&t<12224?this.nameTableWrite(this.ntable1[3],t-11264,e):t>=12224&&t<12288?this.attribTableWrite(this.ntable1[3],t-12224,e):t>=16128&&t<16160&&this.updatePalettes()},updatePalettes:function(){var t;for(t=0;t<16;t++)this.f_dispType===0?this.imgPalette[t]=this.palTable.getEntry(this.vramMem[16128+t]&63):this.imgPalette[t]=this.palTable.getEntry(this.vramMem[16128+t]&32);for(t=0;t<16;t++)this.f_dispType===0?this.sprPalette[t]=this.palTable.getEntry(this.vramMem[16144+t]&63):this.sprPalette[t]=this.palTable.getEntry(this.vramMem[16144+t]&32)},patternWrite:function(t,e){var s=Math.floor(t/16),i=t%16;i<8?this.ptTile[s].setScanline(i,e,this.vramMem[t+8]):this.ptTile[s].setScanline(i-8,this.vramMem[t-8],e)},nameTableWrite:function(t,e,s){this.nameTable[t].tile[e]=s,this.checkSprite0(this.scanline-20)},attribTableWrite:function(t,e,s){this.nameTable[t].writeAttrib(e,s)},spriteRamWriteUpdate:function(t,e){var s=Math.floor(t/4);s===0&&this.checkSprite0(this.scanline-20),t%4===0?this.sprY[s]=e:t%4===1?this.sprTile[s]=e:t%4===2?(this.vertFlip[s]=(e&128)!==0,this.horiFlip[s]=(e&64)!==0,this.bgPriority[s]=(e&32)!==0,this.sprCol[s]=(e&3)<<2):t%4===3&&(this.sprX[s]=e)},doNMI:function(){this.setStatusFlag(this.STATUS_VBLANK,!0),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_NMI)},isPixelWhite:function(t,e){return this.triggerRendering(),this.nes.ppu.buffer[(e<<8)+t]===16777215},JSON_PROPERTIES:["vramMem","spriteMem","cntFV","cntV","cntH","cntVT","cntHT","regFV","regV","regH","regVT","regHT","regFH","regS","vramAddress","vramTmpAddress","f_nmiOnVblank","f_spriteSize","f_bgPatternTable","f_spPatternTable","f_addrInc","f_nTblAddress","f_color","f_spVisibility","f_bgVisibility","f_spClipping","f_bgClipping","f_dispType","vramBufferedReadValue","firstWrite","currentMirroring","vramMirrorTable","ntable1","sramAddress","hitSpr0","sprPalette","imgPalette","curX","scanline","lastRenderedScanline","curNt","scantile","attrib","buffer","bgbuffer","pixrendered","requestEndFrame","nmiOk","dummyCycleToggle","nmiCounter","validTileData","scanlineAlreadyRendered"],toJSON:function(){var t,e=_r.toJSON(this);for(e.nameTable=[],t=0;t<this.nameTable.length;t++)e.nameTable[t]=this.nameTable[t].toJSON();for(e.ptTile=[],t=0;t<this.ptTile.length;t++)e.ptTile[t]=this.ptTile[t].toJSON();return e},fromJSON:function(t){var e;for(_r.fromJSON(this,t),e=0;e<this.nameTable.length;e++)this.nameTable[e].fromJSON(t.nameTable[e]);for(e=0;e<this.ptTile.length;e++)this.ptTile[e].fromJSON(t.ptTile[e]);for(e=0;e<this.spriteMem.length;e++)this.spriteRamWriteUpdate(e,this.spriteMem[e])}};var sh=function(t,e,s){this.width=t,this.height=e,this.name=s,this.tile=new Array(t*e),this.attrib=new Array(t*e);for(var i=0;i<t*e;i++)this.tile[i]=0,this.attrib[i]=0};sh.prototype={getTileIndex:function(t,e){return this.tile[e*this.width+t]},getAttrib:function(t,e){return this.attrib[e*this.width+t]},writeAttrib:function(t,e){for(var s=t%8*4,i=Math.floor(t/8)*4,n,r,o,h,a=0;a<2;a++)for(var u=0;u<2;u++){n=e>>2*(a*2+u)&3;for(var c=0;c<2;c++)for(var p=0;p<2;p++)r=s+u*2+p,o=i+a*2+c,h=o*this.width+r,this.attrib[h]=n<<2&12}},toJSON:function(){return{tile:this.tile,attrib:this.attrib}},fromJSON:function(t){this.tile=t.tile,this.attrib=t.attrib}};var ih=function(){this.curTable=new Array(64),this.emphTable=new Array(8),this.currentEmph=-1};ih.prototype={reset:function(){this.setEmphasis(0)},loadNTSCPalette:function(){this.curTable=[5395026,11796480,10485760,11599933,7602281,91,95,6208,12048,543240,26368,1196544,7153664,0,0,0,12899815,16728064,14421538,16729963,14090399,6818519,6588,21681,27227,35843,43776,2918400,10777088,0,0,0,16316664,16755516,16742785,16735173,16730354,14633471,4681215,46327,57599,58229,259115,7911470,15065624,7895160,0,0,16777215,16773822,16300216,16300248,16758527,16761855,13095423,10148607,8973816,8650717,12122296,16119980,16777136,16308472,0,0],this.makeTables(),this.setEmphasis(0)},loadPALPalette:function(){this.curTable=[5395026,11796480,10485760,11599933,7602281,91,95,6208,12048,543240,26368,1196544,7153664,0,0,0,12899815,16728064,14421538,16729963,14090399,6818519,6588,21681,27227,35843,43776,2918400,10777088,0,0,0,16316664,16755516,16742785,16735173,16730354,14633471,4681215,46327,57599,58229,259115,7911470,15065624,7895160,0,0,16777215,16773822,16300216,16300248,16758527,16761855,13095423,10148607,8973816,8650717,12122296,16119980,16777136,16308472,0,0],this.makeTables(),this.setEmphasis(0)},makeTables:function(){for(var t,e,s,i,n,r,o,h,a=0;a<8;a++)for(r=1,o=1,h=1,a&1&&(r=.75,h=.75),a&2&&(r=.75,o=.75),a&4&&(o=.75,h=.75),this.emphTable[a]=new Array(64),n=0;n<64;n++)i=this.curTable[n],t=Math.floor(this.getRed(i)*r),e=Math.floor(this.getGreen(i)*o),s=Math.floor(this.getBlue(i)*h),this.emphTable[a][n]=this.getRgb(t,e,s)},setEmphasis:function(t){if(t!==this.currentEmph){this.currentEmph=t;for(var e=0;e<64;e++)this.curTable[e]=this.emphTable[t][e]}},getEntry:function(t){return this.curTable[t]},getRed:function(t){return t>>16&255},getGreen:function(t){return t>>8&255},getBlue:function(t){return t&255},getRgb:function(t,e,s){return t<<16|e<<8|s},loadDefaultPalette:function(){this.curTable[0]=this.getRgb(117,117,117),this.curTable[1]=this.getRgb(39,27,143),this.curTable[2]=this.getRgb(0,0,171),this.curTable[3]=this.getRgb(71,0,159),this.curTable[4]=this.getRgb(143,0,119),this.curTable[5]=this.getRgb(171,0,19),this.curTable[6]=this.getRgb(167,0,0),this.curTable[7]=this.getRgb(127,11,0),this.curTable[8]=this.getRgb(67,47,0),this.curTable[9]=this.getRgb(0,71,0),this.curTable[10]=this.getRgb(0,81,0),this.curTable[11]=this.getRgb(0,63,23),this.curTable[12]=this.getRgb(27,63,95),this.curTable[13]=this.getRgb(0,0,0),this.curTable[14]=this.getRgb(0,0,0),this.curTable[15]=this.getRgb(0,0,0),this.curTable[16]=this.getRgb(188,188,188),this.curTable[17]=this.getRgb(0,115,239),this.curTable[18]=this.getRgb(35,59,239),this.curTable[19]=this.getRgb(131,0,243),this.curTable[20]=this.getRgb(191,0,191),this.curTable[21]=this.getRgb(231,0,91),this.curTable[22]=this.getRgb(219,43,0),this.curTable[23]=this.getRgb(203,79,15),this.curTable[24]=this.getRgb(139,115,0),this.curTable[25]=this.getRgb(0,151,0),this.curTable[26]=this.getRgb(0,171,0),this.curTable[27]=this.getRgb(0,147,59),this.curTable[28]=this.getRgb(0,131,139),this.curTable[29]=this.getRgb(0,0,0),this.curTable[30]=this.getRgb(0,0,0),this.curTable[31]=this.getRgb(0,0,0),this.curTable[32]=this.getRgb(255,255,255),this.curTable[33]=this.getRgb(63,191,255),this.curTable[34]=this.getRgb(95,151,255),this.curTable[35]=this.getRgb(167,139,253),this.curTable[36]=this.getRgb(247,123,255),this.curTable[37]=this.getRgb(255,119,183),this.curTable[38]=this.getRgb(255,119,99),this.curTable[39]=this.getRgb(255,155,59),this.curTable[40]=this.getRgb(243,191,63),this.curTable[41]=this.getRgb(131,211,19),this.curTable[42]=this.getRgb(79,223,75),this.curTable[43]=this.getRgb(88,248,152),this.curTable[44]=this.getRgb(0,235,219),this.curTable[45]=this.getRgb(0,0,0),this.curTable[46]=this.getRgb(0,0,0),this.curTable[47]=this.getRgb(0,0,0),this.curTable[48]=this.getRgb(255,255,255),this.curTable[49]=this.getRgb(171,231,255),this.curTable[50]=this.getRgb(199,215,255),this.curTable[51]=this.getRgb(215,203,255),this.curTable[52]=this.getRgb(255,199,255),this.curTable[53]=this.getRgb(255,199,219),this.curTable[54]=this.getRgb(255,191,179),this.curTable[55]=this.getRgb(255,219,171),this.curTable[56]=this.getRgb(255,231,163),this.curTable[57]=this.getRgb(227,255,163),this.curTable[58]=this.getRgb(171,243,191),this.curTable[59]=this.getRgb(179,255,207),this.curTable[60]=this.getRgb(159,255,243),this.curTable[61]=this.getRgb(0,0,0),this.curTable[62]=this.getRgb(0,0,0),this.curTable[63]=this.getRgb(0,0,0),this.makeTables(),this.setEmphasis(0)}};var lc=eh,uc=17897725e-1,nh=function(t){this.nes=t,this.square1=new Vi(this,!0),this.square2=new Vi(this,!1),this.triangle=new hh(this),this.noise=new oh(this),this.dmc=new rh(this),this.frameIrqCounter=null,this.frameIrqCounterMax=4,this.initCounter=2048,this.channelEnableValue=null,this.sampleRate=44100,this.lengthLookup=null,this.dmcFreqLookup=null,this.noiseWavelengthLookup=null,this.square_table=null,this.tnd_table=null,this.frameIrqEnabled=!1,this.frameIrqActive=null,this.frameClockNow=null,this.startedPlaying=!1,this.recordOutput=!1,this.initingHardware=!1,this.masterFrameCounter=null,this.derivedFrameCounter=null,this.countSequence=null,this.sampleTimer=null,this.frameTime=null,this.sampleTimerMax=null,this.sampleCount=null,this.triValue=0,this.smpSquare1=null,this.smpSquare2=null,this.smpTriangle=null,this.smpDmc=null,this.accCount=null,this.prevSampleL=0,this.prevSampleR=0,this.smpAccumL=0,this.smpAccumR=0,this.dacRange=0,this.dcValue=0,this.masterVolume=256,this.stereoPosLSquare1=null,this.stereoPosLSquare2=null,this.stereoPosLTriangle=null,this.stereoPosLNoise=null,this.stereoPosLDMC=null,this.stereoPosRSquare1=null,this.stereoPosRSquare2=null,this.stereoPosRTriangle=null,this.stereoPosRNoise=null,this.stereoPosRDMC=null,this.extraCycles=null,this.maxSample=null,this.minSample=null,this.panning=[80,170,100,150,128],this.setPanning(this.panning),this.initLengthLookup(),this.initDmcFrequencyLookup(),this.initNoiseWavelengthLookup(),this.initDACtables();for(var e=0;e<20;e++)e===16?this.writeReg(16400,16):this.writeReg(16384+e,0);this.reset()};nh.prototype={reset:function(){this.sampleRate=this.nes.opts.sampleRate,this.sampleTimerMax=Math.floor(1024*uc*this.nes.opts.preferredFrameRate/(this.sampleRate*60)),this.frameTime=Math.floor(14915*this.nes.opts.preferredFrameRate/60),this.sampleTimer=0,this.updateChannelEnable(0),this.masterFrameCounter=0,this.derivedFrameCounter=0,this.countSequence=0,this.sampleCount=0,this.initCounter=2048,this.frameIrqEnabled=!1,this.initingHardware=!1,this.resetCounter(),this.square1.reset(),this.square2.reset(),this.triangle.reset(),this.noise.reset(),this.dmc.reset(),this.accCount=0,this.smpSquare1=0,this.smpSquare2=0,this.smpTriangle=0,this.smpDmc=0,this.frameIrqEnabled=!1,this.frameIrqCounterMax=4,this.channelEnableValue=255,this.startedPlaying=!1,this.prevSampleL=0,this.prevSampleR=0,this.smpAccumL=0,this.smpAccumR=0,this.maxSample=-5e5,this.minSample=5e5},readReg:function(t){var e=0;return e|=this.square1.getLengthStatus(),e|=this.square2.getLengthStatus()<<1,e|=this.triangle.getLengthStatus()<<2,e|=this.noise.getLengthStatus()<<3,e|=this.dmc.getLengthStatus()<<4,e|=(this.frameIrqActive&&this.frameIrqEnabled?1:0)<<6,e|=this.dmc.getIrqStatus()<<7,this.frameIrqActive=!1,this.dmc.irqGenerated=!1,e&65535},writeReg:function(t,e){t>=16384&&t<16388?this.square1.writeReg(t,e):t>=16388&&t<16392?this.square2.writeReg(t,e):t>=16392&&t<16396?this.triangle.writeReg(t,e):t>=16396&&t<=16399?this.noise.writeReg(t,e):t===16400?this.dmc.writeReg(t,e):t===16401?this.dmc.writeReg(t,e):t===16402?this.dmc.writeReg(t,e):t===16403?this.dmc.writeReg(t,e):t===16405?(this.updateChannelEnable(e),e!==0&&this.initCounter>0&&(this.initingHardware=!0),this.dmc.writeReg(t,e)):t===16407&&(this.countSequence=e>>7&1,this.masterFrameCounter=0,this.frameIrqActive=!1,e>>6&1?this.frameIrqEnabled=!1:this.frameIrqEnabled=!0,this.countSequence===0?(this.frameIrqCounterMax=4,this.derivedFrameCounter=4):(this.frameIrqCounterMax=5,this.derivedFrameCounter=0,this.frameCounterTick()))},resetCounter:function(){this.countSequence===0?this.derivedFrameCounter=4:this.derivedFrameCounter=0},updateChannelEnable:function(t){this.channelEnableValue=t&65535,this.square1.setEnabled((t&1)!==0),this.square2.setEnabled((t&2)!==0),this.triangle.setEnabled((t&4)!==0),this.noise.setEnabled((t&8)!==0),this.dmc.setEnabled((t&16)!==0)},clockFrameCounter:function(t){if(this.initCounter>0&&this.initingHardware){this.initCounter-=t,this.initCounter<=0&&(this.initingHardware=!1);return}t+=this.extraCycles;var e=this.sampleTimerMax-this.sampleTimer;t<<10>e?(this.extraCycles=(t<<10)-e>>10,t-=this.extraCycles):this.extraCycles=0;var s=this.dmc,i=this.triangle,n=this.square1,r=this.square2,o=this.noise;if(s.isEnabled)for(s.shiftCounter-=t<<3;s.shiftCounter<=0&&s.dmaFrequency>0;)s.shiftCounter+=s.dmaFrequency,s.clockDmc();if(i.progTimerMax>0)for(i.progTimerCount-=t;i.progTimerCount<=0;)i.progTimerCount+=i.progTimerMax+1,i.linearCounter>0&&i.lengthCounter>0&&(i.triangleCounter++,i.triangleCounter&=31,i.isEnabled&&(i.triangleCounter>=16?i.sampleValue=i.triangleCounter&15:i.sampleValue=15-(i.triangleCounter&15),i.sampleValue<<=4));n.progTimerCount-=t,n.progTimerCount<=0&&(n.progTimerCount+=n.progTimerMax+1<<1,n.squareCounter++,n.squareCounter&=7,n.updateSampleValue()),r.progTimerCount-=t,r.progTimerCount<=0&&(r.progTimerCount+=r.progTimerMax+1<<1,r.squareCounter++,r.squareCounter&=7,r.updateSampleValue());var h=t;if(o.progTimerCount-h>0)o.progTimerCount-=h,o.accCount+=h,o.accValue+=h*o.sampleValue;else for(;h-- >0;)--o.progTimerCount<=0&&o.progTimerMax>0&&(o.shiftReg<<=1,o.tmp=(o.shiftReg<<(o.randomMode===0?1:6)^o.shiftReg)&32768,o.tmp!==0?(o.shiftReg|=1,o.randomBit=0,o.sampleValue=0):(o.randomBit=1,o.isEnabled&&o.lengthCounter>0?o.sampleValue=o.masterVolume:o.sampleValue=0),o.progTimerCount+=o.progTimerMax),o.accValue+=o.sampleValue,o.accCount++;this.frameIrqEnabled&&this.frameIrqActive&&this.nes.cpu.requestIrq(this.nes.cpu.IRQ_NORMAL),this.masterFrameCounter+=t<<1,this.masterFrameCounter>=this.frameTime&&(this.masterFrameCounter-=this.frameTime,this.frameCounterTick()),this.accSample(t),this.sampleTimer+=t<<10,this.sampleTimer>=this.sampleTimerMax&&(this.sample(),this.sampleTimer-=this.sampleTimerMax)},accSample:function(t){this.triangle.sampleCondition&&(this.triValue=Math.floor((this.triangle.progTimerCount<<4)/(this.triangle.progTimerMax+1)),this.triValue>16&&(this.triValue=16),this.triangle.triangleCounter>=16&&(this.triValue=16-this.triValue),this.triValue+=this.triangle.sampleValue),t===2?(this.smpTriangle+=this.triValue<<1,this.smpDmc+=this.dmc.sample<<1,this.smpSquare1+=this.square1.sampleValue<<1,this.smpSquare2+=this.square2.sampleValue<<1,this.accCount+=2):t===4?(this.smpTriangle+=this.triValue<<2,this.smpDmc+=this.dmc.sample<<2,this.smpSquare1+=this.square1.sampleValue<<2,this.smpSquare2+=this.square2.sampleValue<<2,this.accCount+=4):(this.smpTriangle+=t*this.triValue,this.smpDmc+=t*this.dmc.sample,this.smpSquare1+=t*this.square1.sampleValue,this.smpSquare2+=t*this.square2.sampleValue,this.accCount+=t)},frameCounterTick:function(){this.derivedFrameCounter++,this.derivedFrameCounter>=this.frameIrqCounterMax&&(this.derivedFrameCounter=0),(this.derivedFrameCounter===1||this.derivedFrameCounter===3)&&(this.triangle.clockLengthCounter(),this.square1.clockLengthCounter(),this.square2.clockLengthCounter(),this.noise.clockLengthCounter(),this.square1.clockSweep(),this.square2.clockSweep()),this.derivedFrameCounter>=0&&this.derivedFrameCounter<4&&(this.square1.clockEnvDecay(),this.square2.clockEnvDecay(),this.noise.clockEnvDecay(),this.triangle.clockLinearCounter()),this.derivedFrameCounter===3&&this.countSequence===0&&(this.frameIrqActive=!0)},sample:function(){var t,e;this.accCount>0?(this.smpSquare1<<=4,this.smpSquare1=Math.floor(this.smpSquare1/this.accCount),this.smpSquare2<<=4,this.smpSquare2=Math.floor(this.smpSquare2/this.accCount),this.smpTriangle=Math.floor(this.smpTriangle/this.accCount),this.smpDmc<<=4,this.smpDmc=Math.floor(this.smpDmc/this.accCount),this.accCount=0):(this.smpSquare1=this.square1.sampleValue<<4,this.smpSquare2=this.square2.sampleValue<<4,this.smpTriangle=this.triangle.sampleValue,this.smpDmc=this.dmc.sample<<4);var s=Math.floor((this.noise.accValue<<4)/this.noise.accCount);this.noise.accValue=s>>4,this.noise.accCount=1,t=this.smpSquare1*this.stereoPosLSquare1+this.smpSquare2*this.stereoPosLSquare2>>8,e=3*this.smpTriangle*this.stereoPosLTriangle+(s<<1)*this.stereoPosLNoise+this.smpDmc*this.stereoPosLDMC>>8,t>=this.square_table.length&&(t=this.square_table.length-1),e>=this.tnd_table.length&&(e=this.tnd_table.length-1);var i=this.square_table[t]+this.tnd_table[e]-this.dcValue;t=this.smpSquare1*this.stereoPosRSquare1+this.smpSquare2*this.stereoPosRSquare2>>8,e=3*this.smpTriangle*this.stereoPosRTriangle+(s<<1)*this.stereoPosRNoise+this.smpDmc*this.stereoPosRDMC>>8,t>=this.square_table.length&&(t=this.square_table.length-1),e>=this.tnd_table.length&&(e=this.tnd_table.length-1);var n=this.square_table[t]+this.tnd_table[e]-this.dcValue,r=i-this.prevSampleL;this.prevSampleL+=r,this.smpAccumL+=r-(this.smpAccumL>>10),i=this.smpAccumL;var o=n-this.prevSampleR;this.prevSampleR+=o,this.smpAccumR+=o-(this.smpAccumR>>10),n=this.smpAccumR,i>this.maxSample&&(this.maxSample=i),i<this.minSample&&(this.minSample=i),this.nes.opts.onAudioSample&&this.nes.opts.onAudioSample(i/32768,n/32768),this.smpSquare1=0,this.smpSquare2=0,this.smpTriangle=0,this.smpDmc=0},getLengthMax:function(t){return this.lengthLookup[t>>3]},getDmcFrequency:function(t){return t>=0&&t<16?this.dmcFreqLookup[t]:0},getNoiseWaveLength:function(t){return t>=0&&t<16?this.noiseWavelengthLookup[t]:0},setPanning:function(t){for(var e=0;e<5;e++)this.panning[e]=t[e];this.updateStereoPos()},setMasterVolume:function(t){t<0&&(t=0),t>256&&(t=256),this.masterVolume=t,this.updateStereoPos()},updateStereoPos:function(){this.stereoPosLSquare1=this.panning[0]*this.masterVolume>>8,this.stereoPosLSquare2=this.panning[1]*this.masterVolume>>8,this.stereoPosLTriangle=this.panning[2]*this.masterVolume>>8,this.stereoPosLNoise=this.panning[3]*this.masterVolume>>8,this.stereoPosLDMC=this.panning[4]*this.masterVolume>>8,this.stereoPosRSquare1=this.masterVolume-this.stereoPosLSquare1,this.stereoPosRSquare2=this.masterVolume-this.stereoPosLSquare2,this.stereoPosRTriangle=this.masterVolume-this.stereoPosLTriangle,this.stereoPosRNoise=this.masterVolume-this.stereoPosLNoise,this.stereoPosRDMC=this.masterVolume-this.stereoPosLDMC},initLengthLookup:function(){this.lengthLookup=[10,254,20,2,40,4,80,6,160,8,60,10,14,12,26,14,12,16,24,18,48,20,96,22,192,24,72,26,16,28,32,30]},initDmcFrequencyLookup:function(){this.dmcFreqLookup=new Array(16),this.dmcFreqLookup[0]=3424,this.dmcFreqLookup[1]=3040,this.dmcFreqLookup[2]=2720,this.dmcFreqLookup[3]=2560,this.dmcFreqLookup[4]=2288,this.dmcFreqLookup[5]=2032,this.dmcFreqLookup[6]=1808,this.dmcFreqLookup[7]=1712,this.dmcFreqLookup[8]=1520,this.dmcFreqLookup[9]=1280,this.dmcFreqLookup[10]=1136,this.dmcFreqLookup[11]=1024,this.dmcFreqLookup[12]=848,this.dmcFreqLookup[13]=672,this.dmcFreqLookup[14]=576,this.dmcFreqLookup[15]=432},initNoiseWavelengthLookup:function(){this.noiseWavelengthLookup=new Array(16),this.noiseWavelengthLookup[0]=4,this.noiseWavelengthLookup[1]=8,this.noiseWavelengthLookup[2]=16,this.noiseWavelengthLookup[3]=32,this.noiseWavelengthLookup[4]=64,this.noiseWavelengthLookup[5]=96,this.noiseWavelengthLookup[6]=128,this.noiseWavelengthLookup[7]=160,this.noiseWavelengthLookup[8]=202,this.noiseWavelengthLookup[9]=254,this.noiseWavelengthLookup[10]=380,this.noiseWavelengthLookup[11]=508,this.noiseWavelengthLookup[12]=762,this.noiseWavelengthLookup[13]=1016,this.noiseWavelengthLookup[14]=2034,this.noiseWavelengthLookup[15]=4068},initDACtables:function(){var t,e,s,i=0,n=0;for(this.square_table=new Array(32*16),this.tnd_table=new Array(204*16),s=0;s<32*16;s++)t=95.52/(8128/(s/16)+100),t*=.98411,t*=5e4,e=Math.floor(t),this.square_table[s]=e,e>i&&(i=e);for(s=0;s<204*16;s++)t=163.67/(24329/(s/16)+100),t*=.98411,t*=5e4,e=Math.floor(t),this.tnd_table[s]=e,e>n&&(n=e);this.dacRange=i+n,this.dcValue=this.dacRange/2}};var rh=function(t){this.papu=t,this.MODE_NORMAL=0,this.MODE_LOOP=1,this.MODE_IRQ=2,this.isEnabled=null,this.hasSample=null,this.irqGenerated=!1,this.playMode=null,this.dmaFrequency=null,this.dmaCounter=null,this.deltaCounter=null,this.playStartAddress=null,this.playAddress=null,this.playLength=null,this.playLengthCounter=null,this.shiftCounter=null,this.reg4012=null,this.reg4013=null,this.sample=null,this.dacLsb=null,this.data=null,this.reset()};rh.prototype={clockDmc:function(){this.hasSample&&(this.data&1?this.deltaCounter<63&&this.deltaCounter++:this.deltaCounter>0&&this.deltaCounter--,this.sample=this.isEnabled?(this.deltaCounter<<1)+this.dacLsb:0,this.data>>=1),this.dmaCounter--,this.dmaCounter<=0&&(this.hasSample=!1,this.endOfSample(),this.dmaCounter=8),this.irqGenerated&&this.papu.nes.cpu.requestIrq(this.papu.nes.cpu.IRQ_NORMAL)},endOfSample:function(){this.playLengthCounter===0&&this.playMode===this.MODE_LOOP&&(this.playAddress=this.playStartAddress,this.playLengthCounter=this.playLength),this.playLengthCounter>0&&(this.nextSample(),this.playLengthCounter===0&&this.playMode===this.MODE_IRQ&&(this.irqGenerated=!0))},nextSample:function(){this.data=this.papu.nes.mmap.load(this.playAddress),this.papu.nes.cpu.haltCycles(4),this.playLengthCounter--,this.playAddress++,this.playAddress>65535&&(this.playAddress=32768),this.hasSample=!0},writeReg:function(t,e){t===16400?(e>>6?(e>>6&1)===1?this.playMode=this.MODE_LOOP:e>>6===2&&(this.playMode=this.MODE_IRQ):this.playMode=this.MODE_NORMAL,!(e&128)&&(this.irqGenerated=!1),this.dmaFrequency=this.papu.getDmcFrequency(e&15)):t===16401?(this.deltaCounter=e>>1&63,this.dacLsb=e&1,this.sample=(this.deltaCounter<<1)+this.dacLsb):t===16402?(this.playStartAddress=e<<6|49152,this.playAddress=this.playStartAddress,this.reg4012=e):t===16403?(this.playLength=(e<<4)+1,this.playLengthCounter=this.playLength,this.reg4013=e):t===16405&&(e>>4&1?(this.playAddress=this.playStartAddress,this.playLengthCounter=this.playLength):this.playLengthCounter=0,this.irqGenerated=!1)},setEnabled:function(t){!this.isEnabled&&t&&(this.playLengthCounter=this.playLength),this.isEnabled=t},getLengthStatus:function(){return this.playLengthCounter===0||!this.isEnabled?0:1},getIrqStatus:function(){return this.irqGenerated?1:0},reset:function(){this.isEnabled=!1,this.irqGenerated=!1,this.playMode=this.MODE_NORMAL,this.dmaFrequency=0,this.dmaCounter=0,this.deltaCounter=0,this.playStartAddress=0,this.playAddress=0,this.playLength=0,this.playLengthCounter=0,this.sample=0,this.dacLsb=0,this.shiftCounter=0,this.reg4012=0,this.reg4013=0,this.data=0}};var oh=function(t){this.papu=t,this.isEnabled=null,this.envDecayDisable=null,this.envDecayLoopEnable=null,this.lengthCounterEnable=null,this.envReset=null,this.shiftNow=null,this.lengthCounter=null,this.progTimerCount=null,this.progTimerMax=null,this.envDecayRate=null,this.envDecayCounter=null,this.envVolume=null,this.masterVolume=null,this.shiftReg=16384,this.randomBit=null,this.randomMode=null,this.sampleValue=null,this.accValue=0,this.accCount=1,this.tmp=null,this.reset()};oh.prototype={reset:function(){this.progTimerCount=0,this.progTimerMax=0,this.isEnabled=!1,this.lengthCounter=0,this.lengthCounterEnable=!1,this.envDecayDisable=!1,this.envDecayLoopEnable=!1,this.shiftNow=!1,this.envDecayRate=0,this.envDecayCounter=0,this.envVolume=0,this.masterVolume=0,this.shiftReg=1,this.randomBit=0,this.randomMode=0,this.sampleValue=0,this.tmp=0},clockLengthCounter:function(){this.lengthCounterEnable&&this.lengthCounter>0&&(this.lengthCounter--,this.lengthCounter===0&&this.updateSampleValue())},clockEnvDecay:function(){this.envReset?(this.envReset=!1,this.envDecayCounter=this.envDecayRate+1,this.envVolume=15):--this.envDecayCounter<=0&&(this.envDecayCounter=this.envDecayRate+1,this.envVolume>0?this.envVolume--:this.envVolume=this.envDecayLoopEnable?15:0),this.envDecayDisable?this.masterVolume=this.envDecayRate:this.masterVolume=this.envVolume,this.updateSampleValue()},updateSampleValue:function(){this.isEnabled&&this.lengthCounter>0&&(this.sampleValue=this.randomBit*this.masterVolume)},writeReg:function(t,e){t===16396?(this.envDecayDisable=(e&16)!==0,this.envDecayRate=e&15,this.envDecayLoopEnable=(e&32)!==0,this.lengthCounterEnable=(e&32)===0,this.envDecayDisable?this.masterVolume=this.envDecayRate:this.masterVolume=this.envVolume):t===16398?(this.progTimerMax=this.papu.getNoiseWaveLength(e&15),this.randomMode=e>>7):t===16399&&(this.lengthCounter=this.papu.getLengthMax(e&248),this.envReset=!0)},setEnabled:function(t){this.isEnabled=t,t||(this.lengthCounter=0),this.updateSampleValue()},getLengthStatus:function(){return this.lengthCounter===0||!this.isEnabled?0:1}};var Vi=function(t,e){this.papu=t,this.dutyLookup=[0,1,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,1,1,1,1,0,0,0,1,0,0,1,1,1,1,1],this.impLookup=[1,-1,0,0,0,0,0,0,1,0,-1,0,0,0,0,0,1,0,0,0,-1,0,0,0,-1,0,1,0,0,0,0,0],this.sqr1=e,this.isEnabled=null,this.lengthCounterEnable=null,this.sweepActive=null,this.envDecayDisable=null,this.envDecayLoopEnable=null,this.envReset=null,this.sweepCarry=null,this.updateSweepPeriod=null,this.progTimerCount=null,this.progTimerMax=null,this.lengthCounter=null,this.squareCounter=null,this.sweepCounter=null,this.sweepCounterMax=null,this.sweepMode=null,this.sweepShiftAmount=null,this.envDecayRate=null,this.envDecayCounter=null,this.envVolume=null,this.masterVolume=null,this.dutyMode=null,this.sweepResult=null,this.sampleValue=null,this.vol=null,this.reset()};Vi.prototype={reset:function(){this.progTimerCount=0,this.progTimerMax=0,this.lengthCounter=0,this.squareCounter=0,this.sweepCounter=0,this.sweepCounterMax=0,this.sweepMode=0,this.sweepShiftAmount=0,this.envDecayRate=0,this.envDecayCounter=0,this.envVolume=0,this.masterVolume=0,this.dutyMode=0,this.vol=0,this.isEnabled=!1,this.lengthCounterEnable=!1,this.sweepActive=!1,this.sweepCarry=!1,this.envDecayDisable=!1,this.envDecayLoopEnable=!1},clockLengthCounter:function(){this.lengthCounterEnable&&this.lengthCounter>0&&(this.lengthCounter--,this.lengthCounter===0&&this.updateSampleValue())},clockEnvDecay:function(){this.envReset?(this.envReset=!1,this.envDecayCounter=this.envDecayRate+1,this.envVolume=15):--this.envDecayCounter<=0&&(this.envDecayCounter=this.envDecayRate+1,this.envVolume>0?this.envVolume--:this.envVolume=this.envDecayLoopEnable?15:0),this.envDecayDisable?this.masterVolume=this.envDecayRate:this.masterVolume=this.envVolume,this.updateSampleValue()},clockSweep:function(){--this.sweepCounter<=0&&(this.sweepCounter=this.sweepCounterMax+1,this.sweepActive&&this.sweepShiftAmount>0&&this.progTimerMax>7&&(this.sweepCarry=!1,this.sweepMode===0?(this.progTimerMax+=this.progTimerMax>>this.sweepShiftAmount,this.progTimerMax>4095&&(this.progTimerMax=4095,this.sweepCarry=!0)):this.progTimerMax=this.progTimerMax-((this.progTimerMax>>this.sweepShiftAmount)-(this.sqr1?1:0)))),this.updateSweepPeriod&&(this.updateSweepPeriod=!1,this.sweepCounter=this.sweepCounterMax+1)},updateSampleValue:function(){this.isEnabled&&this.lengthCounter>0&&this.progTimerMax>7?this.sweepMode===0&&this.progTimerMax+(this.progTimerMax>>this.sweepShiftAmount)>4095?this.sampleValue=0:this.sampleValue=this.masterVolume*this.dutyLookup[(this.dutyMode<<3)+this.squareCounter]:this.sampleValue=0},writeReg:function(t,e){var s=this.sqr1?0:4;t===16384+s?(this.envDecayDisable=(e&16)!==0,this.envDecayRate=e&15,this.envDecayLoopEnable=(e&32)!==0,this.dutyMode=e>>6&3,this.lengthCounterEnable=(e&32)===0,this.envDecayDisable?this.masterVolume=this.envDecayRate:this.masterVolume=this.envVolume,this.updateSampleValue()):t===16385+s?(this.sweepActive=(e&128)!==0,this.sweepCounterMax=e>>4&7,this.sweepMode=e>>3&1,this.sweepShiftAmount=e&7,this.updateSweepPeriod=!0):t===16386+s?(this.progTimerMax&=1792,this.progTimerMax|=e):t===16387+s&&(this.progTimerMax&=255,this.progTimerMax|=(e&7)<<8,this.isEnabled&&(this.lengthCounter=this.papu.getLengthMax(e&248)),this.envReset=!0)},setEnabled:function(t){this.isEnabled=t,t||(this.lengthCounter=0),this.updateSampleValue()},getLengthStatus:function(){return this.lengthCounter===0||!this.isEnabled?0:1}};var hh=function(t){this.papu=t,this.isEnabled=null,this.sampleCondition=null,this.lengthCounterEnable=null,this.lcHalt=null,this.lcControl=null,this.progTimerCount=null,this.progTimerMax=null,this.triangleCounter=null,this.lengthCounter=null,this.linearCounter=null,this.lcLoadValue=null,this.sampleValue=null,this.tmp=null,this.reset()};hh.prototype={reset:function(){this.progTimerCount=0,this.progTimerMax=0,this.triangleCounter=0,this.isEnabled=!1,this.sampleCondition=!1,this.lengthCounter=0,this.lengthCounterEnable=!1,this.linearCounter=0,this.lcLoadValue=0,this.lcHalt=!0,this.lcControl=!1,this.tmp=0,this.sampleValue=15},clockLengthCounter:function(){this.lengthCounterEnable&&this.lengthCounter>0&&(this.lengthCounter--,this.lengthCounter===0&&this.updateSampleCondition())},clockLinearCounter:function(){this.lcHalt?(this.linearCounter=this.lcLoadValue,this.updateSampleCondition()):this.linearCounter>0&&(this.linearCounter--,this.updateSampleCondition()),this.lcControl||(this.lcHalt=!1)},getLengthStatus:function(){return this.lengthCounter===0||!this.isEnabled?0:1},readReg:function(t){return 0},writeReg:function(t,e){t===16392?(this.lcControl=(e&128)!==0,this.lcLoadValue=e&127,this.lengthCounterEnable=!this.lcControl):t===16394?(this.progTimerMax&=1792,this.progTimerMax|=e):t===16395&&(this.progTimerMax&=255,this.progTimerMax|=(e&7)<<8,this.lengthCounter=this.papu.getLengthMax(e&248),this.lcHalt=!0),this.updateSampleCondition()},clockProgrammableTimer:function(t){if(this.progTimerMax>0)for(this.progTimerCount+=t;this.progTimerMax>0&&this.progTimerCount>=this.progTimerMax;)this.progTimerCount-=this.progTimerMax,this.isEnabled&&this.lengthCounter>0&&this.linearCounter>0&&this.clockTriangleGenerator()},clockTriangleGenerator:function(){this.triangleCounter++,this.triangleCounter&=31},setEnabled:function(t){this.isEnabled=t,t||(this.lengthCounter=0),this.updateSampleCondition()},updateSampleCondition:function(){this.sampleCondition=this.isEnabled&&this.progTimerMax>7&&this.linearCounter>0&&this.lengthCounter>0}};var cc=nh,Ae=cn,b={};b[0]=function(t){this.nes=t};b[0].prototype={reset:function(){this.joy1StrobeState=0,this.joy2StrobeState=0,this.joypadLastWrite=0,this.zapperFired=!1,this.zapperX=null,this.zapperY=null},write:function(t,e){t<8192?this.nes.cpu.mem[t&2047]=e:t>16407?(this.nes.cpu.mem[t]=e,t>=24576&&t<32768&&this.nes.opts.onBatteryRamWrite(t,e)):t>8199&&t<16384?this.regWrite(8192+(t&7),e):this.regWrite(t,e)},writelow:function(t,e){t<8192?this.nes.cpu.mem[t&2047]=e:t>16407?this.nes.cpu.mem[t]=e:t>8199&&t<16384?this.regWrite(8192+(t&7),e):this.regWrite(t,e)},load:function(t){return t&=65535,t>16407?this.nes.cpu.mem[t]:t>=8192?this.regLoad(t):this.nes.cpu.mem[t&2047]},regLoad:function(t){switch(t>>12){case 0:break;case 1:break;case 2:case 3:switch(t&7){case 0:return this.nes.cpu.mem[8192];case 1:return this.nes.cpu.mem[8193];case 2:return this.nes.ppu.readStatusRegister();case 3:return 0;case 4:return this.nes.ppu.sramLoad();case 5:return 0;case 6:return 0;case 7:return this.nes.ppu.vramLoad()}break;case 4:switch(t-16405){case 0:return this.nes.papu.readReg(t);case 1:return this.joy1Read();case 2:var e;return this.zapperX!==null&&this.zapperY!==null&&this.nes.ppu.isPixelWhite(this.zapperX,this.zapperY)?e=0:e=8,this.zapperFired&&(e|=16),(this.joy2Read()|e)&65535}break}return 0},regWrite:function(t,e){switch(t){case 8192:this.nes.cpu.mem[t]=e,this.nes.ppu.updateControlReg1(e);break;case 8193:this.nes.cpu.mem[t]=e,this.nes.ppu.updateControlReg2(e);break;case 8195:this.nes.ppu.writeSRAMAddress(e);break;case 8196:this.nes.ppu.sramWrite(e);break;case 8197:this.nes.ppu.scrollWrite(e);break;case 8198:this.nes.ppu.writeVRAMAddress(e);break;case 8199:this.nes.ppu.vramWrite(e);break;case 16404:this.nes.ppu.sramDMA(e);break;case 16405:this.nes.papu.writeReg(t,e);break;case 16406:!(e&1)&&(this.joypadLastWrite&1)===1&&(this.joy1StrobeState=0,this.joy2StrobeState=0),this.joypadLastWrite=e;break;case 16407:this.nes.papu.writeReg(t,e);break;default:t>=16384&&t<=16407&&this.nes.papu.writeReg(t,e)}},joy1Read:function(){var t;switch(this.joy1StrobeState){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t=this.nes.controllers[1].state[this.joy1StrobeState];break;case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:t=0;break;case 19:t=1;break;default:t=0}return this.joy1StrobeState++,this.joy1StrobeState===24&&(this.joy1StrobeState=0),t},joy2Read:function(){var t;switch(this.joy2StrobeState){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t=this.nes.controllers[2].state[this.joy2StrobeState];break;case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:t=0;break;case 19:t=1;break;default:t=0}return this.joy2StrobeState++,this.joy2StrobeState===24&&(this.joy2StrobeState=0),t},loadROM:function(){if(!this.nes.rom.valid||this.nes.rom.romCount<1)throw new Error("NoMapper: Invalid ROM! Unable to load.");this.loadPRGROM(),this.loadCHRROM(),this.loadBatteryRam(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)},loadPRGROM:function(){this.nes.rom.romCount>1?(this.loadRomBank(0,32768),this.loadRomBank(1,49152)):(this.loadRomBank(0,32768),this.loadRomBank(0,49152))},loadCHRROM:function(){this.nes.rom.vromCount>0&&(this.nes.rom.vromCount===1?(this.loadVromBank(0,0),this.loadVromBank(0,4096)):(this.loadVromBank(0,0),this.loadVromBank(1,4096)))},loadBatteryRam:function(){if(this.nes.rom.batteryRam){var t=this.nes.rom.batteryRam;t!==null&&t.length===8192&&Ae.copyArrayElements(t,0,this.nes.cpu.mem,24576,8192)}},loadRomBank:function(t,e){t%=this.nes.rom.romCount,Ae.copyArrayElements(this.nes.rom.rom[t],0,this.nes.cpu.mem,e,16384)},loadVromBank:function(t,e){if(this.nes.rom.vromCount!==0){this.nes.ppu.triggerRendering(),Ae.copyArrayElements(this.nes.rom.vrom[t%this.nes.rom.vromCount],0,this.nes.ppu.vramMem,e,4096);var s=this.nes.rom.vromTile[t%this.nes.rom.vromCount];Ae.copyArrayElements(s,0,this.nes.ppu.ptTile,e>>4,256)}},load32kRomBank:function(t,e){this.loadRomBank(t*2%this.nes.rom.romCount,e),this.loadRomBank((t*2+1)%this.nes.rom.romCount,e+16384)},load8kVromBank:function(t,e){this.nes.rom.vromCount!==0&&(this.nes.ppu.triggerRendering(),this.loadVromBank(t%this.nes.rom.vromCount,e),this.loadVromBank((t+1)%this.nes.rom.vromCount,e+4096))},load1kVromBank:function(t,e){if(this.nes.rom.vromCount!==0){this.nes.ppu.triggerRendering();var s=Math.floor(t/4)%this.nes.rom.vromCount,i=t%4*1024;Ae.copyArrayElements(this.nes.rom.vrom[s],i,this.nes.ppu.vramMem,e,1024);for(var n=this.nes.rom.vromTile[s],r=e>>4,o=0;o<64;o++)this.nes.ppu.ptTile[r+o]=n[(t%4<<6)+o]}},load2kVromBank:function(t,e){if(this.nes.rom.vromCount!==0){this.nes.ppu.triggerRendering();var s=Math.floor(t/2)%this.nes.rom.vromCount,i=t%2*2048;Ae.copyArrayElements(this.nes.rom.vrom[s],i,this.nes.ppu.vramMem,e,2048);for(var n=this.nes.rom.vromTile[s],r=e>>4,o=0;o<128;o++)this.nes.ppu.ptTile[r+o]=n[(t%2<<7)+o]}},load8kRomBank:function(t,e){var s=Math.floor(t/2)%this.nes.rom.romCount,i=t%2*8192;Ae.copyArrayElements(this.nes.rom.rom[s],i,this.nes.cpu.mem,e,8192)},clockIrqCounter:function(){},latchAccess:function(t){},toJSON:function(){return{joy1StrobeState:this.joy1StrobeState,joy2StrobeState:this.joy2StrobeState,joypadLastWrite:this.joypadLastWrite}},fromJSON:function(t){this.joy1StrobeState=t.joy1StrobeState,this.joy2StrobeState=t.joy2StrobeState,this.joypadLastWrite=t.joypadLastWrite}};b[1]=function(t){this.nes=t};b[1].prototype=new b[0];b[1].prototype.reset=function(){b[0].prototype.reset.apply(this),this.regBuffer=0,this.regBufferCounter=0,this.mirroring=0,this.oneScreenMirroring=0,this.prgSwitchingArea=1,this.prgSwitchingSize=1,this.vromSwitchingSize=0,this.romSelectionReg0=0,this.romSelectionReg1=0,this.romBankSelect=0};b[1].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}e&128?(this.regBufferCounter=0,this.regBuffer=0,this.getRegNumber(t)===0&&(this.prgSwitchingArea=1,this.prgSwitchingSize=1)):(this.regBuffer=this.regBuffer&255-(1<<this.regBufferCounter)|(e&1)<<this.regBufferCounter,this.regBufferCounter++,this.regBufferCounter===5&&(this.setReg(this.getRegNumber(t),this.regBuffer),this.regBuffer=0,this.regBufferCounter=0))};b[1].prototype.setReg=function(t,e){var s;switch(t){case 0:s=e&3,s!==this.mirroring&&(this.mirroring=s,this.mirroring&2?this.mirroring&1?this.nes.ppu.setMirroring(this.nes.rom.HORIZONTAL_MIRRORING):this.nes.ppu.setMirroring(this.nes.rom.VERTICAL_MIRRORING):this.nes.ppu.setMirroring(this.nes.rom.SINGLESCREEN_MIRRORING)),this.prgSwitchingArea=e>>2&1,this.prgSwitchingSize=e>>3&1,this.vromSwitchingSize=e>>4&1;break;case 1:this.romSelectionReg0=e>>4&1,this.nes.rom.vromCount>0&&(this.vromSwitchingSize===0?this.romSelectionReg0===0?this.load8kVromBank(e&15,0):this.load8kVromBank(Math.floor(this.nes.rom.vromCount/2)+(e&15),0):this.romSelectionReg0===0?this.loadVromBank(e&15,0):this.loadVromBank(Math.floor(this.nes.rom.vromCount/2)+(e&15),0));break;case 2:this.romSelectionReg1=e>>4&1,this.nes.rom.vromCount>0&&this.vromSwitchingSize===1&&(this.romSelectionReg1===0?this.loadVromBank(e&15,4096):this.loadVromBank(Math.floor(this.nes.rom.vromCount/2)+(e&15),4096));break;default:s=e&15;var i,n=0;this.nes.rom.romCount>=32?this.vromSwitchingSize===0?this.romSelectionReg0===1&&(n=16):n=(this.romSelectionReg0|this.romSelectionReg1<<1)<<3:this.nes.rom.romCount>=16&&this.romSelectionReg0===1&&(n=8),this.prgSwitchingSize===0?(i=n+(e&15),this.load32kRomBank(i,32768)):(i=n*2+(e&15),this.prgSwitchingArea===0?this.loadRomBank(i,49152):this.loadRomBank(i,32768))}};b[1].prototype.getRegNumber=function(t){return t>=32768&&t<=40959?0:t>=40960&&t<=49151?1:t>=49152&&t<=57343?2:3};b[1].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("MMC1: Invalid ROM! Unable to load.");this.loadRomBank(0,32768),this.loadRomBank(this.nes.rom.romCount-1,49152),this.loadCHRROM(),this.loadBatteryRam(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};b[1].prototype.switchLowHighPrgRom=function(t){};b[1].prototype.switch16to32=function(){};b[1].prototype.switch32to16=function(){};b[1].prototype.toJSON=function(){var t=b[0].prototype.toJSON.apply(this);return t.mirroring=this.mirroring,t.oneScreenMirroring=this.oneScreenMirroring,t.prgSwitchingArea=this.prgSwitchingArea,t.prgSwitchingSize=this.prgSwitchingSize,t.vromSwitchingSize=this.vromSwitchingSize,t.romSelectionReg0=this.romSelectionReg0,t.romSelectionReg1=this.romSelectionReg1,t.romBankSelect=this.romBankSelect,t.regBuffer=this.regBuffer,t.regBufferCounter=this.regBufferCounter,t};b[1].prototype.fromJSON=function(t){b[0].prototype.fromJSON.apply(this,arguments),this.mirroring=t.mirroring,this.oneScreenMirroring=t.oneScreenMirroring,this.prgSwitchingArea=t.prgSwitchingArea,this.prgSwitchingSize=t.prgSwitchingSize,this.vromSwitchingSize=t.vromSwitchingSize,this.romSelectionReg0=t.romSelectionReg0,this.romSelectionReg1=t.romSelectionReg1,this.romBankSelect=t.romBankSelect,this.regBuffer=t.regBuffer,this.regBufferCounter=t.regBufferCounter};b[2]=function(t){this.nes=t};b[2].prototype=new b[0];b[2].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}else this.loadRomBank(e,32768)};b[2].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("UNROM: Invalid ROM! Unable to load.");this.loadRomBank(0,32768),this.loadRomBank(this.nes.rom.romCount-1,49152),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};b[3]=function(t){this.nes=t};b[3].prototype=new b[0];b[3].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}else{var s=e%(this.nes.rom.vromCount/2)*2;this.loadVromBank(s,0),this.loadVromBank(s+1,4096),this.load8kVromBank(e*2,0)}};b[4]=function(t){this.nes=t,this.CMD_SEL_2_1K_VROM_0000=0,this.CMD_SEL_2_1K_VROM_0800=1,this.CMD_SEL_1K_VROM_1000=2,this.CMD_SEL_1K_VROM_1400=3,this.CMD_SEL_1K_VROM_1800=4,this.CMD_SEL_1K_VROM_1C00=5,this.CMD_SEL_ROM_PAGE1=6,this.CMD_SEL_ROM_PAGE2=7,this.command=null,this.prgAddressSelect=null,this.chrAddressSelect=null,this.pageNumber=null,this.irqCounter=null,this.irqLatchValue=null,this.irqEnable=null,this.prgAddressChanged=!1};b[4].prototype=new b[0];b[4].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}switch(t){case 32768:this.command=e&7;var s=e>>6&1;s!==this.prgAddressSelect&&(this.prgAddressChanged=!0),this.prgAddressSelect=s,this.chrAddressSelect=e>>7&1;break;case 32769:this.executeCommand(this.command,e);break;case 40960:e&1?this.nes.ppu.setMirroring(this.nes.rom.HORIZONTAL_MIRRORING):this.nes.ppu.setMirroring(this.nes.rom.VERTICAL_MIRRORING);break;case 40961:break;case 49152:this.irqCounter=e;break;case 49153:this.irqLatchValue=e;break;case 57344:this.irqEnable=0;break;case 57345:this.irqEnable=1;break}};b[4].prototype.executeCommand=function(t,e){switch(t){case this.CMD_SEL_2_1K_VROM_0000:this.chrAddressSelect===0?(this.load1kVromBank(e,0),this.load1kVromBank(e+1,1024)):(this.load1kVromBank(e,4096),this.load1kVromBank(e+1,5120));break;case this.CMD_SEL_2_1K_VROM_0800:this.chrAddressSelect===0?(this.load1kVromBank(e,2048),this.load1kVromBank(e+1,3072)):(this.load1kVromBank(e,6144),this.load1kVromBank(e+1,7168));break;case this.CMD_SEL_1K_VROM_1000:this.chrAddressSelect===0?this.load1kVromBank(e,4096):this.load1kVromBank(e,0);break;case this.CMD_SEL_1K_VROM_1400:this.chrAddressSelect===0?this.load1kVromBank(e,5120):this.load1kVromBank(e,1024);break;case this.CMD_SEL_1K_VROM_1800:this.chrAddressSelect===0?this.load1kVromBank(e,6144):this.load1kVromBank(e,2048);break;case this.CMD_SEL_1K_VROM_1C00:this.chrAddressSelect===0?this.load1kVromBank(e,7168):this.load1kVromBank(e,3072);break;case this.CMD_SEL_ROM_PAGE1:this.prgAddressChanged&&(this.prgAddressSelect===0?this.load8kRomBank((this.nes.rom.romCount-1)*2,49152):this.load8kRomBank((this.nes.rom.romCount-1)*2,32768),this.prgAddressChanged=!1),this.prgAddressSelect===0?this.load8kRomBank(e,32768):this.load8kRomBank(e,49152);break;case this.CMD_SEL_ROM_PAGE2:this.load8kRomBank(e,40960),this.prgAddressChanged&&(this.prgAddressSelect===0?this.load8kRomBank((this.nes.rom.romCount-1)*2,49152):this.load8kRomBank((this.nes.rom.romCount-1)*2,32768),this.prgAddressChanged=!1)}};b[4].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("MMC3: Invalid ROM! Unable to load.");this.load8kRomBank((this.nes.rom.romCount-1)*2,49152),this.load8kRomBank((this.nes.rom.romCount-1)*2+1,57344),this.load8kRomBank(0,32768),this.load8kRomBank(1,40960),this.loadCHRROM(),this.loadBatteryRam(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};b[4].prototype.clockIrqCounter=function(){this.irqEnable===1&&(this.irqCounter--,this.irqCounter<0&&(this.nes.cpu.requestIrq(this.nes.cpu.IRQ_NORMAL),this.irqCounter=this.irqLatchValue))};b[4].prototype.toJSON=function(){var t=b[0].prototype.toJSON.apply(this);return t.command=this.command,t.prgAddressSelect=this.prgAddressSelect,t.chrAddressSelect=this.chrAddressSelect,t.pageNumber=this.pageNumber,t.irqCounter=this.irqCounter,t.irqLatchValue=this.irqLatchValue,t.irqEnable=this.irqEnable,t.prgAddressChanged=this.prgAddressChanged,t};b[4].prototype.fromJSON=function(t){b[0].prototype.fromJSON.apply(this,arguments),this.command=t.command,this.prgAddressSelect=t.prgAddressSelect,this.chrAddressSelect=t.chrAddressSelect,this.pageNumber=t.pageNumber,this.irqCounter=t.irqCounter,this.irqLatchValue=t.irqLatchValue,this.irqEnable=t.irqEnable,this.prgAddressChanged=t.prgAddressChanged};b[5]=function(t){this.nes=t};b[5].prototype=new b[0];b[5].prototype.write=function(t,e){t<32768?b[0].prototype.write.apply(this,arguments):this.load8kVromBank(e,0)};b[5].prototype.write=function(t,e){if(t<20480){b[0].prototype.write.apply(this,arguments);return}switch(t){case 20736:this.prg_size=e&3;break;case 20737:this.chr_size=e&3;break;case 20738:this.sram_we_a=e&3;break;case 20739:this.sram_we_b=e&3;break;case 20740:this.graphic_mode=e&3;break;case 20741:this.nametable_mode=e,this.nametable_type[0]=e&3,this.load1kVromBank(e&3,8192),e>>=2,this.nametable_type[1]=e&3,this.load1kVromBank(e&3,9216),e>>=2,this.nametable_type[2]=e&3,this.load1kVromBank(e&3,10240),e>>=2,this.nametable_type[3]=e&3,this.load1kVromBank(e&3,11264);break;case 20742:this.fill_chr=e;break;case 20743:this.fill_pal=e&3;break;case 20755:this.SetBank_SRAM(3,e&3);break;case 20756:case 20757:case 20758:case 20759:this.SetBank_CPU(t,e);break;case 20768:case 20769:case 20770:case 20771:case 20772:case 20773:case 20774:case 20775:this.chr_mode=0,this.chr_page[0][t&7]=e,this.SetBank_PPU();break;case 20776:case 20777:case 20778:case 20779:this.chr_mode=1,this.chr_page[1][(t&3)+0]=e,this.chr_page[1][(t&3)+4]=e,this.SetBank_PPU();break;case 20992:this.split_control=e;break;case 20993:this.split_scroll=e;break;case 20994:this.split_page=e&63;break;case 20995:this.irq_line=e,this.nes.cpu.ClearIRQ();break;case 20996:this.irq_enable=e,this.nes.cpu.ClearIRQ();break;case 20997:this.mult_a=e;break;case 20998:this.mult_b=e;break;default:t>=20480&&t<=20501?this.nes.papu.exWrite(t,e):t>=23552&&t<=24575?this.graphic_mode===2||this.graphic_mode!==3&&this.irq_status&64:t>=24576&&t<=32767&&this.sram_we_a===2&&this.sram_we_b;break}};b[5].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("UNROM: Invalid ROM! Unable to load.");this.load8kRomBank(this.nes.rom.romCount*2-1,32768),this.load8kRomBank(this.nes.rom.romCount*2-1,40960),this.load8kRomBank(this.nes.rom.romCount*2-1,49152),this.load8kRomBank(this.nes.rom.romCount*2-1,57344),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};b[7]=function(t){this.nes=t};b[7].prototype=new b[0];b[7].prototype.write=function(t,e){t<32768?b[0].prototype.write.apply(this,arguments):(this.load32kRomBank(e&7,32768),e&16?this.nes.ppu.setMirroring(this.nes.rom.SINGLESCREEN_MIRRORING2):this.nes.ppu.setMirroring(this.nes.rom.SINGLESCREEN_MIRRORING))};b[7].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("AOROM: Invalid ROM! Unable to load.");this.loadPRGROM(),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};b[11]=function(t){this.nes=t};b[11].prototype=new b[0];b[11].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}else{var s=(e&15)*2%this.nes.rom.romCount,i=((e&15)*2+1)%this.nes.rom.romCount;if(this.loadRomBank(s,32768),this.loadRomBank(i,49152),this.nes.rom.vromCount>0){var n=(e>>4)*2%this.nes.rom.vromCount;this.loadVromBank(n,0),this.loadVromBank(n+1,4096)}}};b[34]=function(t){this.nes=t};b[34].prototype=new b[0];b[34].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}else this.load32kRomBank(e,32768)};b[38]=function(t){this.nes=t};b[38].prototype=new b[0];b[38].prototype.write=function(t,e){if(t<28672||t>32767){b[0].prototype.write.apply(this,arguments);return}else this.load32kRomBank(e&3,32768),this.load8kVromBank((e>>2&3)*2,0)};b[66]=function(t){this.nes=t};b[66].prototype=new b[0];b[66].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}else this.load32kRomBank(e>>4&3,32768),this.load8kVromBank((e&3)*2,0)};b[94]=function(t){this.nes=t};b[94].prototype=new b[0];b[94].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}else this.loadRomBank(e>>2,32768)};b[94].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("UN1ROM: Invalid ROM! Unable to load.");this.loadRomBank(0,32768),this.loadRomBank(this.nes.rom.romCount-1,49152),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};b[140]=function(t){this.nes=t};b[140].prototype=new b[0];b[140].prototype.write=function(t,e){if(t<24576||t>32767){b[0].prototype.write.apply(this,arguments);return}else this.load32kRomBank(e>>4&3,32768),this.load8kVromBank((e&15)*2,0)};b[180]=function(t){this.nes=t};b[180].prototype=new b[0];b[180].prototype.write=function(t,e){if(t<32768){b[0].prototype.write.apply(this,arguments);return}else this.loadRomBank(e,49152)};b[180].prototype.loadROM=function(){if(!this.nes.rom.valid)throw new Error("Mapper 180: Invalid ROM! Unable to load.");this.loadRomBank(0,32768),this.loadRomBank(this.nes.rom.romCount-1,49152),this.loadCHRROM(),this.nes.cpu.requestIrq(this.nes.cpu.IRQ_RESET)};var fc=b,gr=fc,pc=th,ah=function(t){this.nes=t,this.mapperName=new Array(92);for(var e=0;e<92;e++)this.mapperName[e]="Unknown Mapper";this.mapperName[0]="Direct Access",this.mapperName[1]="Nintendo MMC1",this.mapperName[2]="UNROM",this.mapperName[3]="CNROM",this.mapperName[4]="Nintendo MMC3",this.mapperName[5]="Nintendo MMC5",this.mapperName[6]="FFE F4xxx",this.mapperName[7]="AOROM",this.mapperName[8]="FFE F3xxx",this.mapperName[9]="Nintendo MMC2",this.mapperName[10]="Nintendo MMC4",this.mapperName[11]="Color Dreams Chip",this.mapperName[12]="FFE F6xxx",this.mapperName[15]="100-in-1 switch",this.mapperName[16]="Bandai chip",this.mapperName[17]="FFE F8xxx",this.mapperName[18]="Jaleco SS8806 chip",this.mapperName[19]="Namcot 106 chip",this.mapperName[20]="Famicom Disk System",this.mapperName[21]="Konami VRC4a",this.mapperName[22]="Konami VRC2a",this.mapperName[23]="Konami VRC2a",this.mapperName[24]="Konami VRC6",this.mapperName[25]="Konami VRC4b",this.mapperName[32]="Irem G-101 chip",this.mapperName[33]="Taito TC0190/TC0350",this.mapperName[34]="32kB ROM switch",this.mapperName[64]="Tengen RAMBO-1 chip",this.mapperName[65]="Irem H-3001 chip",this.mapperName[66]="GNROM switch",this.mapperName[67]="SunSoft3 chip",this.mapperName[68]="SunSoft4 chip",this.mapperName[69]="SunSoft5 FME-7 chip",this.mapperName[71]="Camerica chip",this.mapperName[78]="Irem 74HC161/32-based",this.mapperName[91]="Pirate HK-SF3 chip"};ah.prototype={VERTICAL_MIRRORING:0,HORIZONTAL_MIRRORING:1,FOURSCREEN_MIRRORING:2,SINGLESCREEN_MIRRORING:3,SINGLESCREEN_MIRRORING2:4,SINGLESCREEN_MIRRORING3:5,SINGLESCREEN_MIRRORING4:6,CHRROM_MIRRORING:7,header:null,rom:null,vrom:null,vromTile:null,romCount:null,vromCount:null,mirroring:null,batteryRam:null,trainer:null,fourScreen:null,mapperType:null,valid:!1,load:function(t){var e,s,i;if(t.indexOf("NES")===-1)throw new Error("Not a valid NES ROM.");for(this.header=new Array(16),e=0;e<16;e++)this.header[e]=t.charCodeAt(e)&255;this.romCount=this.header[4],this.vromCount=this.header[5]*2,this.mirroring=this.header[6]&1?1:0,this.batteryRam=(this.header[6]&2)!==0,this.trainer=(this.header[6]&4)!==0,this.fourScreen=(this.header[6]&8)!==0,this.mapperType=this.header[6]>>4|this.header[7]&240;var n=!1;for(e=8;e<16;e++)if(this.header[e]!==0){n=!0;break}n&&(this.mapperType&=15),this.rom=new Array(this.romCount);var r=16;for(e=0;e<this.romCount;e++){for(this.rom[e]=new Array(16384),s=0;s<16384&&!(r+s>=t.length);s++)this.rom[e][s]=t.charCodeAt(r+s)&255;r+=16384}for(this.vrom=new Array(this.vromCount),e=0;e<this.vromCount;e++){for(this.vrom[e]=new Array(4096),s=0;s<4096&&!(r+s>=t.length);s++)this.vrom[e][s]=t.charCodeAt(r+s)&255;r+=4096}for(this.vromTile=new Array(this.vromCount),e=0;e<this.vromCount;e++)for(this.vromTile[e]=new Array(256),s=0;s<256;s++)this.vromTile[e][s]=new pc;var o,h;for(i=0;i<this.vromCount;i++)for(e=0;e<4096;e++)o=e>>4,h=e%16,h<8?this.vromTile[i][o].setScanline(h,this.vrom[i][e],this.vrom[i][e+8]):this.vromTile[i][o].setScanline(h-8,this.vrom[i][e-8],this.vrom[i][e]);this.valid=!0},getMirroringType:function(){return this.fourScreen?this.FOURSCREEN_MIRRORING:this.mirroring===0?this.HORIZONTAL_MIRRORING:this.VERTICAL_MIRRORING},getMapperName:function(){return this.mapperType>=0&&this.mapperType<this.mapperName.length?this.mapperName[this.mapperType]:"Unknown Mapper, "+this.mapperType},mapperSupported:function(){return typeof gr[this.mapperType]<"u"},createMapper:function(){if(this.mapperSupported())return new gr[this.mapperType](this.nes);throw new Error("This ROM uses a mapper not supported by JSNES: "+this.getMapperName()+"("+this.mapperType+")")}};var dc=ah,mc=hc,Rr=$o,_c=lc,gc=cc,Rc=dc,lh=function(t){if(this.opts={onFrame:function(){},onAudioSample:null,onStatusUpdate:function(){},onBatteryRamWrite:function(){},preferredFrameRate:60,emulateSound:!0,sampleRate:48e3},typeof t<"u"){var e;for(e in this.opts)typeof t[e]<"u"&&(this.opts[e]=t[e])}this.frameTime=1e3/this.opts.preferredFrameRate,this.ui={writeFrame:this.opts.onFrame,updateStatus:this.opts.onStatusUpdate},this.cpu=new mc(this),this.ppu=new _c(this),this.papu=new gc(this),this.mmap=null,this.controllers={1:new Rr,2:new Rr},this.ui.updateStatus("Ready to load a ROM."),this.frame=this.frame.bind(this),this.buttonDown=this.buttonDown.bind(this),this.buttonUp=this.buttonUp.bind(this),this.zapperMove=this.zapperMove.bind(this),this.zapperFireDown=this.zapperFireDown.bind(this),this.zapperFireUp=this.zapperFireUp.bind(this)};lh.prototype={fpsFrameCount:0,romData:null,reset:function(){this.mmap!==null&&this.mmap.reset(),this.cpu.reset(),this.ppu.reset(),this.papu.reset(),this.lastFpsTime=null,this.fpsFrameCount=0},frame:function(){this.ppu.startFrame();var t=0,e=this.opts.emulateSound,s=this.cpu,i=this.ppu,n=this.papu;t:for(;;)for(s.cyclesToHalt===0?(t=s.emulate(),e&&n.clockFrameCounter(t),t*=3):s.cyclesToHalt>8?(t=24,e&&n.clockFrameCounter(8),s.cyclesToHalt-=8):(t=s.cyclesToHalt*3,e&&n.clockFrameCounter(s.cyclesToHalt),s.cyclesToHalt=0);t>0;t--){if(i.curX===i.spr0HitX&&i.f_spVisibility===1&&i.scanline-21===i.spr0HitY&&i.setStatusFlag(i.STATUS_SPRITE0HIT,!0),i.requestEndFrame&&(i.nmiCounter--,i.nmiCounter===0)){i.requestEndFrame=!1,i.startVBlank();break t}i.curX++,i.curX===341&&(i.curX=0,i.endScanline())}this.fpsFrameCount++},buttonDown:function(t,e){this.controllers[t].buttonDown(e)},buttonUp:function(t,e){this.controllers[t].buttonUp(e)},zapperMove:function(t,e){!this.mmap||(this.mmap.zapperX=t,this.mmap.zapperY=e)},zapperFireDown:function(){!this.mmap||(this.mmap.zapperFired=!0)},zapperFireUp:function(){!this.mmap||(this.mmap.zapperFired=!1)},getFPS:function(){var t=+new Date,e=null;return this.lastFpsTime&&(e=this.fpsFrameCount/((t-this.lastFpsTime)/1e3)),this.fpsFrameCount=0,this.lastFpsTime=t,e},reloadROM:function(){this.romData!==null&&this.loadROM(this.romData)},loadROM:function(t){this.rom=new Rc(this),this.rom.load(t),this.reset(),this.mmap=this.rom.createMapper(),this.mmap.loadROM(),this.ppu.setMirroring(this.rom.getMirroringType()),this.romData=t},setFramerate:function(t){this.opts.preferredFrameRate=t,this.frameTime=1e3/t,this.papu.setSampleRate(this.opts.sampleRate,!1)},toJSON:function(){return{romData:this.romData,cpu:this.cpu.toJSON(),mmap:this.mmap.toJSON(),ppu:this.ppu.toJSON()}},fromJSON:function(t){this.reset(),this.romData=t.romData,this.cpu.fromJSON(t.cpu),this.mmap.fromJSON(t.mmap),this.ppu.fromJSON(t.ppu)}};var Sc=lh,bc={Controller:$o,NES:Sc};function Ss(t){return Array(t).fill(!1)}function Ac(t){return t.filter(Boolean)}function Cc(){return xt(32768,0).map((t,e)=>e)}function ke(t){const e=[];let s=t[0],i=1;for(let n=1;n<t.length;n++)t[n]===s?i++:(i>1?(e.push(i),e.push(s)):e.push(-s-1),s=t[n],i=1);return e.push(i),e.push(s),e}function Ve(t){const e=[];for(let s=0;s<t.length;)if(t[s]<0)e.push(-t[s]-1),s++;else{const i=t[s],n=t[s+1];for(let r=0;r<i;r++)e.push(n);s+=2}return e}function Ec(t){const e=[],s=[];for(let i=0;i<t.length;i++){for(let n=0;n<t[i].opaque.length;n++)t[i].opaque[n]===!1?e.push(0):e.push(1);s.push(...t[i].pix)}return[ke(e),ke(s)]}function Ic(t){const e=[];let s=Array(8),i=[];const n=Ve(t[0]),r=Ve(t[1]);for(let o=0;o<512;o+=1){for(let h=0;h<8;h+=1)n[o*8+h]===0&&(s[h]=!1);for(let h=0;h<64;h+=1)i[h]=r[o*64+h];e.push({opaque:s,pix:i}),s=Array(8),i=[]}return e}function yc(t){const e=[],s=[];return t.reduce((i,n)=>(e.push(...n.tile),s.push(...n.attrib),i),e),[ke(e),ke(s)]}function Dc(t){const e=[];let s=[],i=[];const n=Ve(t[0]),r=Ve(t[1]);for(let o=0;o<1024*4;o+=1)s.push(n[o]),i.push(r[o]),(o+1)%1024===0&&(e.push({tile:s,attrib:i}),s=[],i=[]);return e}function bs(t){return+`0x${t}`}const Bi=class{constructor(){mt(this,"enable"),mt(this,"fixed"),mt(this,"greater"),mt(this,"lesser"),this.enable=!1,this.fixed={},this.greater={},this.lesser={}}parse(t){const e=Bi.reg.exec(t);if(!e)return;const s=bs(e[1]),i=bs(e[2]),n=bs(e[4]);this.on(s,i,n)}on(t,e,s){if(!(t>X.cpu.mem.length-1))switch(this.enable||(this.enable=!0),e){case 0:this.fixed[t]=s;break;case 1:X.cpu.mem[t]=s;break;case 2:this.lesser[t]=s;break;case 3:this.greater[t]=s;break}}remove(t){delete this.fixed[t],delete this.greater[t],delete this.lesser[t]}disable(t){const e=Bi.reg.exec(t);if(!e)return;const s=bs(e[1]);this.remove(s)}init(){this.enable=!1,this.fixed={},this.greater={},this.lesser={}}onFrame(){this.enable&&(Si(this.fixed).forEach(([t,e])=>{X.cpu.mem[t]=e}),Si(this.greater).forEach(([t,e])=>{X.cpu.mem[t]<e&&(X.cpu.mem[t]=e)}),Si(this.lesser).forEach(([t,e])=>{X.cpu.mem[t]>e&&(X.cpu.mem[t]=e)}))}};let uh=Bi;mt(uh,"reg",/([\da-fA-F]{4})-([0-3])([0-4])-([\da-fA-F]{2,8})/);const Te=new uh,ri=256,oi=240;let vs,ch,fh,Ts;const Gi=new ImageData(ri,oi);function Nc(t){X.frameCounter++;for(let e=0;e<256*240;e+=1)fh[e]=4278190080|t[e];Te.onFrame()}function vc(){Gi.data.set(ch),Ts.putImageData(Gi,0,0)}function Tc(t){Ts=t.getContext("2d"),Ts.fillStyle="black",Ts.fillRect(0,0,ri,oi);const e=new ArrayBuffer(Gi.data.length);ch=new Uint8ClampedArray(e),fh=new Uint32Array(e),X.frameCounter=1,vs=requestAnimationFrame(s);function s(){cancelAnimationFrame(vs),vs=requestAnimationFrame(s),vc()}}function Sr(t){const e=t.parentNode,s=e.clientWidth,i=e.clientHeight,n=s/i,r=ri/oi;r<n?(t.style.height=`${i}px`,t.style.width=`${Math.round(i+r)}px`):(t.style.width=`${s}px`,t.style.height=`${Math.round(s/r)}px`)}function br(){cancelAnimationFrame(vs)}function Oc(t){const e=new Image;return e.src=t.toDataURL("image/png"),e}let Be={};const Ar="........",bi=/\|\d\|([LRUDTSAB.]{8})\|([LRUDTSAB.]{8})?\|\|/g;function Pc(){Be={}}function Cr(t,e){let s=bi.exec(t),i=0+e,n=!1;if(Pc(),!!s)for(;s;){const r=s[1]===Ar,o=s[2]===Ar;if(r&&o){n&&(Be[i]={p1:xt(8,64),p2:xt(8,64)},n=!1),i++,s=bi.exec(t);continue}n=!0;const h=s[1]?s[1].split("").map(u=>u==="."?64:65).reverse():xt(8,64),a=s[2]?s[2].split("").map(u=>u==="."?64:65).reverse():xt(8,64);s=bi.exec(t),Be[i]={p1:h,p2:a},i++}}const X=new bc.NES({onFrame:Nc,onAudioSample:Lc,sampleRate:kc()});X.videoMode=!1;X.frameCounter=1;X.playbackMode=!1;const jt={buffer:null};function Mc(){if(X.videoMode&&X.frameCounter in Be){const t=Be[X.frameCounter];X.frameCounter>0&&(X.controllers[1].state=t.p1,X.controllers[2].state=t.p2)}X.frame()}function Er(t){const e=X.ppu.toJSON(),s=X.mmap.toJSON(),i=ke(e.vramMem),n=yc(e.nameTable),r=Ec(e.ptTile);delete e.attrib,delete e.bgbuffer,delete e.buffer,delete e.pixrendered,delete e.vramMirrorTable,delete e.vramMem,delete e.nameTable,delete e.ptTile;const o=X.cpu.toJSON(),h=ke(o.mem);return delete o.mem,{path:t,data:{cpu:o,mmap:s,ppu:e,vramMemZip:i,nameTableZip:n,cpuMemZip:h,ptTileZip:r,frameCounter:X.frameCounter}}}function wc(t,e,s){if(s&&t.path!==s)return e({code:2,message:`Load Error: The saved data is inconsistent with the current game, saved: ${t.path}, current: ${s}.`});if(!jt.buffer)return e({code:3,message:"Load Error: NES ROM is not loaded."});try{const{ppu:i,cpu:n,mmap:r,frameCounter:o,vramMemZip:h,nameTableZip:a,cpuMemZip:u,ptTileZip:c}=t.data;i.attrib=xt(32,0),i.bgbuffer=xt(61440,0),i.buffer=xt(61440,0),i.pixrendered=xt(61440,0),i.vramMem=Ve(h),i.nameTable=Dc(a),i.vramMirrorTable=Cc(),i.ptTile=Ic(c),n.mem=Ve(u),X.ppu.reset(),X.romData=jt.buffer,X.cpu.fromJSON(n),X.mmap.fromJSON(r),X.ppu.fromJSON(i),X.frameCounter=o}catch(i){console.error(i),e({code:3,message:"Load Error: The saved data is invalid."})}}class Fc{constructor(){mt(this,"_events"),mt(this,"_auto"),this._events={},this._auto={1:{8:{timeout:0,beDown:!1,once:!0},9:{timeout:0,beDown:!1,once:!0}},2:{8:{timeout:0,beDown:!1,once:!0},9:{timeout:0,beDown:!1,once:!0}}}}on(e,s){this._events[e]||(this._events[e]=[]),this._events[e].push(s)}emit(e,s,i){var n;(n=this._events[e])==null||n.forEach(r=>{const o=X.controllers[r.p].state;if(r.index<=7)o[r.index]=s;else{const h=this._auto[r.p][r.index];s===65?h.once&&(o[r.index-8]=65,h.timeout=window.setInterval(()=>{o[r.index-8]=h.beDown?65:64,h.beDown=!h.beDown},i),h.once=!1):(clearInterval(h.timeout),o[r.index-8]=64,h.once=!0,h.beDown=!1)}})}getState(e){return this._events[e]}init(){this._events={}}}const Os=new Fc;let de=new AudioContext,we,qi=1;const Ir=512,fn=4*1024,Bs=fn-1,ph=new Float32Array(fn),dh=new Float32Array(fn);let je=0,Ps=0;function xc(){return je-Ps&Bs}function Lc(t,e){ph[je]=t,dh[je]=e,je=je+1&Bs}function kc(){if(!window.AudioContext)return 44100;const t=new window.AudioContext,e=t.sampleRate;return t.close(),e}function Vc(){de=new AudioContext,we=de.createScriptProcessor(Ir,0,2),we.onaudioprocess=t=>{const e=t.outputBuffer,s=e.length;xc()<Ir&&Mc();const i=e.getChannelData(0),n=e.getChannelData(1);for(let r=0;r<s;r++){const o=Ps+r&Bs;i[r]=ph[o]*qi,n[r]=dh[o]*qi}Ps=Ps+s&Bs},we.connect(de.destination)}function yr(){we.disconnect(de.destination),we.onaudioprocess=null,we={},"close"in de&&de.close()}function Bc(){de.suspend()}function Gc(){de.resume()}function Dr(t){qi=un(t,0,100)/100}const As=.3,Nr={A:0,B:1,SELECT:2,START:3,UP:4,DOWN:5,LEFT:6,RIGHT:7,C:8,D:9},mh={UP:"KeyW",DOWN:"KeyS",LEFT:"KeyA",RIGHT:"KeyD",A:"KeyK",B:"KeyJ",C:"KeyI",D:"KeyU",SELECT:"Digit2",START:"Digit1"},_h={UP:"ArrowUp",DOWN:"ArrowDown",LEFT:"ArrowLeft",RIGHT:"ArrowRight",A:"Numpad2",B:"Numpad1",C:"Numpad5",D:"Numpad4",SELECT:"NumpadDecimal",START:"NumpadEnter"};let gh=1e3/(2*16);function Ke(t,e){Os.emit(t,e,gh)}class qc{constructor(e){mt(this,"animationFrame"),mt(this,"axesHolding"),mt(this,"btnHolding"),mt(this,"gamepad_btns"),window.addEventListener("gamepadconnected",this.connectHandler.bind(this,!0)),window.addEventListener("gamepaddisconnected",this.connectHandler.bind(this,!1)),this.animationFrame=requestAnimationFrame(this.frame.bind(this)),this.btnHolding={p1:Ss(20),p2:Ss(20)},this.axesHolding={p1:Ss(4),p2:Ss(4)},this.gamepad_btns=e}get gamepads(){return Ac(navigator.getGamepads())}connectHandler(e,s){e?this.gamepads[s.gamepad.index]=s.gamepad:this.gamepads.length===0&&this.close()}axesHandler(e,s,i,n){var r;const o=(r=this.axesHolding[e])==null?void 0:r[i];s?o||(Ke(this.gamepad_btns.value[e][n],65),this.axesHolding[e][i]=!0):o&&(Ke(this.gamepad_btns.value[e][n],64),this.axesHolding[e][i]=!1)}btnHandler(e,s,i){var n;const r=(n=this.btnHolding[e])==null?void 0:n[i];if(s.pressed){if(r)return;Ke(this.gamepad_btns.value[e][i],65),this.btnHolding[e][i]=!0}else r&&(Ke(this.gamepad_btns.value[e][i],64),this.btnHolding[e][i]=!1)}frame(){for(let e=0;e<this.gamepads.length&&!(e>1);e++){const s=`p${e+1}`,i=this.gamepads[e];i.buttons.forEach(this.btnHandler.bind(this,s));const n=i.axes[0],r=i.axes[1];this.axesHandler(s,n>As,0,15),this.axesHandler(s,n<-As,1,14),this.axesHandler(s,r>As,2,13),this.axesHandler(s,r<-As,3,12)}}run(){this.frame(),cancelAnimationFrame(this.animationFrame),this.animationFrame=requestAnimationFrame(this.run.bind(this))}close(){this.btnHolding.p1.fill(!1),this.btnHolding.p2.fill(!1),this.axesHolding.p1.fill(!1),this.axesHolding.p2.fill(!1),cancelAnimationFrame(this.animationFrame)}}function Hc(t){const e=St(()=>Object.assign(mh,t.p1)),s=St(()=>Object.assign(_h,t.p2));function i(){gh=1e3/(2*un(t.turbo,5,20))}function n(){Os.init(),sc(Nr).forEach(h=>{const a=Nr[h];Os.on(e.value[h],{p:1,index:a}),Os.on(s.value[h],{p:h==="SELECT"||h==="START"?1:2,index:a})})}n(),i(),Qt(()=>t.p1,n,{deep:!0}),Qt(()=>t.p2,n,{deep:!0}),Qt(()=>t.turbo,i);const r=St(()=>({p1:[e.value.A,e.value.C,e.value.B,e.value.D,"","","","",e.value.SELECT,e.value.START,"","",e.value.UP,e.value.DOWN,e.value.LEFT,e.value.RIGHT],p2:[s.value.A,s.value.C,s.value.B,s.value.D,"","","","",e.value.SELECT,e.value.START,"","",s.value.UP,s.value.DOWN,s.value.LEFT,s.value.RIGHT]})),o=new qc(r);return Js(()=>{o.run()}),en(()=>{o.close()}),Ke}const Xc=()=>fe(),Yc=["width","height"],Uc={style:{position:"absolute",top:"0",left:"0%","background-color":"#000",width:"100%",height:"100%"}},Wc={name:"NesVue"},Rh=Qs({...Wc,name:"NesVue",props:{url:{},autoStart:{type:Boolean,default:!1},width:{default:"256px"},height:{default:"240px"},label:{default:"Game Start"},gain:{default:100},noClip:{type:Boolean,default:!1},storage:{type:Boolean,default:!1},debugger:{type:Boolean,default:!1},turbo:{default:16},dbName:{default:"nes-vue"},p1:{default:()=>mh},p2:{default:()=>_h}},emits:["fps","success","error","saved","loaded","update:url","removed"],setup(t,{expose:e,emit:s}){const i=t,n=s;if(!i.url)throw"nes-vue missing props: url.";const r=Hc(i),o=Xc(),h=fe(!0),a=oc(i.dbName,"save_data");let u=!1,c;function p(P){return P.message=`[nes-vue] ${P.message}`,i.debugger&&console.error(P.message),n("error",P),!1}Lh(()=>{X.ppu.clipToTvSize=!i.noClip});function d(P){r(P.code,65)}function A(P){r(P.code,64)}function v(){document.addEventListener("keydown",d),document.addEventListener("keyup",A)}function w(){document.removeEventListener("keydown",d),document.removeEventListener("keyup",A)}function k(P=i.url){if(!ni(o.value)){if(h.value?h.value=!1:(yr(),br(),clearInterval(c)),P!==i.url){jt.buffer=null,n("update:url",P);return}Tc(o.value),new Promise((_,I)=>{function D(O){try{X.loadROM(O),c=window.setInterval(()=>{const Q=X.getFPS();n("fps",Q||0)},1e3),_("success")}catch{I({code:0,message:`${P} loading Error: Probably the ROM is unsupported.`}),h.value=!0}}if(Qu(jt.buffer))D(jt.buffer);else{const O=new XMLHttpRequest;O.open("GET",P),O.overrideMimeType("text/plain; charset=x-user-defined"),O.onerror=()=>{I({code:404,message:`${P} loading Error: ${O.statusText}`})},O.onload=function(){this.status===200?(jt.buffer=this.responseText,D(jt.buffer)):I({code:404,message:`${P} loading Error: ${O.statusText}`})},O.send()}o.value&&Sr(o.value),v()}).then(()=>{Vc(),n("success")},_=>(p(_),_))}}function M(){X.videoMode&&rt(),h.value||F(),u&&(u=!1),Te.init(),i.url&&k()}function F(){h.value||(yr(),br(),clearInterval(c),X.reset(),Te.init(),h.value=!0)}function V(P){return P===void 0?p({code:4,message:"TypeError: id is undefined."}):!1}function Z(P){wc(P,p,i.url)}function ot(P){if(!V(P))try{localStorage.setItem(P,JSON.stringify(Er(i.url))),n("saved",{id:P,message:"The state has been saved in localStorage",target:"localStorage"})}catch(_){if(_.name==="QuotaExceededError")return p({code:1,message:"Save Error: localStorage out of memory."})}}function G(P){if(V(P))return;const _=localStorage.getItem(P);if(!_)return p({code:2,message:"Load Error: nothing to load."});Z(JSON.parse(_)),n("loaded",{id:P,message:"Loaded state from localStorage",target:"localStorage"})}function ut(P){if(!V(P))try{a.set_item(P,Er(i.url))}catch{p({code:1,message:"Save Error: Unable to save data to indexedDB."})}}function gt(P){V(P)||a.get_item(P).then(_=>{Z(_)})}function ee(P){if(!V(P)){if(!X.cpu.irqRequested||h.value)return p({code:1,message:"Save Error: Can only be saved while the game is running."});i.storage?ot(P):ut(P)}}function Nt(P){if(!V(P)){if(!X.cpu.irqRequested||h.value)return p({code:2,message:"Load Error: Can only be loaded when the game is running."});i.storage?G(P):gt(P),u&&ct()}}function kt(P){V(P)||(i.storage?localStorage.removeItem(P):a.remove_item(P))}function Vt(){a.clear()}function se(P,_){if(!o.value||h.value)return;const I=Oc(o.value);return P&&nc(o.value,_),I}function Tt(){if(ec(Be,!1)){p({code:3,message:"FM2 Error: No fm2 scripts found."});return}M(),X.videoMode=!0,w()}async function Re(P,_=0){try{const I=await(await fetch(P)).text();Cr(I,_)}catch(I){return p({code:4,message:"FM2 Error: Unable to load fm2 file."}),Promise.reject(I)}return Tt}function rt(){X.videoMode=!1,X.controllers[1].state=xt(8,64),X.controllers[2].state=xt(8,64),v()}function J(P,_=0){return Cr(P,_),Promise.resolve(Tt)}function K(P){Te.parse(P)}function Ct(P){Te.disable(P)}function Wt(){Te.init()}function Et(){u=!0,Bc()}function ct(){u=!1,Gc()}const ie=St(()=>{const P=/^\d*$/;let _=i.width,I=i.height;return Ks(()=>{o.value&&Sr(o.value)}),P.test(String(_))&&(_+="px"),P.test(String(I))&&(I+="px"),`width: ${_};height: ${I};background-color: #000;margin: auto;position: relative;overflow: hidden;`});return Qt(()=>i.url,()=>{jt.buffer=null,M()}),Qt(()=>i.gain,()=>{Dr(i.gain)}),Js(()=>{jt.buffer=null,i.autoStart&&k(),Dr(i.gain)}),en(()=>{w(),F()}),e({start:k,reset:M,stop:F,pause:Et,play:ct,save:ee,load:Nt,remove:kt,clear:Vt,screenshot:se,fm2URL:Re,fm2Text:J,fm2Play:Tt,fm2Stop:rt,cheatCode:K,cancelCheatCode:Ct,cancelCheatCodeAll:Wt}),(P,_)=>(Ft(),Kt("div",{style:Ys(ie.value)},[vt("canvas",{ref_key:"cvs",ref:o,width:zt(ri),height:zt(oi),style:{display:"inline-block"}},null,8,Yc),sn(vt("div",Uc,null,512),[[gl,h.value]]),h.value?(Ft(),Kt("div",{key:0,style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",cursor:"pointer",color:"#f8f4ed","font-size":"20px"},onClick:_[0]||(_[0]=I=>k())},Ws(P.label),1)):on("",!0)],4))}}),Zc={id:"app"},jc={class:"nes-container"},Kc=["value"],$c={__name:"Test-game",setup(t){const e=fe(""),s=[{name:" ()",path:"/roms/ ()"},{name:" ()",path:"/roms/ ()"},{name:" ()",path:"/roms/ ()"},{name:" ()",path:"/roms/ ()"},{name:" ()",path:"/roms/ ()"},{name:" () ()",path:"/roms/ () ()"},{name:" ()",path:"/roms/ ()"},{name:" (v2.0) ()",path:"/roms/ (v2.0) ()"},{name:" ()",path:"/roms/ ()"},{name:"2 () ()",path:"/roms/2 () ()"},{name:"3 ()",path:"/roms/3 ()"},{name:"4 (v3.0) ()",path:"/roms/4 (v3.0) ()"},{name:" ()",path:"/roms/ ()"},{name:" ()",path:"/roms/ ()"},{name:"2 -  (v2.2) ()",path:"/roms/2 -  (v2.2) ()"},{name:" ()",path:"/roms/ ()"},{name:" ()",path:"/roms/ ()"},{name:" ()",path:"/roms/ ()"},{name:" () ()",path:"/roms/ () ()"},{name:" -  ()",path:"/roms/ -  ()"},{name:" ()",path:"/roms/ ()"},{name:" (v2.0) ()",path:"/roms/ (v2.0) ()"},{name:" ()",path:"/roms/ ()"},{name:" () ()",path:"/roms/ () ()"},{name:" (v1.1a) ()",path:"/roms/ (v1.1a) ()"},{name:" ()",path:"/roms/ ()"},{name:" (v1.0) ()",path:"/roms/ (v1.0) ()"},{name:" ()",path:"/roms/ ()"},{name:" ()",path:"/roms/ ()"},{name:" ()",path:"/roms/ ()"}],i=()=>{};return(n,r)=>(Ft(),Kt("div",Zc,[vt("div",jc,[sn(vt("select",{"onUpdate:modelValue":r[0]||(r[0]=o=>e.value=o),onChange:i},[(Ft(),Kt(Mt,null,lo(s,(o,h)=>vt("option",{key:h,value:o.path},Ws(o.name),9,Kc)),64))],544),[[Lo,e.value]]),e.value?(Ft(),To(zt(Rh),{key:0,url:e.value,width:"520",height:"480"},null,8,["url"])):on("",!0)])]))}},zc=vt("option",{value:""},"Select a game",-1),Jc=["value"],Qc={key:0,class:"nes-container"},tf={__name:"Test-game2",setup(t){const e=fe({games:[]}),s=fe(""),i=fe("");Js(async()=>{try{const o=await(await fetch("/games.json")).json();e.value=o}catch(r){console.error("Failed to fetch games data:",r)}});const n=()=>{s.value?i.value=`/roms/${s.value}`:i.value=""};return(r,o)=>(Ft(),Kt("div",null,[sn(vt("select",{"onUpdate:modelValue":o[0]||(o[0]=h=>s.value=h),onChange:n},[zc,(Ft(!0),Kt(Mt,null,lo(e.value.games,h=>(Ft(),Kt("option",{key:h,value:h},Ws(h),9,Jc))),128))],544),[[Lo,s.value]]),i.value?(Ft(),Kt("div",Qc,[ft(zt(Rh),{url:i.value,width:"520",height:"480"},null,8,["url"])])):on("",!0)]))}},ef=[{path:"/test-game",name:"TestGame",component:$c},{path:"/test-game2",name:"TestGame2",component:tf}],sf=Wu({history:au("/"),routes:ef}),pn=Fl(Xl);pn.use(Bl());pn.use(sf);pn.mount("#app");
